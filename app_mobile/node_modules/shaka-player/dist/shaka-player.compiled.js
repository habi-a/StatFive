/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var m,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ca="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(){da=function(){};ca.Symbol||(ca.Symbol=fa)}var fa=function(){var a=0;return function(b){return"jscomp_symbol_"+(b||"")+a++}}();
function ha(){da();var a=ca.Symbol.iterator;a||(a=ca.Symbol.iterator=ca.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&aa(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return ia(this)}});ha=function(){}}function ia(a){var b=0;return ka(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function ka(a){ha();a={next:a};a[ca.Symbol.iterator]=function(){return this};return a}function t(a){ha();var b=a[Symbol.iterator];return b?b.call(a):ia(a)}
function la(a,b){if(b){for(var c=ca,d=a.split("."),e=0;e<d.length-1;e++){var f=d[e];f in c||(c[f]={});c=c[f]}d=d[d.length-1];e=c[d];f=b(e);f!=e&&null!=f&&aa(c,d,{configurable:!0,writable:!0,value:f})}}
la("Promise",function(a){function b(a){this.h=0;this.l=void 0;this.g=[];var b=this.i();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}}function c(){this.g=null}function d(a){return a instanceof b?a:new b(function(b){b(a)})}if(a)return a;c.prototype.h=function(a){null==this.g&&(this.g=[],this.j());this.g.push(a)};c.prototype.j=function(){var a=this;this.i(function(){a.m()})};var e=ca.setTimeout;c.prototype.i=function(a){e(a,0)};c.prototype.m=function(){for(;this.g&&this.g.length;){var a=this.g;this.g=
[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(n){this.l(n)}}}this.g=null};c.prototype.l=function(a){this.i(function(){throw a;})};b.prototype.i=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.C),reject:a(this.j)}};b.prototype.C=function(a){if(a===this)this.j(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.F(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;
break a;default:c=!1}c?this.A(a):this.m(a)}};b.prototype.A=function(a){var b=void 0;try{b=a.then}catch(l){this.j(l);return}"function"==typeof b?this.J(b,a):this.m(a)};b.prototype.j=function(a){this.o(2,a)};b.prototype.m=function(a){this.o(1,a)};b.prototype.o=function(a,b){if(0!=this.h)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.h);this.h=a;this.l=b;this.u()};b.prototype.u=function(){if(null!=this.g){for(var a=0;a<this.g.length;++a)f.h(this.g[a]);this.g=null}};
var f=new c;b.prototype.F=function(a){var b=this.i();a.nc(b.resolve,b.reject)};b.prototype.J=function(a,b){var c=this.i();try{a.call(b,c.resolve,c.reject)}catch(n){c.reject(n)}};b.prototype.then=function(a,c){function d(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(z){f(z)}}:b}var e,f,h=new b(function(a,b){e=a;f=b});this.nc(d(a,e),d(c,f));return h};b.prototype["catch"]=function(a){return this.then(void 0,a)};b.prototype.nc=function(a,b){function c(){switch(d.h){case 1:a(d.l);break;
case 2:b(d.l);break;default:throw Error("Unexpected state: "+d.h);}}var d=this;null==this.g?f.h(c):this.g.push(c)};b.resolve=d;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,c){for(var e=t(a),f=e.next();!f.done;f=e.next())d(f.value).nc(b,c)})};b.all=function(a){var c=t(a),e=c.next();return e.done?d([]):new b(function(a,b){function f(b){return function(c){h[b]=c;k--;0==k&&a(h)}}var h=[],k=0;do h.push(void 0),k++,d(e.value).nc(f(h.length-1),b),e=c.next();
while(!e.done)})};return b});la("Promise.prototype.finally",function(a){return a?a:function(a){return this.then(function(b){return Promise.resolve(a()).then(function(){return b})},function(b){return Promise.resolve(a()).then(function(){throw b;})})}});function na(a){function b(b){return a.next(b)}function c(b){return a["throw"](b)}return new Promise(function(d,e){function f(a){a.done?d(a.value):Promise.resolve(a.value).then(b,c).then(f,e)}f(a.next())})}function u(a){return na(a())}
var oa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},pa;if("function"==typeof Object.setPrototypeOf)pa=Object.setPrototypeOf;else{var qa;a:{var ra={a:!0},ua={};try{ua.__proto__=ra;qa=ua.a;break a}catch(a){}qa=!1}pa=qa?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var va=pa;
function xa(a,b){a.prototype=oa(b.prototype);a.prototype.constructor=a;if(va)va(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Lg=b.prototype}function ya(){this.l=!1;this.i=null;this.B=void 0;this.s=1;this.h=this.j=0;this.o=this.g=null}function za(a){if(a.l)throw new TypeError("Generator is already running");a.l=!0}ya.prototype.m=function(a){this.B=a};
function Aa(a,b){a.g={ce:b,ne:!0};a.s=a.j||a.h}ya.prototype["return"]=function(a){this.g={"return":a};this.s=this.h};function v(a,b,c){a.s=c;return{value:b}}ya.prototype.I=function(a){this.s=a};function w(a){a.s=0}function Ba(a,b,c){a.j=b;void 0!=c&&(a.h=c)}function Ca(a,b){a.j=0;a.h=b||0}function Fa(a,b){a.s=b;a.j=0}function Ga(a){a.j=0;var b=a.g.ce;a.g=null;return b}function Ha(a){a.o=[a.g];a.j=0;a.h=0}
function La(a,b){var c=a.o.splice(0)[0];(c=a.g=a.g||c)?c.ne?a.s=a.j||a.h:void 0!=c.I&&a.h<c.I?(a.s=c.I,a.g=null):a.s=a.h:a.s=b}function Ma(a){this.g=new ya;this.h=a}function Na(a,b){za(a.g);var c=a.g.i;if(c)return Oa(a,"return"in c?c["return"]:function(a){return{value:a,done:!0}},b,a.g["return"]);a.g["return"](b);return Qa(a)}
function Oa(a,b,c,d){try{var e=b.call(a.g.i,c);if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object");if(!e.done)return a.g.l=!1,e;var f=e.value}catch(h){return a.g.i=null,Aa(a.g,h),Qa(a)}a.g.i=null;d.call(a.g,f);return Qa(a)}
function Qa(a){for(;a.g.s;)try{var b=a.h(a.g);if(b)return a.g.l=!1,{value:b.value,done:!1}}catch(c){a.g.B=void 0,Aa(a.g,c)}a.g.l=!1;if(a.g.g){b=a.g.g;a.g.g=null;if(b.ne)throw b.ce;return{value:b["return"],done:!0}}return{value:void 0,done:!0}}
function Ra(a){this.next=function(b){za(a.g);a.g.i?b=Oa(a,a.g.i.next,b,a.g.m):(a.g.m(b),b=Qa(a));return b};this["throw"]=function(b){za(a.g);a.g.i?b=Oa(a,a.g.i["throw"],b,a.g.m):(Aa(a.g,b),b=Qa(a));return b};this["return"]=function(b){return Na(a,b)};ha();this[Symbol.iterator]=function(){return this}}function y(a,b){Ra.prototype=a.prototype;return new Ra(new Ma(b))}function Sa(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}
function Ta(a,b){ha();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d}la("Array.prototype.keys",function(a){return a?a:function(){return Ta(this,function(a){return a})}});function Ua(a,b){return Object.prototype.hasOwnProperty.call(a,b)}
la("WeakMap",function(a){function b(a){this.g=(f+=Math.random()+1).toString();if(a){da();ha();a=t(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}}function c(a){Ua(a,e)||aa(a,e,{value:{}})}function d(a){var b=Object[a];b&&(Object[a]=function(a){c(a);return b(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d["delete"](b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(n){return!1}}())return a;
var e="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var f=0;b.prototype.set=function(a,b){c(a);if(!Ua(a,e))throw Error("WeakMap key fail: "+a);a[e][this.g]=b;return this};b.prototype.get=function(a){return Ua(a,e)?a[e][this.g]:void 0};b.prototype.has=function(a){return Ua(a,e)&&Ua(a[e],this.g)};b.prototype["delete"]=function(a){return Ua(a,e)&&Ua(a[e],this.g)?delete a[e][this.g]:!1};return b});
la("Map",function(a){function b(){var a={};return a.Na=a.next=a.head=a}function c(a,b){var c=a.g;return ka(function(){if(c){for(;c.head!=a.g;)c=c.Na;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})}function d(a,b){var c=b&&typeof b;"object"==c||"function"==c?f.has(b)?c=f.get(b):(c=""+ ++h,f.set(b,c)):c="p_"+b;var d=a.h[c];if(d&&Ua(a.h,c))for(var e=0;e<d.length;e++){var k=d[e];if(b!==b&&k.key!==k.key||b===k.key)return{id:c,list:d,index:e,ga:k}}return{id:c,
list:d,index:-1,ga:void 0}}function e(a){this.h={};this.g=b();this.size=0;if(a){a=t(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a(t([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||
"t"!=e.value[1]||!d.next().done?!1:!0}catch(q){return!1}}())return a;da();ha();var f=new WeakMap;e.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.h[c.id]=[]);c.ga?c.ga.value=b:(c.ga={next:this.g,Na:this.g.Na,head:this.g,key:a,value:b},c.list.push(c.ga),this.g.Na.next=c.ga,this.g.Na=c.ga,this.size++);return this};e.prototype["delete"]=function(a){a=d(this,a);return a.ga&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.h[a.id],a.ga.Na.next=a.ga.next,a.ga.next.Na=a.ga.Na,
a.ga.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.h={};this.g=this.g.Na=b();this.size=0};e.prototype.has=function(a){return!!d(this,a).ga};e.prototype.get=function(a){return(a=d(this,a).ga)&&a.value};e.prototype.entries=function(){return c(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return c(this,function(a){return a.key})};e.prototype.values=function(){return c(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),
d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var h=0;return e});
la("Set",function(a){function b(a){this.g=new Map;if(a){a=t(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.g.size}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a(t([b]));if(!d.has(b)||1!=d.size||d.add(b)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=e.next();return f.done||f.value[0]==b||4!=f.value[0].x||
f.value[1]!=f.value[0]?!1:e.next().done}catch(h){return!1}}())return a;da();ha();b.prototype.add=function(a){this.g.set(a,a);this.size=this.g.size;return this};b.prototype["delete"]=function(a){a=this.g["delete"](a);this.size=this.g.size;return a};b.prototype.clear=function(){this.g.clear();this.size=0};b.prototype.has=function(a){return this.g.has(a)};b.prototype.entries=function(){return this.g.entries()};b.prototype.values=function(){return this.g.values()};b.prototype.keys=b.prototype.values;
b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.g.forEach(function(d){return a.call(b,d,d,c)})};return b});function Va(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{le:e,Qe:f}}return{le:-1,Qe:void 0}}la("Array.prototype.findIndex",function(a){return a?a:function(a,c){return Va(this,a,c).le}});la("Array.prototype.find",function(a){return a?a:function(a,c){return Va(this,a,c).Qe}});
function Wa(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""}la("String.prototype.startsWith",function(a){return a?a:function(a,c){for(var b=Wa(this,a,"startsWith"),e=b.length,f=a.length,h=Math.max(0,Math.min(c|0,b.length)),k=0;k<f&&h<e;)if(b[h++]!=a[k++])return!1;return k>=f}});
la("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}});la("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length,f=c||0;for(0>f&&(f=Math.max(f+e,0));f<e;f++){var h=b[f];if(h===a||Object.is(h,a))return!0}return!1}});la("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==Wa(this,a,"includes").indexOf(a,c||0)}});
la("Array.from",function(a){return a?a:function(a,c,d){ha();c=null!=c?c:function(a){return a};var b=[],f=a[Symbol.iterator];if("function"==typeof f)for(a=f.call(a);!(f=a.next()).done;)b.push(c.call(d,f.value));else{f=a.length;for(var h=0;h<f;h++)b.push(c.call(d,a[h]))}return b}});var Xa="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)Ua(d,e)&&(a[e]=d[e])}return a};la("Object.assign",function(a){return a||Xa});
var ab=this;ab.g=!0;function A(a,b){var c=a.split("."),d=ab;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function bb(a,b){function c(){}c.prototype=b.prototype;a.Lg=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Wg=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function cb(a){this.i=Math.exp(Math.log(.5)/a);this.h=this.g=0}function db(a,b,c){var d=Math.pow(a.i,b);c=c*(1-d)+d*a.g;isNaN(c)||(a.g=c,a.h+=b)}function eb(a){return a.g/(1-Math.pow(a.i,a.h))};function fb(){this.h=new cb(2);this.i=new cb(5);this.g=0}fb.prototype.getBandwidthEstimate=function(a){return 128E3>this.g?a:Math.min(eb(this.h),eb(this.i))};var B={sb:0,kc:function(){},ba:function(){},error:function(){},v:function(){},info:function(){},debug:function(){},K:function(){},O:function(){}};window.console&&window.console.log.bind&&(B.ba=console.warn.bind(console),B.kc=console.error.bind(console),1<=B.sb&&(B.error=console.error.bind(console)),2<=B.sb&&(B.v=console.warn.bind(console)),3<=B.sb&&(B.info=console.info.bind(console)),4<=B.sb&&(B.debug=console.log.bind(console)),5<=B.sb&&(B.K=console.debug.bind(console)),6<=B.sb&&(B.O=console.debug.bind(console)));function D(a,b,c,d){for(var e=[],f=3;f<arguments.length;++f)e[f-3]=arguments[f];this.severity=a;this.category=b;this.code=c;this.data=e;this.handled=!1}A("shaka.util.Error",D);D.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};D.Severity={RECOVERABLE:1,CRITICAL:2};D.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
D.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,
MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,
DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,
HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,
FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,
ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013};/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var gb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function hb(a){var b;a instanceof hb?(ib(this,a.Ba),this.pb=a.pb,this.Aa=a.Aa,jb(this,a.Ob),this.pa=a.pa,kb(this,a.g.clone()),this.bb=a.bb):a&&(b=String(a).match(gb))?(ib(this,b[1]||"",!0),this.pb=ob(b[2]||""),this.Aa=ob(b[3]||"",!0),jb(this,b[4]),this.pa=ob(b[5]||"",!0),kb(this,b[6]||"",!0),this.bb=ob(b[7]||"")):this.g=new pb(null)}m=hb.prototype;m.Ba="";m.pb="";m.Aa="";m.Ob=null;m.pa="";m.bb="";
m.toString=function(){var a=[],b=this.Ba;b&&a.push(qb(b,rb,!0),":");if(b=this.Aa){a.push("//");var c=this.pb;c&&a.push(qb(c,rb,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.Ob;null!=b&&a.push(":",String(b))}if(b=this.pa)this.Aa&&"/"!=b.charAt(0)&&a.push("/"),a.push(qb(b,"/"==b.charAt(0)?sb:tb,!0));(b=this.g.toString())&&a.push("?",b);(b=this.bb)&&a.push("#",qb(b,ub));return a.join("")};
m.resolve=function(a){var b=this.clone();"data"===b.Ba&&(b=new hb);var c=!!a.Ba;c?ib(b,a.Ba):c=!!a.pb;c?b.pb=a.pb:c=!!a.Aa;c?b.Aa=a.Aa:c=null!=a.Ob;var d=a.pa;if(c)jb(b,a.Ob);else if(c=!!a.pa){if("/"!=d.charAt(0))if(this.Aa&&!this.pa)d="/"+d;else{var e=b.pa.lastIndexOf("/");-1!=e&&(d=b.pa.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){e=0==d.lastIndexOf("/",0);d=d.split("/");for(var f=[],h=0;h<d.length;){var k=d[h++];"."==k?e&&h==d.length&&f.push(""):".."==
k?((1<f.length||1==f.length&&""!=f[0])&&f.pop(),e&&h==d.length&&f.push("")):(f.push(k),e=!0)}d=f.join("/")}}c?b.pa=d:c=""!==a.g.toString();c?kb(b,a.g.clone()):c=!!a.bb;c&&(b.bb=a.bb);return b};m.clone=function(){return new hb(this)};function ib(a,b,c){a.Ba=c?ob(b,!0):b;a.Ba&&(a.Ba=a.Ba.replace(/:$/,""))}function jb(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Ob=b}else a.Ob=null}function kb(a,b,c){b instanceof pb?a.g=b:(c||(b=qb(b,vb)),a.g=new pb(b))}
function ob(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function qb(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,wb),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function wb(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var rb=/[#\/\?@]/g,tb=/[#\?:]/g,sb=/[#\?]/g,vb=/[#\?@]/g,ub=/#/g;function pb(a){this.g=a||null}m=pb.prototype;m.na=null;m.qc=null;
m.add=function(a,b){if(!this.na&&(this.na={},this.qc=0,this.g))for(var c=this.g.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null;if(0<=e){var h=c[d].substring(0,e);f=c[d].substring(e+1)}else h=c[d];h=decodeURIComponent(h.replace(/\+/g," "));f=f||"";this.add(h,decodeURIComponent(f.replace(/\+/g," ")))}this.g=null;(c=this.na.hasOwnProperty(a)&&this.na[a])||(this.na[a]=c=[]);c.push(b);this.qc++;return this};
m.toString=function(){if(this.g)return this.g;if(!this.na)return"";var a=[],b;for(b in this.na)for(var c=encodeURIComponent(b),d=this.na[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.g=a.join("&")};m.clone=function(){var a=new pb;a.g=this.g;if(this.na){var b={},c;for(c in this.na)b[c]=this.na[c].concat();a.na=b;a.qc=this.qc}return a};var xb={df:function(a,b){return a.reduce(function(a,b,e){return b["catch"](a.bind(null,e))}.bind(null,b),Promise.reject())},Rc:function(a,b){return a.concat(b)},Bc:function(){},Ra:function(a){return null!=a}};function yb(a,b){if(0==b.length)return a;var c=b.map(function(a){return new hb(a)});return a.map(function(a){return new hb(a)}).map(function(a){return c.map(a.resolve.bind(a))}).reduce(xb.Rc,[]).map(function(a){return a.toString()})}function zb(a,b){return{keySystem:a,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:b||[],keyIds:[]}}
var Ab={Za:"video",Sb:"audio",za:"text",Ug:"image",Sg:"application"},Fb=1/15;function E(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;return c}E.prototype.resolve=function(){};E.prototype.reject=function(){};function Gb(a){if(!a)return"";a=new Uint8Array(a);239==a[0]&&187==a[1]&&191==a[2]&&(a=a.subarray(3));a=Hb(a);a=escape(a);try{return decodeURIComponent(a)}catch(b){throw new D(2,2,2004);}}A("shaka.util.StringUtils.fromUTF8",Gb);
function Ib(a,b,c){if(!a)return"";if(!c&&0!=a.byteLength%2)throw B.error("Data has an incorrect length, must be even."),new D(2,2,2004);if(a instanceof ArrayBuffer)var d=a;else c=new Uint8Array(a.byteLength),c.set(new Uint8Array(a)),d=c.buffer;a=Math.floor(a.byteLength/2);c=new Uint16Array(a);d=new DataView(d);for(var e=0;e<a;e++)c[e]=d.getUint16(2*e,b);return Hb(c)}A("shaka.util.StringUtils.fromUTF16",Ib);
function Jb(a){var b=new Uint8Array(a);if(239==b[0]&&187==b[1]&&191==b[2])return Gb(b);if(254==b[0]&&255==b[1])return Ib(b.subarray(2),!1);if(255==b[0]&&254==b[1])return Ib(b.subarray(2),!0);var c=function(a,b){return a.byteLength<=b||32<=a[b]&&126>=a[b]}.bind(null,b);B.debug("Unable to find byte-order-mark, making an educated guess.");if(0==b[0]&&0==b[2])return Ib(a,!1);if(0==b[1]&&0==b[3])return Ib(a,!0);if(c(0)&&c(1)&&c(2)&&c(3))return Gb(a);throw new D(2,2,2003);}
A("shaka.util.StringUtils.fromBytesAutoDetect",Jb);function Kb(a){a=encodeURIComponent(a);a=unescape(a);for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b.buffer}A("shaka.util.StringUtils.toUTF8",Kb);function Lb(a,b){for(var c=new Uint8Array(2*a.length),d=new DataView(c.buffer),e=0;e<a.length;++e)d.setUint16(2*e,a.charCodeAt(e),b);return c.buffer}A("shaka.util.StringUtils.toUTF16",Lb);
function Hb(a){if(!Mb)for(var b=function(a){try{var b=new Uint8Array(a);return 0<String.fromCharCode.apply(null,b).length}catch(f){return!1}},c={size:65536};0<c.size;c={size:c.size},c.size/=2)if(b(c.size)){Mb=function(a){return function(b){for(var c="",d=0;d<b.length;d+=a.size)c+=String.fromCharCode.apply(null,b.subarray(d,d+a.size));return c}}(c);break}return Mb(a)}var Mb=null;A("shaka.util.StringUtils.resetFromCharCode",function(){Mb=null});var G={Mc:function(a,b){var c=Hb(a);b=void 0==b?!0:b;c=window.btoa(c).replace(/\+/g,"-").replace(/\//g,"_");return b?c:c.replace(/=*$/,"")}};A("shaka.util.Uint8ArrayUtils.toBase64",G.Mc);G.Ja=function(a){a=window.atob(a.replace(/-/g,"+").replace(/_/g,"/"));for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b};A("shaka.util.Uint8ArrayUtils.fromBase64",G.Ja);
G.$c=function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b};A("shaka.util.Uint8ArrayUtils.fromHex",G.$c);G.Nc=function(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b};A("shaka.util.Uint8ArrayUtils.toHex",G.Nc);G.Ha=function(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};A("shaka.util.Uint8ArrayUtils.equal",G.Ha);
G.concat=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];for(var d=c=0;d<b.length;++d)c+=b[d].length;c=new Uint8Array(c);for(var e=d=0;e<b.length;++e)c.set(b[e],d),d+=b[e].length;return c};A("shaka.util.Uint8ArrayUtils.concat",G.concat);function Nb(){this.g=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.h=null;this.l=[];this.i=[];this.j=!1;this.g.on("data",this.o.bind(this));this.g.on("done",this.m.bind(this))}Nb.prototype.destroy=function(){this.g.dispose();this.g=null;return Promise.resolve()};function Ob(a,b){return window.muxjs&&"mp2t"==a.toLowerCase().split(";")[0].split("/")[1]?b?MediaSource.isTypeSupported(Pb(b,a)):MediaSource.isTypeSupported(Pb("audio",a))||MediaSource.isTypeSupported(Pb("video",a)):!1}
function Pb(a,b){var c=b.replace(/mp2t/i,"mp4");"audio"==a&&(c=c.replace("video","audio"));var d=/avc1\.(66|77|100)\.(\d+)/.exec(c);if(d){var e="avc1.",f=d[1],h=Number(d[2]);e=("66"==f?e+"4200":"77"==f?e+"4d00":e+"6400")+(h>>4).toString(16);e+=(h&15).toString(16);c=c.replace(d[0],e)}return c}function Qb(a,b){a.j=!0;a.h=new E;a.l=[];a.i=[];var c=new Uint8Array(b);a.g.push(c);a.g.flush();a.j&&a.h.reject(new D(2,3,3018));return a.h}
Nb.prototype.o=function(a){this.i=a.captions;var b=new Uint8Array(a.data.byteLength+a.initSegment.byteLength);b.set(a.initSegment,0);b.set(a.data,a.initSegment.byteLength);this.l.push(b)};Nb.prototype.m=function(){var a={data:G.concat.apply(null,this.l),captions:this.i};this.h.resolve(a);this.j=!1};function Rb(a){this.h=a;this.g=null}Rb.prototype.V=function(a){var b=this;this.stop();var c=!0,d=null;this.g=function(){window.clearTimeout(d);c=!1};d=window.setTimeout(function(){c&&b.h()},1E3*a);return this};Rb.prototype.stop=function(){this.g&&(this.g(),this.g=null)};function H(a){this.h=a;this.g=null}A("shaka.util.Timer",H);H.prototype.Lc=function(){this.stop();this.h();return this};H.prototype.tickNow=H.prototype.Lc;H.prototype.V=function(a){var b=this;this.stop();this.g=(new Rb(function(){b.h()})).V(a);return this};H.prototype.tickAfter=H.prototype.V;H.prototype.Oa=function(a){var b=this;this.stop();this.g=(new Rb(function(){b.g.V(a);b.h()})).V(a);return this};H.prototype.tickEvery=H.prototype.Oa;H.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)};
H.prototype.stop=H.prototype.stop;function Sb(a,b){var c=Tb();this.o=null==a.maxAttempts?c.maxAttempts:a.maxAttempts;this.j=null==a.baseDelay?c.baseDelay:a.baseDelay;this.m=null==a.fuzzFactor?c.fuzzFactor:a.fuzzFactor;this.l=null==a.backoffFactor?c.backoffFactor:a.backoffFactor;this.g=0;this.h=this.j;if(this.i=void 0===b?!1:b)this.g=1}
function Ub(a){return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:if(a.g>=a.o)if(a.i)a.g=1,a.h=a.j;else return c["return"](Promise.reject());d=a.g;a.g++;if(0==d)return c["return"]();e=a.h*(1+(2*Math.random()-1)*a.m);return v(c,new Promise(function(a){(new H(a)).V(e/1E3)}),2);case 2:a.h*=a.l,w(c)}})})}function Tb(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function J(a,b){this.promise=a;this.se=b;this.g=!1}A("shaka.util.AbortableOperation",J);function Vb(a){return new J(Promise.reject(a),function(){return Promise.resolve()})}J.failed=Vb;function Wb(){var a=Promise.reject(new D(2,7,7001));a["catch"](function(){});return new J(a,function(){return Promise.resolve()})}J.aborted=Wb;function Xb(a){return new J(Promise.resolve(a),function(){return Promise.resolve()})}J.completed=Xb;
function Yb(a){return new J(a,function(){return a["catch"](function(){})})}J.notAbortable=Yb;J.prototype.abort=function(){this.g=!0;return this.se()};J.prototype.abort=J.prototype.abort;function Zb(a){return new J(Promise.all(a.map(function(a){return a.promise})),function(){return Promise.all(a.map(function(a){return a.abort()}))})}J.all=Zb;J.prototype["finally"]=function(a){this.promise.then(function(){return a(!0)},function(){return a(!1)});return this};J.prototype["finally"]=J.prototype["finally"];
J.prototype.ca=function(a,b){function c(c){return function(k){if(e.g&&c)f.reject(h);else{var l=c?a:b;l?d=$b(l,k,f):(c?f.resolve:f.reject)(k)}}}function d(){f.reject(h);return e.abort()}var e=this,f=new E,h=new D(2,7,7001);this.promise.then(c(!0),c(!1));return new J(f,function(){return d()})};J.prototype.chain=J.prototype.ca;
function $b(a,b,c){try{var d=a(b);if(d&&d.promise&&d.abort)return c.resolve(d.promise),function(){return d.abort()};c.resolve(d);return function(){return Promise.resolve(d).then(function(){},function(){})}}catch(e){return c.reject(e),function(){return Promise.resolve()}}};function K(a,b){b=void 0===b?{}:b;for(var c in b)this[c]=b[c];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=a;this.isTrusted=!1;this.target=this.currentTarget=null;this.g=!1}A("shaka.util.FakeEvent",K);K.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};K.prototype.stopImmediatePropagation=function(){this.g=!0};K.prototype.stopPropagation=function(){};function ac(){this.g={}}m=ac.prototype;m.push=function(a,b){this.g.hasOwnProperty(a)?this.g[a].push(b):this.g[a]=[b]};m.get=function(a){return(a=this.g[a])?a.slice():null};m.getAll=function(){var a=[],b;for(b in this.g)a.push.apply(a,this.g[b]);return a};m.remove=function(a,b){var c=this.g[a];if(c)for(var d=0;d<c.length;++d)c[d]==b&&(c.splice(d,1),--d)};m.forEach=function(a){for(var b in this.g)a(b,this.g[b])};m.size=function(){return Object.keys(this.g).length};function bc(){this.hd=new ac;this.jc=this}bc.prototype.addEventListener=function(a,b){this.hd.push(a,b)};bc.prototype.removeEventListener=function(a,b){this.hd.remove(a,b)};bc.prototype.dispatchEvent=function(a){for(var b=this.hd.get(a.type)||[],c=0;c<b.length;++c){a.target=this.jc;a.currentTarget=this.jc;var d=b[c];try{d.handleEvent?d.handleEvent(a):d.call(this,a)}catch(e){B.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(a.g)break}return a.defaultPrevented};function cc(a){function b(a){switch(typeof a){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return a;default:if(!a||a.buffer&&a.buffer.constructor==ArrayBuffer)return a;if(c.has(a))return null;var d=a.constructor==Array;if(a.constructor!=Object&&!d)return null;c.add(a);var f=d?[]:{},h;for(h in a)f[h]=b(a[h]);d&&(f.length=a.length);return f}}var c=new Set;return b(a)};function ec(a,b){return"number"===typeof a&&"number"===typeof b&&isNaN(a)&&isNaN(b)?!0:a===b}function fc(a,b){var c=a.indexOf(b);-1<c&&a.splice(c,1)}function gc(a,b){var c=0;a.forEach(function(a){c+=b(a)?1:0});return c}
function hc(a,b,c){c||(c=ec);if(a.length!=b.length)return!1;b=b.slice();var d={};a=t(a);for(var e=a.next();!e.done;d={item:d.item},e=a.next()){d.item=e.value;e=b.findIndex(function(a){return function(b){return c(a.item,b)}}(d));if(-1==e)return!1;b[e]=b[b.length-1];b.pop()}return 0==b.length};function ic(){this.g=[]}function jc(a,b){a.g.push(b["finally"](function(){fc(a.g,b)}))}ic.prototype.destroy=function(){var a=[];this.g.forEach(function(b){b.promise["catch"](function(){});a.push(b.abort())});this.g=[];return Promise.all(a)};function L(a){bc.call(this);this.j=!1;this.l=new ic;this.g=new Set;this.h=new Set;this.i=a||null}bb(L,bc);A("shaka.net.NetworkingEngine",L);L.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};L.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var kc={};function lc(a,b,c){c=c||3;var d=kc[a];if(!d||c>=d.priority)kc[a]={priority:c,mg:b}}L.registerScheme=lc;L.unregisterScheme=function(a){delete kc[a]};L.prototype.og=function(a){this.g.add(a)};L.prototype.registerRequestFilter=L.prototype.og;
L.prototype.Ng=function(a){this.g["delete"](a)};L.prototype.unregisterRequestFilter=L.prototype.Ng;L.prototype.bf=function(){this.g.clear()};L.prototype.clearAllRequestFilters=L.prototype.bf;L.prototype.pg=function(a){this.h.add(a)};L.prototype.registerResponseFilter=L.prototype.pg;L.prototype.Og=function(a){this.h["delete"](a)};L.prototype.unregisterResponseFilter=L.prototype.Og;L.prototype.cf=function(){this.h.clear()};L.prototype.clearAllResponseFilters=L.prototype.cf;
L.defaultRetryParameters=function(){return Tb()};function mc(a,b){return{uris:a,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:b,licenseRequestType:null,sessionId:null}}L.makeRequest=mc;L.prototype.destroy=function(){this.j=!0;this.g.clear();this.h.clear();return this.l.destroy()};L.prototype.destroy=L.prototype.destroy;
L.prototype.request=function(a,b){var c=this,d=new nc;if(this.j){var e=Promise.reject(new D(2,7,7001));e["catch"](function(){});return new oc(e,function(){return Promise.resolve()},d)}b.method=b.method||"GET";b.headers=b.headers||{};b.retryParameters=b.retryParameters?cc(b.retryParameters):Tb();b.uris=cc(b.uris);e=pc(this,a,b);var f=e.ca(function(){return qc(c,a,b,new Sb(b.retryParameters,!1),0,null,d)}),h=f.ca(function(b){return rc(c,a,b)}),k=Date.now(),l=0;e.promise.then(function(){l=Date.now()-
k},function(){});var n=0;f.promise.then(function(){n=Date.now()},function(){});e=h.ca(function(b){var d=Date.now()-n,e=b.response;e.timeMs+=l;e.timeMs+=d;b.Nf||!c.i||e.fromCache||1!=a||c.i(e.timeMs,e.data.byteLength);return e},function(a){a&&(a.severity=2);throw a;});e=new oc(e.promise,e.se,d);jc(this.l,e);return e};L.prototype.request=L.prototype.request;
function pc(a,b,c){var d=Xb(void 0),e={};a=t(a.g);for(var f=a.next();!f.done;e={Gd:e.Gd},f=a.next())e.Gd=f.value,d=d.ca(function(a){return function(){return a.Gd(b,c)}}(e));return d.ca(void 0,function(a){if(a&&7001==a.code)throw a;throw new D(2,1,1006,a);})}
function qc(a,b,c,d,e,f,h){var k=new hb(c.uris[e]),l=k.Ba,n=!1;l||(l=location.protocol,l=l.slice(0,-1),ib(k,l),c.uris[e]=k.toString());l=l.toLowerCase();var p=(l=kc[l])?l.mg:null;if(!p)return Vb(new D(2,1,1E3,k));var q;return Yb(Ub(d)).ca(function(){if(a.j)return Wb();q=Date.now();return p(c.uris[e],c,b,function(c,d,e){a.i&&1==b&&(a.i(c,d),n=!0,h.g=e)})}).ca(function(a){void 0==a.timeMs&&(a.timeMs=Date.now()-q);return{response:a,Nf:n}},function(k){if(k&&7001==k.code)throw k;if(a.j)return Wb();if(k&&
1==k.severity)return a.dispatchEvent(new K("retry",{error:k instanceof D?k:null})),e=(e+1)%c.uris.length,qc(a,b,c,d,e,k,h);throw k||f;})}function rc(a,b,c){var d=Xb(void 0);a=t(a.h);for(var e=a.next();!e.done;e=a.next())d=d.ca(e.value.bind(null,b,c.response));return d.ca(function(){return c},function(a){if(a&&7001==a.code)throw a;var b=2;a instanceof D&&(b=a.severity);throw new D(b,1,1007,a);})}function nc(){this.g=0}L.NumBytesRemainingClass=nc;function oc(a,b,c){J.call(this,a,b);this.h=c}xa(oc,J);
L.PendingRequest=oc;oc.all=Zb;oc.notAbortable=Yb;oc.completed=Xb;oc.aborted=Wb;oc.failed=Vb;function sc(){}A("shaka.util.IReleasable",sc);sc.prototype.release=function(){};function M(){this.g=new ac}A("shaka.util.EventManager",M);M.prototype.release=function(){this.nb();this.g=null};M.prototype.release=M.prototype.release;M.prototype.H=function(a,b,c,d){this.g&&(a=new tc(a,b,c,d),this.g.push(b,a))};M.prototype.listen=M.prototype.H;M.prototype.ya=function(a,b,c,d){function e(d){f.ta(a,b,e);c(d)}var f=this;this.H(a,b,e,d)};M.prototype.listenOnce=M.prototype.ya;
M.prototype.ta=function(a,b,c){if(this.g){var d=this.g.get(b)||[];d=t(d);for(var e=d.next();!e.done;e=d.next())e=e.value,e.target!=a||c!=e.listener&&c||(e.ta(),this.g.remove(b,e))}};M.prototype.unlisten=M.prototype.ta;M.prototype.nb=function(){if(this.g){var a=this.g.getAll();a=t(a);for(var b=a.next();!b.done;b=a.next())b.value.ta();this.g.g={}}};M.prototype.removeAll=M.prototype.nb;
function tc(a,b,c,d){this.target=a;this.type=b;this.listener=c;this.g=uc(a,d);this.target.addEventListener(b,c,this.g)}tc.prototype.ta=function(){this.target.removeEventListener(this.type,this.listener,this.g);this.listener=this.target=null;this.g=!1};tc.prototype.unlisten=tc.prototype.ta;function uc(a,b){if(void 0==b)return!1;if("boolean"==typeof b)return b;var c=new Set(["passive","capture"]);Object.keys(b).filter(function(a){return!c.has(a)});return vc(a)?b:b.capture||!1}
function vc(a){var b=wc;if(void 0==b){b=!1;try{var c={},d={get:function(){b=!0;return!1}};Object.defineProperty(c,"passive",d);Object.defineProperty(c,"capture",d);d=function(){};a.addEventListener("test",d,c);a.removeEventListener("test",d,c)}catch(e){b=!1}wc=b}return b||!1}var wc=void 0;function xc(a){a=Jb(a);return(new hb(a)).Aa}A("shaka.util.FairPlayUtils.defaultGetContentId",xc);function yc(a,b,c){function d(a){(new DataView(e.buffer)).setUint32(f,a.byteLength,!0);f+=4;e.set(a,f);f+=a.byteLength}if(!c||!c.byteLength)throw new D(2,6,6015);b="string"==typeof b?new Uint8Array(Lb(b,!0)):new Uint8Array(b);a=Jb(a);a=Lb(a,!0);var e=new Uint8Array(12+a.byteLength+b.byteLength+c.byteLength),f=0;d(new Uint8Array(a));d(b);d(new Uint8Array(c));return e}
A("shaka.util.FairPlayUtils.initDataTransform",yc);function zc(a,b){for(var c=[],d=t(a),e=d.next();!e.done;e=d.next())c.push(b(e.value));return c}function Ac(a,b){for(var c=t(a),d=c.next();!d.done;d=c.next())if(!b(d.value))return!1;return!0};function Bc(a){var b=new Map;Object.keys(a).forEach(function(c){b.set(c,a[c])});return b}function Cc(a){var b={};a.forEach(function(a,d){b[d]=a});return b};function Dc(a,b){var c=a;b&&(c+='; codecs="'+b+'"');return c}function Ec(a){var b=[a.mimeType];Fc.forEach(function(c,d){var e=a[d];e&&b.push(c+'="'+e+'"')});return b.join(";")}function Gc(a){a=a.split(/ *; */);a.shift();return(a=a.find(function(a){return a.startsWith("codecs=")}))?a.split("=")[1].replace(/^"|"$/g,""):""}function Hc(a){a=a.split(".");var b=a[0];a.pop();return[b,a.join(".")]}
var Fc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Ic(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function Jc(a){return""!=Kc().canPlayType(a)}function Lc(){return Mc("Tizen")}function Nc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Lc()}function Oc(){if(!Nc())return null;var a=navigator.userAgent.match(/Version\/(\d+)/);return a?parseInt(a[1],10):(a=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(a[1],10):null}function Mc(a){return(navigator.userAgent||"").includes(a)}
function Kc(){if(Pc)return Pc;Qc||(Qc=new H(function(){Pc=null}));(Pc=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Pc=document.createElement("video"));Qc.V(1);return Pc}var Qc=null,Pc=null;function Rc(a,b){var c=this;b=void 0===b?1:b;this.J=a;this.C=new Set;this.m=this.o=null;this.Z=!1;this.P=0;this.g=null;this.u=new M;this.h=new Map;this.F=[];this.A=new E;this.j=null;this.l=function(b){c.A.reject(b);a.onError(b)};this.wa=new Map;this.da=new Map;this.X=new H(function(){return Sc(c)});this.i=!1;this.ua=new E;this.L=!1;this.M=[];this.va=!1;this.ea=(new H(function(){Tc(c)})).Oa(b);this.A["catch"](function(){})}m=Rc.prototype;
m.destroy=function(){var a=this;return u(function c(){return y(c,function(c){switch(c.s){case 1:if(a.i)return v(c,a.ua,0);a.i=!0;return v(c,Uc(a),4);case 4:a.ua.resolve(),c.I(0)}})})};
function Uc(a){return u(function c(){return y(c,function(c){switch(c.s){case 1:return a.u.release(),a.u=null,a.A.reject(),a.ea.stop(),a.ea=null,a.X.stop(),a.X=null,v(c,Vc(a),2);case 2:if(!a.m){c.I(3);break}Ba(c,4);return v(c,a.m.setMediaKeys(null),6);case 6:Fa(c,5);break;case 4:Ga(c);case 5:a.m=null;case 3:a.g=null,a.C.clear(),a.o=null,a.F=[],a.j=null,a.l=null,a.J=null,w(c)}})})}m.configure=function(a){this.j=a};function Wc(a,b,c){a.F=[];a.L=c;return Xc(a,b)}
function Yc(a,b,c){a.F=c;a.L=0<c.length;return Xc(a,b)}function Zc(a,b,c,d,e,f){var h=new Map;h.set(b,{audioCapabilities:e,videoCapabilities:f,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:b,drmInfos:[{keySystem:b,licenseServerUri:c,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:d,initData:null,keyIds:null}]});return $c(a,h)}
function Xc(a,b){var c=ad(a);if(c)for(var d=t(b),e=d.next();!e.done;e=d.next())e.value.drmInfos=[c];c=b.some(function(a){return 0<a.drmInfos.length});c||(e=Bc(a.j.servers),bd(b,e));d=t(b);for(e=d.next();!e.done;e=d.next()){e=t(e.value.drmInfos);for(var f=e.next();!f.done;f=e.next())cd(f.value,Bc(a.j.servers),Bc(a.j.advanced||{}))}e=dd(a,b);if(!e.size)return a.Z=!0,Promise.resolve();e=$c(a,e);return c?e:e["catch"](function(){})}
m.Ub=function(a){var b=this;if(!this.o)return this.u.ya(a,"encrypted",function(){b.l(new D(2,6,6010))}),Promise.resolve();this.m=a;this.u.ya(this.m,"play",function(){for(var a=0;a<b.M.length;a++)ed(b,b.M[a]);b.va=!0;b.M=[]});"webkitCurrentPlaybackTargetIsWireless"in this.m&&this.u.H(this.m,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Vc(b)});a=this.m.setMediaKeys(this.o);a=a["catch"](function(a){return Promise.reject(new D(2,6,6003,a.message))});var c=fd(this);return Promise.all([a,
c]).then(function(){if(b.i)return Promise.reject();gd(b);b.g.initData.length||b.F.length||b.u.H(b.m,"encrypted",function(a){return hd(b,a.initDataType,new Uint8Array(a.initData))})})["catch"](function(a){if(!b.i)return Promise.reject(a)})};
function fd(a){return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:if(!(a.o&&a.g&&a.g.serverCertificate&&a.g.serverCertificate.length)){c.I(0);break}Ba(c,3);return v(c,a.o.setServerCertificate(a.g.serverCertificate),5);case 5:(d=c.B)||B.v("Server certificates are not supported by the key system.  The server certificate has been ignored.");Fa(c,0);break;case 3:return e=Ga(c),c["return"](Promise.reject(new D(2,6,6004,e.message)))}})})}
function id(a,b){return u(function d(){var e,f,h;return y(d,function(d){switch(d.s){case 1:return v(d,jd(a,b),2);case 2:e=d.B;if(!e)return B.O("Ignoring attempt to remove missing session",b),d["return"]();f=[];if(h=a.h.get(e))h.Ga=new E,f.push(h.Ga);B.O("Attempting to remove session",b);f.push(e.remove());return v(d,Promise.all(f),0)}})})}
function gd(a){var b=a.g?a.g.initData:[];b.forEach(function(b){return hd(a,b.initDataType,b.initData)});a.F.forEach(function(b){return jd(a,b)});b.length||a.F.length||a.A.resolve();return a.A}function hd(a,b,c){var d=a.h.values();d=t(d);for(var e=d.next();!e.done;e=d.next())if(G.Ha(c,e.value.initData)&&!Mc("Tizen 2")){B.debug("Ignoring duplicate init data.");return}kd(a,b,c)}function ld(a){return a?a.keySystem:""}
function md(a,b){if(navigator.userAgent.match(/Edge\//))return!0;b=b.toLowerCase();if(Lc()&&b.includes('codecs="ac-3"')){var c=b.replace("ac-3","ec-3");return a.C.has(b)||a.C.has(c)}return a.C.has(b)}function nd(a){a=a.h.keys();a=zc(a,function(a){return a.sessionId});return Array.from(a)}m.Xb=function(){var a=Infinity,b=this.h.keys();b=t(b);for(var c=b.next();!c.done;c=b.next())c=c.value,isNaN(c.expiration)||(a=Math.min(a,c.expiration));return a};
function dd(a,b){for(var c=new Set,d=t(b),e=d.next();!e.done;e=d.next()){var f=t(e.value.drmInfos);for(e=f.next();!e.done;e=f.next())c.add(e.value)}d=t(c);for(e=d.next();!e.done;e=d.next())cd(e.value,Bc(a.j.servers),Bc(a.j.advanced||{}));f=a.L?"required":"optional";var h=a.L?["persistent-license"]:["temporary"];d=new Map;c=t(c);for(e=c.next();!e.done;e=c.next())e=e.value,d.set(e.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:f,sessionTypes:h,
label:e.keySystem,drmInfos:[]});c=t(b);for(e=c.next();!e.done;e=c.next()){e=e.value;f=e.audio;h=e.video;var k=f?od(f):"",l=h?od(h):"",n=t(e.drmInfos);for(e=n.next();!e.done;e=n.next()){e=e.value;var p=d.get(e.keySystem);p.drmInfos.push(e);e.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");e.persistentStateRequired&&(p.persistentState="required");f&&(p.audioCapabilities.push({robustness:e.audioRobustness||"",contentType:k}),"ac-3"==f.codecs.toLowerCase()&&Lc()&&p.audioCapabilities.push({robustness:e.audioRobustness||
"",contentType:Dc(f.mimeType,"ec-3")}));h&&p.videoCapabilities.push({robustness:e.videoRobustness||"",contentType:l})}}return d}function od(a){var b=Dc(a.mimeType,a.codecs);return Ob(b)?Pb(a.type,b):b}
function $c(a,b){if(1==b.size&&b.has(""))return Promise.reject(new D(2,6,6E3));for(var c=t(b.values()),d=c.next();!d.done;d=c.next())d=d.value,0==d.audioCapabilities.length&&delete d.audioCapabilities,0==d.videoCapabilities.length&&delete d.videoCapabilities;var e=c=new E;[!0,!1].forEach(function(a){var c=this;b.forEach(function(b,d){b.drmInfos.some(function(a){return!!a.licenseServerUri})==a&&(e=e["catch"](function(){if(!this.i)return navigator.requestMediaKeySystemAccess(d,[b])}.bind(c)))})}.bind(a));
e=e["catch"](function(){return Promise.reject(new D(2,6,6001))});e=e.then(function(a){if(this.i)return Promise.reject();this.C.clear();var c=a.getConfiguration(),d=c.videoCapabilities||[],e=t(c.audioCapabilities||[]);for(c=e.next();!c.done;c=e.next())this.C.add(c.value.contentType.toLowerCase());d=t(d);for(c=d.next();!c.done;c=d.next())this.C.add(c.value.contentType.toLowerCase());d=a.keySystem;c=b.get(a.keySystem);e=[];var f=[],p=[],q=[];pd(c.drmInfos,e,f,p,q);1<f.length&&B.v("Multiple unique server certificates found! Only the first will be used.");
1<e.length&&B.v("Multiple unique license server URIs found! Only the first will be used.");this.g={keySystem:d,licenseServerUri:e[0],distinctiveIdentifierRequired:"required"==c.distinctiveIdentifier,persistentStateRequired:"required"==c.persistentState,audioRobustness:(c.audioCapabilities?c.audioCapabilities[0].robustness:"")||"",videoRobustness:(c.videoCapabilities?c.videoCapabilities[0].robustness:"")||"",serverCertificate:f[0],initData:p,keyIds:q};return this.g.licenseServerUri?a.createMediaKeys():
Promise.reject(new D(2,6,6012,this.g.keySystem))}.bind(a)).then(function(a){if(this.i)return Promise.reject();B.info("Created MediaKeys object for key system",this.g.keySystem);this.o=a;this.Z=!0}.bind(a))["catch"](function(a){if(!this.i)return this.g=null,this.C.clear(),a instanceof D?Promise.reject(a):Promise.reject(new D(2,6,6002,a.message))}.bind(a));c.reject();return e}
function ad(a){a=Bc(a.j.clearKeys);if(0==a.size)return null;var b=[],c=[];a.forEach(function(a,d){var e=G.$c(d),f=G.$c(a);e={kty:"oct",kid:G.Mc(e,!1),k:G.Mc(f,!1)};b.push(e);c.push(e.kid)});a=JSON.stringify({keys:b});var d=JSON.stringify({kids:c});d=[{initData:new Uint8Array(Kb(d)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(a),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:d,keyIds:[]}}
function jd(a,b){try{B.K("Attempting to load an offline session",b);var c=a.o.createSession("persistent-license")}catch(f){var d=new D(2,6,6005,f.message);a.l(d);return Promise.reject(d)}a.u.H(c,"message",a.ye.bind(a));a.u.H(c,"keystatuseschange",a.we.bind(a));var e={initData:null,loaded:!1,xd:Infinity,Ga:null};a.h.set(c,e);return c.load(b).then(function(a){if(this.i)return Promise.reject();B.O("Loaded offline session",b,a);if(a)return e.loaded=!0,qd(this)&&this.A.resolve(),c;this.h["delete"](c);
this.l(new D(2,6,6013))}.bind(a),function(a){this.i||(this.h["delete"](c),this.l(new D(2,6,6005,a.message)))}.bind(a))}
function kd(a,b,c){try{if(a.L){B.K("Creating new persistent session");var d=a.o.createSession("persistent-license")}else B.K("Creating new temporary session"),d=a.o.createSession()}catch(e){a.l(new D(2,6,6005,e.message));return}a.u.H(d,"message",a.ye.bind(a));a.u.H(d,"keystatuseschange",a.we.bind(a));a.h.set(d,{initData:c,loaded:!1,xd:Infinity,Ga:null});try{c=a.j.initDataTransform(c,a.g)}catch(e){b=e;e instanceof D||(b=new D(2,6,6016,e));a.l(b);return}d.generateRequest(b,c)["catch"](function(b){if(!a.i){a.h["delete"](d);
if(b.errorCode&&b.errorCode.systemCode){var c=b.errorCode.systemCode;0>c&&(c+=Math.pow(2,32));c="0x"+c.toString(16)}a.l(new D(2,6,6006,b.message,b,c))}})}function rd(a,b){if(ld(b).startsWith("com.apple.fps")){var c=b.serverCertificate,d=xc(a);a=yc(a,d,c)}return a}m.ye=function(a){this.m&&this.j.delayLicenseRequestUntilPlayed&&this.m.paused&&!this.va?this.M.push(a):ed(this,a)};
function ed(a,b){var c=b.target;B.K("Sending license request for session",c.sessionId,"of type",b.messageType);var d=a.h.get(c),e=a.g.licenseServerUri,f=a.j.advanced[a.g.keySystem];"individualization-request"==b.messageType&&f&&f.individualizationServer&&(e=f.individualizationServer);e=mc([e],a.j.retryParameters);e.body=b.message;e.method="POST";e.licenseRequestType=b.messageType;e.sessionId=c.sessionId;"com.microsoft.playready"!=a.g.keySystem&&"com.chromecast.playready"!=a.g.keySystem||sd(e);a.g.keySystem.startsWith("com.apple.fps")&&
a.j.fairPlayTransform&&td(e);var h=Date.now();a.J.Ib.request(2,e).promise.then(function(a){if(this.i)return Promise.reject();this.g.keySystem.startsWith("com.apple.fps")&&this.j.fairPlayTransform&&ud(a);this.P+=(Date.now()-h)/1E3;B.K("Updating session",c.sessionId);return c.update(a.data).then(function(){var a=this;this.J.onEvent(new K("drmsessionupdate"));d&&(d.Ga&&d.Ga.resolve(),(new H(function(){d.loaded=!0;qd(a)&&a.A.resolve()})).V(vd))}.bind(this))}.bind(a),function(a){this.i||(a=new D(2,6,6007,
a),this.l(a),d&&d.Ga&&d.Ga.reject(a))}.bind(a))["catch"](function(a){this.i||(a=new D(2,6,6008,a.message),this.l(a),d&&d.Ga&&d.Ga.reject(a))}.bind(a))}
function sd(a){var b=Ib(a.body,!0,!0);if(b.includes("PlayReadyKeyMessage")){B.debug("Unwrapping PlayReady request.");b=(new DOMParser).parseFromString(b,"application/xml");for(var c=b.getElementsByTagName("HttpHeader"),d=0;d<c.length;++d)a.headers[c[d].getElementsByTagName("name")[0].textContent]=c[d].getElementsByTagName("value")[0].textContent;a.body=G.Ja(b.getElementsByTagName("Challenge")[0].textContent).buffer}else B.debug("PlayReady request is already unwrapped."),a.headers["Content-Type"]=
"text/xml; charset=utf-8"}function td(a){var b=new Uint8Array(a.body);b="spc="+G.Mc(b);a.headers["Content-Type"]="application/x-www-form-urlencoded";a.body=Kb(b)}function ud(a){try{var b=Gb(a.data)}catch(c){return}b=b.trim();"<ckc>"===b.substr(0,5)&&"</ckc>"===b.substr(-6)&&(b=b.slice(5,-6));try{b=JSON.parse(b).ckc}catch(c){}a.data=G.Ja(b).buffer}
m.we=function(a){a=a.target;B.O("Key status changed for session",a.sessionId);var b=this.h.get(a),c=!1;a.keyStatuses.forEach(function(a,d){if("string"==typeof d){var e=d;d=a;a=e}if("com.microsoft.playready"==this.g.keySystem&&16==d.byteLength&&(Mc("Trident/")||navigator.userAgent.match(/Edge?\//))){e=new DataView(d);var f=e.getUint32(0,!0),l=e.getUint16(4,!0),n=e.getUint16(6,!0);e.setUint32(0,f,!1);e.setUint16(4,l,!1);e.setUint16(6,n,!1)}"com.microsoft.playready"==this.g.keySystem&&"status-pending"==
a&&(a="usable");"status-pending"!=a&&(b.loaded=!0);"expired"==a&&(c=!0);e=G.Nc(new Uint8Array(d));this.wa.set(e,a)}.bind(this));var d=a.expiration-Date.now();(0>d||c&&1E3>d)&&b&&!b.Ga&&(B.debug("Session has expired",a.sessionId),this.h["delete"](a),a.close()["catch"](function(){}));qd(this)&&(this.A.resolve(),this.X.V(wd))};
function Sc(a){var b=a.wa,c=a.da;c.clear();b.forEach(function(a,b){return c.set(b,a)});b=Array.from(c.values());b.length&&b.every(function(a){return"expired"==a})&&a.l(new D(2,6,6014));a.J.Dc(Cc(c))}
function xd(){function a(a){return u(function h(){var b,e,n;return y(h,function(h){switch(h.s){case 1:return Ba(h,2),v(h,navigator.requestMediaKeySystemAccess(a,c),4);case 4:return b=h.B,n=(e=b.getConfiguration().sessionTypes)?e.includes("persistent-license"):!1,Mc("Tizen 3")&&(n=!1),d.set(a,{persistentState:n}),v(h,b.createMediaKeys(),5);case 5:Fa(h,0);break;case 2:Ga(h),d.set(a,null),w(h)}})})}var b=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],c=[{videoCapabilities:b,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:b}],d=new Map;b="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(b){return a(b)});return Promise.all(b).then(function(){return Cc(d)})}
function yd(a,b){var c=b.audio,d=b.video;if(c&&c.encrypted&&(c=od(c),!md(a,c))||d&&d.encrypted&&(d=od(d),!md(a,d)))return!1;var e=ld(a.g);return 0==b.drmInfos.length||b.drmInfos.some(function(a){return a.keySystem==e})}
function zd(a,b){if(!a.length)return b;if(!b.length)return a;for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(a[d].keySystem==b[e].keySystem){var f=a[d];e=b[e];var h=[];h=h.concat(f.initData||[]);h=h.concat(e.initData||[]);var k=[];k=k.concat(f.keyIds);k=k.concat(e.keyIds);c.push({keySystem:f.keySystem,licenseServerUri:f.licenseServerUri||e.licenseServerUri,distinctiveIdentifierRequired:f.distinctiveIdentifierRequired||e.distinctiveIdentifierRequired,persistentStateRequired:f.persistentStateRequired||
e.persistentStateRequired,videoRobustness:f.videoRobustness||e.videoRobustness,audioRobustness:f.audioRobustness||e.audioRobustness,serverCertificate:f.serverCertificate||e.serverCertificate,initData:h,keyIds:k});break}return c}
function Ad(a){return u(function c(){var d;return y(c,function(c){switch(c.s){case 1:return d=new Promise(function(a,c){(new H(c)).V(Bd)}),Ba(c,2),v(c,Promise.race([Promise.all([a.close(),a.closed]),d]),4);case 4:Fa(c,0);break;case 2:Ga(c),B.v("Timeout waiting for session close"),w(c)}})})}
function Vc(a){return u(function c(){var d;return y(c,function(c){switch(c.s){case 1:return d=Array.from(a.h.keys()),a.h.clear(),v(c,Promise.all(d.map(function(a){return u(function k(){return y(k,function(c){switch(c.s){case 1:return B.K("Closing session",a.sessionId),Ba(c,2),v(c,Ad(a),4);case 4:Fa(c,0);break;case 2:Ga(c),w(c)}})})})),0)}})})}function Tc(a){a.h.forEach(function(b,c){var d=b.xd,e=c.expiration;isNaN(e)&&(e=Infinity);e!=d&&(a.J.onExpirationUpdated(c.sessionId,e),b.xd=e)})}
function qd(a){a=a.h.values();return Ac(a,function(a){return a.loaded})}function bd(a,b){var c=[];b.forEach(function(a,b){c.push({keySystem:b,licenseServerUri:a,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var d=t(a),e=d.next();!e.done;e=d.next())e.value.drmInfos=c}
function pd(a,b,c,d,e){a.forEach(function(a){b.includes(a.licenseServerUri)||b.push(a.licenseServerUri);a.serverCertificate&&(c.some(function(b){return G.Ha(b,a.serverCertificate)})||c.push(a.serverCertificate));a.initData&&a.initData.forEach(function(a){d.some(function(b){return b.keyId&&b.keyId==a.keyId?!0:b.initDataType==a.initDataType&&G.Ha(b.initData,a.initData)})||d.push(a)});if(a.keyIds)for(var f=0;f<a.keyIds.length;++f)e.includes(a.keyIds[f])||e.push(a.keyIds[f])})}
function cd(a,b,c){if(a.keySystem&&("org.w3.clearkey"!=a.keySystem||!a.licenseServerUri)){b.size&&(b=b.get(a.keySystem)||"",a.licenseServerUri=b);a.keyIds||(a.keyIds=[]);if(c=c.get(a.keySystem))a.distinctiveIdentifierRequired||(a.distinctiveIdentifierRequired=c.distinctiveIdentifierRequired),a.persistentStateRequired||(a.persistentStateRequired=c.persistentStateRequired),a.videoRobustness||(a.videoRobustness=c.videoRobustness),a.audioRobustness||(a.audioRobustness=c.audioRobustness),a.serverCertificate||
(a.serverCertificate=c.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==a.keySystem&&(a.keySystem="com.chromecast.playready")}}var Bd=1,vd=5,wd=.5;function Cd(){this.g=new muxjs.mp4.CaptionParser;this.l=[];this.j={}}Cd.prototype.init=function(a){var b=muxjs.mp4.probe;a=new Uint8Array(a);this.l=b.videoTrackIds(a);this.j=b.timescale(a);this.g.init()};Cd.prototype.h=function(a,b){var c=new Uint8Array(a);(c=this.g.parse(c,this.l,this.j))&&c.captions&&b(c.captions);this.g.clearParsedCaptions()};Cd.prototype.i=function(){this.g.resetCaptionStream()};function Dd(){}Dd.prototype.init=function(){};Dd.prototype.h=function(){};Dd.prototype.i=function(){};function Ed(a){return!a||1==a.length&&1E-6>a.end(0)-a.start(0)?null:a.length?a.end(a.length-1):null}function Fd(a,b,c){c=void 0===c?0:c;return!a||!a.length||1==a.length&&1E-6>a.end(0)-a.start(0)||b>a.end(a.length-1)?!1:b+c>=a.start(0)}function Gd(a,b){if(!a||!a.length||1==a.length&&1E-6>a.end(0)-a.start(0))return 0;for(var c=0,d=a.length-1;0<=d&&a.end(d)>b;--d)c+=a.end(d)-Math.max(a.start(d),b);return c}
function Hd(a){if(!a)return[];for(var b=[],c=0;c<a.length;c++)b.push({start:a.start(c),end:a.end(c)});return b};function Id(a,b,c){this.startTime=a;this.direction=Jd;this.endTime=b;this.payload=c;this.region=new Kd;this.position=null;this.positionAlign=Ld;this.size=0;this.textAlign=Nd;this.writingMode=Od;this.lineInterpretation=Pd;this.line=null;this.lineHeight="";this.lineAlign=Qd;this.displayAlign=Rd;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=Sd;this.fontStyle=Td;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}A("shaka.text.Cue",Id);Id.prototype.clone=function(){var a=new Id(0,0,""),b;for(b in this)a[b]=this[b],a[b]&&a[b].constructor==Array&&(a[b]=a[b].slice());return a};var Ld="auto";Id.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Ld};var Nd="center",Ud={LEFT:"left",RIGHT:"right",CENTER:Nd,START:"start",END:"end"};Id.textAlign=Ud;var Rd="after",Vd={BEFORE:"before",CENTER:"center",AFTER:Rd};Id.displayAlign=Vd;var Jd="ltr";Id.direction={HORIZONTAL_LEFT_TO_RIGHT:Jd,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};
var Od="horizontal-tb";Id.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Od,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Pd=0;Id.lineInterpretation={LINE_NUMBER:Pd,PERCENTAGE:1};var Qd="start",Wd={CENTER:"center",START:Qd,END:"end"};Id.lineAlign=Wd;var Sd=400;Id.fontWeight={NORMAL:Sd,BOLD:700};var Td="normal",Xd={NORMAL:Td,ITALIC:"italic",OBLIQUE:"oblique"};Id.fontStyle=Xd;Id.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function Kd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Yd;this.scroll=Zd}A("shaka.text.CueRegion",Kd);var Yd=1;Kd.units={PX:0,PERCENTAGE:Yd,LINES:2};var Zd="";Kd.scrollMode={NONE:Zd,UP:"up"};function $d(a){this.l=null;this.i=a;this.j=this.A=0;this.m=Infinity;this.h=this.g=null;this.u="";this.o=new Map}var ae={};A("shaka.text.TextEngine.registerParser",function(a,b){ae[a]=b});A("shaka.text.TextEngine.unregisterParser",function(a){delete ae[a]});function be(a){return ae[a]||window.muxjs&&"application/cea-608"==a?!0:!1}$d.prototype.destroy=function(){this.i=this.l=null;this.o.clear();return Promise.resolve()};function ce(a,b){"application/cea-608"!=b&&(a.l=new ae[b])}
$d.prototype.xc=function(a){var b={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.l.parseMedia(new Uint8Array(a),b)[0].startTime}catch(c){throw new D(2,2,2009,c);}};
function de(a,b,c,d){return Promise.resolve().then(function(){if(this.l&&this.i)if(null==c||null==d)this.l.parseInit(new Uint8Array(b));else{var a={periodStart:this.A,segmentStart:c,segmentEnd:d};a=this.l.parseMedia(new Uint8Array(b),a).filter(function(a){return a.startTime>=this.j&&a.startTime<this.m}.bind(this));this.i.append(a);null==this.g&&(this.g=Math.max(c,this.j));this.h=Math.min(d,this.m)}}.bind(a))}
$d.prototype.remove=function(a,b){return Promise.resolve().then(function(){!this.i||!this.i.remove(a,b)||null==this.g||b<=this.g||a>=this.h||(a<=this.g&&b>=this.h?this.g=this.h=null:a<=this.g&&b<this.h?this.g=b:a>this.g&&b>=this.h&&(this.h=a))}.bind(this))};function ee(a,b,c){a.u=b;if(b=a.o.get(b))for(var d=t(b.keys()),e=d.next();!e.done;e=d.next())(e=b.get(e.value).filter(function(a){return a.endTime<=c}))&&a.i.append(e)}
function fe(a,b,c,d,e){var f=c+" "+d,h=new Map;b=t(b);for(var k=b.next();!k.done;k=b.next()){var l=k.value;k=l.stream;h.has(k)||h.set(k,new Map);h.get(k).has(f)||h.get(k).set(f,[]);l.startTime+=e;l.endTime+=e;l.startTime>=a.j&&l.startTime<a.m&&(l=new Id(l.startTime,l.endTime,l.text),h.get(k).get(f).push(l),k==a.u&&a.i.append([l]))}e=t(h.keys());for(f=e.next();!f.done;f=e.next())for(f=f.value,a.o.has(f)||a.o.set(f,new Map),b=t(h.get(f).keys()),k=b.next();!k.done;k=b.next())k=k.value,l=h.get(f).get(k),
a.o.get(f).set(k,l);a.g=null==a.g?Math.max(c,a.j):Math.min(a.g,Math.max(c,a.j));a.h=Math.max(a.h,Math.min(d,a.m))};function ge(a,b,c){this.j=a;this.l=c;this.h={};this.g=null;this.i={};this.o=new M;this.F=!1;this.u={};this.A=b;this.C=new E;this.m=he(this,this.C);this.J=""}var ie=window.URL.createObjectURL;function he(a,b){var c=new MediaSource;a.o.ya(c,"sourceopen",function(){URL.revokeObjectURL(a.J);b.resolve()});a.J=ie(c);a.j.src=a.J;return c}function je(a){var b=Dc(a.mimeType,a.codecs),c=Ec(a);return be(b)||MediaSource.isTypeSupported(c)||Ob(b,a.type)}m=ge.prototype;
m.destroy=function(){var a=this;this.F=!0;var b=[],c;for(c in this.i){var d=this.i[c],e=d[0];this.i[c]=d.slice(0,1);e&&b.push(e.p["catch"](xb.Bc));for(e=1;e<d.length;++e)d[e].p.reject()}this.g&&b.push(this.g.destroy());this.l&&b.push(this.l.destroy());for(var f in this.u)b.push(this.u[f].destroy());return Promise.all(b).then(function(){a.o&&(a.o.release(),a.o=null);a.j&&(a.j.removeAttribute("src"),a.j.load(),a.j=null);a.m=null;a.g=null;a.l=null;a.h={};a.u={};a.A=null;a.i={}})};
m.init=function(a,b){var c=this;return u(function e(){var f;return y(e,function(e){switch(e.s){case 1:return f=Ab,v(e,c.C,2);case 2:a.forEach(function(a,e){var h=Dc(a.mimeType,a.codecs);e==f.za?ke(c,h):(!b&&MediaSource.isTypeSupported(h)||!Ob(h,e)||(c.u[e]=new Nb,h=Pb(e,h)),h=c.m.addSourceBuffer(h),c.o.H(h,"error",c.Dg.bind(c,e)),c.o.H(h,"updateend",c.Lb.bind(c,e)),c.h[e]=h,c.i[e]=[])}),w(e)}})})};function ke(a,b){a.g||(a.g=new $d(a.l));ce(a.g,b)}
function le(a){return a.m?"ended"==a.m.readyState:!0}function me(a,b){if("text"==b)var c=a.g.g;else c=ne(a,b),c=!c||1==c.length&&1E-6>c.end(0)-c.start(0)?null:1==c.length&&0>c.start(0)?0:c.length?c.start(0):null;return c}function oe(a,b){return"text"==b?a.g.h:Ed(ne(a,b))}function pe(a,b,c){if("text"==b)return a=a.g,null==a.h||a.h<c?0:a.h-Math.max(c,a.g);a=ne(a,b);return Gd(a,c)}
m.bd=function(a){a.total=Hd(this.j.buffered);a.audio=Hd(ne(this,"audio"));a.video=Hd(ne(this,"video"));a.text=[];if(this.g){var b=this.g.g,c=this.g.h;null!=b&&null!=c&&a.text.push({start:b,end:c})}};function ne(a,b){try{return a.h[b].buffered}catch(c){return b in a.h&&B.error("failed to get buffered range for "+b,c),null}}
function qe(a,b,c,d,e,f){if("text"==b)return de(a.g,c,d,e);if(a.u[b])return Qb(a.u[b],c).then(function(a){this.g||ke(this,"text/vtt");a.captions&&a.captions.length&&fe(this.g,a.captions,d,e,this.h.video.timestampOffset);return re(this,b,this.Me.bind(this,b,a.data.buffer))}.bind(a));f&&window.muxjs&&(a.g||ke(a,"text/vtt"),null==d&&null==e?a.A.init(c):a.A.h(c,function(b){b.length&&fe(a.g,b,d,e,a.h.video.timestampOffset)}));return re(a,b,a.Me.bind(a,b,c))}
function se(a,b){var c=oe(a,"video")||0;ee(a.g,b,c)}m.remove=function(a,b,c){return"text"==a?this.g.remove(b,c):re(this,a,this.Ne.bind(this,a,b,c))};function te(a,b){if("text"==b){if(!a.g)return Promise.resolve();a.A.i();return a.g.remove(0,Infinity)}return re(a,b,a.Ne.bind(a,b,0,a.m.duration))}m.flush=function(a){return"text"==a?Promise.resolve():re(this,a,this.lf.bind(this,a))};
function ue(a,b,c,d,e){return"text"==b?(a.g.A=c,a=a.g,a.j=d,a.m=e,Promise.resolve()):Promise.all([re(a,b,a.Ve.bind(a,b)),re(a,b,a.Cg.bind(a,b,c)),re(a,b,a.zg.bind(a,b,d,e))])}m.endOfStream=function(a){return ve(this,function(){le(this)||(a?this.m.endOfStream(a):this.m.endOfStream())}.bind(this))};m.Fa=function(a){return ve(this,function(){this.m.duration=a}.bind(this))};m.ha=function(){return this.m.duration};m.Me=function(a,b){this.h[a].appendBuffer(b)};
m.Ne=function(a,b,c){c<=b?this.Lb(a):this.h[a].remove(b,c)};m.Ve=function(a){var b=this.h[a].appendWindowStart,c=this.h[a].appendWindowEnd;this.h[a].abort();this.h[a].appendWindowStart=b;this.h[a].appendWindowEnd=c;this.Lb(a)};m.lf=function(a){this.j.currentTime-=.001;this.Lb(a)};m.Cg=function(a,b){0>b&&(b+=.001);this.h[a].timestampOffset=b;this.Lb(a)};m.zg=function(a,b,c){this.h[a].appendWindowStart=0;this.h[a].appendWindowEnd=c;this.h[a].appendWindowStart=b;this.Lb(a)};
m.Dg=function(a){this.i[a][0].p.reject(new D(2,3,3014,this.j.error?this.j.error.code:0))};m.Lb=function(a){var b=this.i[a][0];b&&(b.p.resolve(),we(this,a))};function re(a,b,c){if(a.F)return Promise.reject();c={start:c,p:new E};a.i[b].push(c);if(1==a.i[b].length)try{c.start()}catch(d){"QuotaExceededError"==d.name?c.p.reject(new D(2,3,3017,b)):c.p.reject(new D(2,3,3015,d)),we(a,b)}return c.p}
function ve(a,b){if(a.F)return Promise.reject();var c=[],d;for(d in a.h){var e=new E,f={start:function(a){a.resolve()}.bind(null,e),p:e};a.i[d].push(f);c.push(e);1==a.i[d].length&&f.start()}return Promise.all(c).then(function(){try{b()}catch(l){var a=Promise.reject(new D(2,3,3015,l))}for(var c in this.h)we(this,c);return a}.bind(a),function(a){throw a;}.bind(a))}function we(a,b){a.i[b].shift();var c=a.i[b][0];if(c)try{c.start()}catch(d){c.p.reject(new D(2,3,3015,d)),we(a,b)}};function xe(a,b){a=N(a);b=N(b);return a.split("-")[0]==b.split("-")[0]}function ye(a,b){a=N(a);b=N(b);var c=a.split("-"),d=b.split("-");return c[0]==d[0]&&1==c.length&&2==d.length}function N(a){var b=a.split("-");a=b[0]||"";b=b[1]||"";a=a.toLowerCase();a=ze.get(a)||a;return(b=b.toUpperCase())?a+"-"+b:a}function Ae(a){return a.language?N(a.language):a.audio&&a.audio.language?N(a.audio.language):a.video&&a.video.language?N(a.video.language):"und"}
function Be(a,b){for(var c=N(a),d=new Set,e=t(b),f=e.next();!f.done;f=e.next())d.add(N(f.value));e=t(d);for(f=e.next();!f.done;f=e.next())if(f=f.value,f==c)return f;e=t(d);for(f=e.next();!f.done;f=e.next())if(f=f.value,ye(f,c))return f;e=t(d);for(f=e.next();!f.done;f=e.next()){var h=f=f.value,k=c;h=N(h);k=N(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return f}d=t(d);for(f=d.next();!f.done;f=d.next())if(e=f.value,ye(c,e))return e;return null}
var ze=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);var O={$d:function(a,b){var c=a.periods.reduce(function(a,b){return a.concat(b.variants)},[]);c=O.ee(c,b);c=O.Lf(c);c=O.jf(c);var d=O.kf(c);c=t(a.periods);for(var e=c.next();!e.done;e=c.next())e=e.value,e.variants=e.variants.filter(function(a){if(O.he(a)==d)return!0;B.debug("Dropping Variant (better codec available)",a);return!1})},Lf:function(a){var b=new ac;a=t(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=O.he(c);b.push(d,c)}return b},jf:function(a){var b=0,c=new Map,d=a.size();a.forEach(function(a,
f){for(var e=t(f),k=e.next();!k.done;k=e.next()){k=k.value;var l=k.video;if(l&&l.width&&l.height){l=l.width*l.height*(l.frameRate||1);c.has(l)||c.set(l,new ac);var n=c.get(l);n.push(a,k);n.size()===d&&(b=Math.max(b,l))}}});return b?c.get(b):a},kf:function(a){var b="",c=Infinity;a.forEach(function(a,e){for(var d=0,h=0,k=t(e),l=k.next();!l.done;l=k.next())d+=l.value.bandwidth||0,++h;d/=h;B.debug("codecs",a,"avg bandwidth",d);d<c&&(b=a,c=d)});return b},he:function(a){var b="";a.video&&(b=Hc(a.video.codecs)[0]);
var c="";a.audio&&(c=Hc(a.audio.codecs)[0]);return b+"-"+c},rd:function(a,b,c){function d(a,b,c){return a>=b&&a<=c}var e=a.video;return e&&e.width&&e.height&&(!d(e.width,b.minWidth,Math.min(b.maxWidth,c.width))||!d(e.height,b.minHeight,Math.min(b.maxHeight,c.height))||!d(e.width*e.height,b.minPixels,b.maxPixels))||a&&a.video&&a.video.frameRate&&!d(a.video.frameRate,b.minFrameRate,b.maxFrameRate)||!d(a.bandwidth,b.minBandwidth,b.maxBandwidth)?!1:!0},Xd:function(a,b,c){var d=!1;a.forEach(function(a){var e=
a.allowedByApplication;a.allowedByApplication=O.rd(a,b,c);e!=a.allowedByApplication&&(d=!0)});return d},filterNewPeriod:function(a,b,c,d){d.variants=d.variants.filter(function(d){if(a&&a.Z&&!yd(a,d))return B.debug("Dropping variant - not compatible with key system",d),!1;var e=d.audio;d=d.video;return e&&!je(e)?(B.debug("Dropping variant - audio not compatible with platform",O.fb(e)),!1):d&&!je(d)||Mc("Xbox One")&&d&&(d.width&&1920<d.width||d.height&&1080<d.height)&&d.codecs.includes("avc1.")?(B.debug("Dropping variant - video not compatible with platform",
O.fb(d)),!1):e&&b&&!O.Yd(e,b)?(B.debug("Droping variant - not compatible with active audio","active audio",O.fb(b),"variant.audio",O.fb(e)),!1):d&&c&&!O.Yd(d,c)?(B.debug("Droping variant - not compatible with active video","active video",O.fb(c),"variant.video",O.fb(d)),!1):!0});d.textStreams=d.textStreams.filter(function(a){var b=be(Dc(a.mimeType,a.codecs));b||B.debug("Dropping text stream. Is not supported by the platform.",a);return b})},Yd:function(a,b){return a.mimeType!=b.mimeType||a.codecs.split(".")[0]!=
b.codecs.split(".")[0]?!1:!0},Oc:function(a){var b=a.audio,c=a.video,d=b?b.codecs:null,e=c?c.codecs:null,f=[];e&&f.push(e);d&&f.push(d);var h=[];c&&h.push(c.mimeType);b&&h.push(b.mimeType);h=h[0]||null;var k=[];b&&k.push(b.kind);c&&k.push(c.kind);k=k[0]||null;var l=new Set;b&&b.roles.forEach(function(a){return l.add(a)});c&&c.roles.forEach(function(a){return l.add(a)});a={id:a.id,active:!1,type:"variant",bandwidth:a.bandwidth,language:a.language,label:null,kind:k,width:null,height:null,frameRate:null,
pixelAspectRatio:null,mimeType:h,codecs:f.join(", "),audioCodec:d,videoCodec:e,primary:a.primary,roles:Array.from(l),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};c&&(a.videoId=c.id,a.originalVideoId=c.originalId,a.width=c.width||null,a.height=c.height||null,a.frameRate=c.frameRate||null,a.pixelAspectRatio=c.pixelAspectRatio||null,a.videoBandwidth=c.bandwidth||
null);b&&(a.audioId=b.id,a.originalAudioId=b.originalId,a.channelsCount=b.channelsCount,a.audioSamplingRate=b.audioSamplingRate,a.audioBandwidth=b.bandwidth||null,a.label=b.label,a.audioRoles=b.roles);return a},Kc:function(a){return{id:a.id,active:!1,type:"text",bandwidth:0,language:a.language,label:a.label,kind:a.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:a.mimeType,codecs:a.codecs||null,audioCodec:null,videoCodec:null,primary:a.primary,roles:a.roles,audioRoles:null,
videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:a.originalId}},gd:function(a){a.__shaka_id||(a.__shaka_id=O.Uf++);return a.__shaka_id},Uf:0,Of:function(a){var b=O.ke(a);b.active="disabled"!=a.mode;b.type="text";b.originalTextId=a.id;"captions"==a.kind&&(b.mimeType="application/cea-608");a.kind&&(b.roles=[a.kind]);return b},je:function(a){var b=O.ke(a);b.active=a.enabled;b.type="variant";
b.originalAudioId=a.id;"main"==a.kind&&(b.primary=!0);a.kind&&(b.roles=[a.kind],b.audioRoles=[a.kind]);return b},ke:function(a){return{id:O.gd(a),active:!1,type:"",bandwidth:0,language:N(a.language),label:a.label,kind:a.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,
originalAudioId:null,originalTextId:null}},Gb:function(a){return a.allowedByApplication&&a.allowedByKeySystem},Bf:function(a){return a.filter(function(a){return O.Gb(a)})},ee:function(a,b){var c=a.filter(function(a){return a.audio&&a.audio.channelsCount}),d=new Map;c=t(c);for(var e=c.next();!e.done;e=c.next()){e=e.value;var f=e.audio.channelsCount;d.has(f)||d.set(f,[]);d.get(f).push(e)}c=Array.from(d.keys());if(0==c.length)return a;e=c.filter(function(a){return a<=b});return e.length?d.get(Math.max.apply(null,
e)):d.get(Math.min.apply(null,c))},Wb:function(a,b,c){var d=a,e=a.filter(function(a){return a.primary});e.length&&(d=e);var f=d.length?d[0].language:"";d=d.filter(function(a){return a.language==f});if(b){var h=Be(N(b),a.map(function(a){return a.language}));h&&(d=a.filter(function(a){return N(a.language)==h}))}if(c){a=O.de(d,c);if(a.length)return a;B.v("No exact match for the text role could be found.")}else if(a=d.filter(function(a){return 0==a.roles.length}),a.length)return a;a=d.map(function(a){return a.roles}).reduce(xb.Rc,
[]);return a.length?O.de(d,a[0]):d},de:function(a,b){return a.filter(function(a){return a.roles.includes(b)})},ie:function(a,b,c){for(var d=0;d<c.length;d++)if(c[d].audio==a&&c[d].video==b)return c[d];return null},Pf:function(a){return"audio"==a.type},Sf:function(a){return"video"==a.type},Kf:function(a){var b=[];a.audio&&b.push(a.audio);a.video&&b.push(a.video);return b},fb:function(a){return O.Pf(a)?"type=audio codecs="+a.codecs+" bandwidth="+a.bandwidth+" channelsCount="+a.channelsCount+" audioSamplingRate="+
a.audioSamplingRate:O.Sf(a)?"type=video codecs="+a.codecs+" bandwidth="+a.bandwidth+" frameRate="+a.frameRate+" width="+a.width+" height="+a.height:"unexpected stream type"}};function P(){this.m=null;this.i=!1;this.h=new fb;this.l=[];this.o=!1;this.g=this.j=null}A("shaka.abr.SimpleAbrManager",P);P.prototype.stop=function(){this.m=null;this.i=!1;this.l=[];this.j=null};P.prototype.stop=P.prototype.stop;P.prototype.init=function(a){this.m=a};P.prototype.init=P.prototype.init;
P.prototype.chooseVariant=function(){var a=Ce(this.g.restrictions,this.l),b=this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate);this.l.length&&!a.length&&(B.v("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),a=Ce(null,this.l),a=[a[0]]);for(var c=a[0]||null,d=0;d<a.length;++d){var e=a[d],f=e.bandwidth/this.g.bandwidthDowngradeTarget,h=(a[d+1]||{bandwidth:Infinity}).bandwidth/this.g.bandwidthUpgradeTarget;B.O("Bandwidth ranges:",(e.bandwidth/1E6).toFixed(3),
(f/1E6).toFixed(3),(h/1E6).toFixed(3));b>=f&&b<=h&&(c=e)}this.j=Date.now();return c};P.prototype.chooseVariant=P.prototype.chooseVariant;P.prototype.enable=function(){this.i=!0};P.prototype.enable=P.prototype.enable;P.prototype.disable=function(){this.i=!1};P.prototype.disable=P.prototype.disable;
P.prototype.segmentDownloaded=function(a,b){B.O("Segment downloaded:","deltaTimeMs="+a,"numBytes="+b,"lastTimeChosenMs="+this.j,"enabled="+this.i);var c=this.h;if(!(16E3>b)){var d=8E3*b/a,e=a/1E3;c.g+=b;db(c.h,e,d);db(c.i,e,d)}if(null!=this.j&&this.i)a:{B.O("Suggesting Streams...");if(!this.o){if(!(128E3<=this.h.g)){B.O("Still waiting for a good estimate...");break a}this.o=!0}else if(Date.now()-this.j<1E3*this.g.switchInterval){B.O("Still within switch interval...");break a}c=this.chooseVariant();
d=this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate);B.debug("Calling switch_(), bandwidth="+Math.round(d/1E3)+" kbps");this.m(c)}};P.prototype.segmentDownloaded=P.prototype.segmentDownloaded;P.prototype.getBandwidthEstimate=function(){return this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate)};P.prototype.getBandwidthEstimate=P.prototype.getBandwidthEstimate;P.prototype.setVariants=function(a){this.l=a};P.prototype.setVariants=P.prototype.setVariants;
P.prototype.configure=function(a){this.g=a};P.prototype.configure=P.prototype.configure;function Ce(a,b){a&&(b=b.filter(function(b){return O.rd(b,a,{width:Infinity,height:Infinity})}));return b.sort(function(a,b){return a.bandwidth-b.bandwidth})};function De(a,b){this.g=a;this.h=b}De.prototype.toString=function(){return"v"+this.g+"."+this.h};function Ee(a,b){var c=new De(2,6),d=Fe,e=d.g,f=c.h-e.h;(0<(c.g-e.g||f)?d.i:d.h)(d.g,c,a,b)}function Ge(a,b,c,d){B.ba([c,"has been deprecated and will be removed in",b,". We are currently at version",a,". Additional information:",d].join(" "))}function He(a,b,c,d){B.kc([c,"has been deprecated and has been removed in",b,". We are now at version",a,". Additional information:",d].join(""))}var Fe=null;var Ie="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Je="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Ke=["loop","playbackRate"],Le=["pause","play"],Me="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),
Ne={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},Oe={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Pe=[["getConfiguration","configure"]],Qe=[["isTextTrackVisible","setTextTrackVisibility"]],
Re="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),Se=["attach","detach","load","unload"];
function Te(a){return JSON.stringify(a,function(a,c){if("function"!=typeof c){if(c instanceof Event||c instanceof K){var b={};for(f in c){var e=c[f];e&&"object"==typeof e?"detail"==f&&(b[f]=e):f in Event||(b[f]=e)}return b}if(c instanceof Error){var f=new Set(["name","message","stack"]);for(b in c)f.add(b);e=t(Object.getOwnPropertyNames(c));for(b=e.next();!b.done;b=e.next())f.add(b.value);e={};f=t(f);for(b=f.next();!b.done;b=f.next())b=b.value,e[b]=c[b];f={__type__:"Error",contents:e}}else if(c instanceof
TimeRanges)for(f={__type__:"TimeRanges",length:c.length,start:[],end:[]},b=0;b<c.length;++b)f.start.push(c.start(b)),f.end.push(c.end(b));else f=c instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(c)}:"number"==typeof c?isNaN(c)?"NaN":isFinite(c)?c:0>c?"-Infinity":"Infinity":c;return f}})}
function Ue(a){return JSON.parse(a,function(a,c){if("NaN"==c)var b=NaN;else if("-Infinity"==c)b=-Infinity;else if("Infinity"==c)b=Infinity;else if(c&&"object"==typeof c&&"TimeRanges"==c.__type__)b=Ve(c);else if(c&&"object"==typeof c&&"Uint8Array"==c.__type__)b=new Uint8Array(c.entries);else if(c&&"object"==typeof c&&"Error"==c.__type__){b=c.contents;var e=Error(b.message),f;for(f in b)e[f]=b[f];b=e}else b=c;return b})}
function Ve(a){return{length:a.length,start:function(b){return a.start[b]},end:function(b){return a.end[b]}}};function We(a,b,c,d,e,f){this.X=a;this.j=new H(b);this.Z=c;this.u=!1;this.F=d;this.P=e;this.L=f;this.h=this.m=!1;this.M="";this.o=null;this.A=this.yd.bind(this);this.C=this.ag.bind(this);this.g={video:{},player:{}};this.J=0;this.i={};this.l=null;Xe.add(this)}var Ye=!1,Ze=null;m=We.prototype;m.destroy=function(){Xe["delete"](this);$e(this);Ze&&af(this);this.j&&(this.j.stop(),this.j=null);this.P=this.F=null;this.h=this.m=!1;this.C=this.A=this.l=this.i=this.g=this.o=null;return Promise.resolve()};
m.la=function(){return this.h};m.Dd=function(){return this.M};
m.init=function(){if(this.X.length)if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0;this.j.Lc();var a=new chrome.cast.SessionRequest(this.X);a=new chrome.cast.ApiConfig(a,bf.bind(this),cf.bind(this),"origin_scoped");chrome.cast.initialize(a,function(){B.debug("CastSender: init")},function(a){B.error("CastSender: init error",a)});Ye&&this.j.V(.02);(a=Ze)&&a.status!=chrome.cast.SessionStatus.STOPPED?(B.debug("CastSender: re-using existing connection"),df(this,a)):Ze=null}else window.__onGCastApiAvailable||
(window.__onGCastApiAvailable=ef),window.__onGCastApiAvailable!=ef&&B.ba("A global Cast SDK hook is already installed! Shaka Player will be unable to receive a notification when the Cast SDK is ready.")};m.Md=function(a){this.o=a;this.h&&ff(this,{type:"appData",appData:this.o})};
m.cast=function(a){if(!this.m)return Promise.reject(new D(1,8,8E3));if(!Ye)return Promise.reject(new D(1,8,8001));if(this.h)return Promise.reject(new D(1,8,8002));this.l=new E;chrome.cast.requestSession(this.Ad.bind(this,a),this.ve.bind(this));return this.l};m.Bb=function(){if(this.h){$e(this);if(Ze){af(this);try{Ze.stop(function(){},function(){})}catch(a){}Ze=null}this.yd()}};
m.get=function(a,b){if("video"==a){if(Le.includes(b))return this.Ee.bind(this,a,b)}else if("player"==a){if(Oe[b]&&!this.get("player","isLive")())return function(){};if(Re.includes(b))return this.Ee.bind(this,a,b);if(Se.includes(b))return this.rg.bind(this,a,b);if(Ne[b])return this.Be.bind(this,a,b)}return this.Be(a,b)};m.set=function(a,b,c){this.g[a][b]=c;ff(this,{type:"set",targetName:a,property:b,value:c})};
m.Ad=function(a,b){B.debug("CastSender: onSessionInitiated");Ze=b;b.addUpdateListener(this.A);b.addMessageListener("urn:x-cast:com.google.shaka.v2",this.C);this.yd();ff(this,{type:"init",initState:a,appData:this.o});this.l.resolve()};m.ve=function(a){var b=8003;switch(a.code){case "cancel":b=8004;break;case "timeout":b=8005;break;case "receiver_unavailable":b=8006}this.l.reject(new D(2,8,b,a))};m.Be=function(a,b){return this.g[a][b]};
m.Ee=function(a,b,c){for(var d=[],e=2;e<arguments.length;++e)d[e-2]=arguments[e];ff(this,{type:"call",targetName:a,methodName:b,args:d})};m.rg=function(a,b,c){for(var d=[],e=2;e<arguments.length;++e)d[e-2]=arguments[e];e=new E;var f=this.J.toString();this.J++;this.i[f]=e;try{ff(this,{type:"asyncCall",targetName:a,methodName:b,args:d,id:f})}catch(h){e.reject(h)}return e};function bf(a){for(var b=t(Xe),c=b.next();!c.done;c=b.next())df(c.value,a)}
function df(a,b){B.debug("CastSender: onExistingSessionJoined");var c=a.L();a.l=new E;a.u=!0;a.Ad(c,b)}function cf(a){for(var b=t(Xe),c=b.next();!c.done;c=b.next()){c=c.value;var d=a;B.debug("CastSender: receiver status",d);Ye="available"==d;c.j.Lc()}}function af(a){var b=Ze;b.removeUpdateListener(a.A);b.removeMessageListener("urn:x-cast:com.google.shaka.v2",a.C)}
m.yd=function(){var a=Ze?"connected"==Ze.status:!1;B.debug("CastSender: connection status",a);if(this.h&&!a){this.P();for(var b in this.g)this.g[b]={};$e(this)}this.M=(this.h=a)?Ze.receiver.friendlyName:"";this.j.Lc()};function $e(a){for(var b in a.i){var c=a.i[b];delete a.i[b];c.reject(new D(1,7,7E3))}}
m.ag=function(a,b){var c=Ue(b);B.O("CastSender: message",c);switch(c.type){case "event":var d=c.event;this.F(c.targetName,new K(d.type,d));break;case "update":d=c.update;for(var e in d){c=this.g[e]||{};for(var f in d[e])c[f]=d[e][f]}this.u&&(this.Z(),this.u=!1);break;case "asyncComplete":if(e=c.id,c=c.error,f=this.i[e],delete this.i[e],f)if(c){e=new D(c.severity,c.category,c.code);for(d in c)e[d]=c[d];f.reject(e)}else f.resolve()}};
function ff(a,b){var c=Te(b),d=Ze;try{d.sendMessage("urn:x-cast:com.google.shaka.v2",c,function(){},B.error)}catch(e){throw B.error("Cast session sendMessage threw",e),c=new D(2,8,8005,e),a.F("player",new K("error",{detail:c})),a.Bb(),c;}}var Xe=new Set;function ef(a){if(a){a=t(Xe);for(var b=a.next();!b.done;b=a.next())b.value.init()}};function Q(a,b,c){var d=this;bc.call(this);this.i=a;this.h=b;this.o=this.l=this.j=this.u=this.m=null;this.C=c;this.A=new Map;this.g=new We(c,function(){return gf(d)},function(){return hf(d)},function(a,b){return jf(d,a,b)},function(){return kf(d)},function(){return lf(d)});mf(this)}bb(Q,bc);A("shaka.cast.CastProxy",Q);
Q.prototype.destroy=function(a){a&&this.g.Bb();this.o&&(this.o.release(),this.o=null);a=[];this.h&&(a.push(this.h.destroy()),this.h=null);this.g&&(a.push(this.g.destroy()),this.g=null);this.u=this.m=this.i=null;return Promise.all(a)};Q.prototype.destroy=Q.prototype.destroy;Q.prototype.Mf=function(){return this.m};Q.prototype.getVideo=Q.prototype.Mf;Q.prototype.Df=function(){return this.u};Q.prototype.getPlayer=Q.prototype.Df;Q.prototype.Ye=function(){return this.g.m&&Ye};Q.prototype.canCast=Q.prototype.Ye;
Q.prototype.la=function(){return this.g.la()};Q.prototype.isCasting=Q.prototype.la;Q.prototype.Dd=function(){return this.g.Dd()};Q.prototype.receiverName=Q.prototype.Dd;Q.prototype.cast=function(){var a=lf(this);return this.g.cast(a).then(function(){if(this.h)return this.h.Ud()}.bind(this))};Q.prototype.cast=Q.prototype.cast;Q.prototype.Md=function(a){this.g.Md(a)};Q.prototype.setAppData=Q.prototype.Md;
Q.prototype.Kg=function(){var a=this.g;if(a.h){var b=a.L();chrome.cast.requestSession(a.Ad.bind(a,b),a.ve.bind(a))}};Q.prototype.suggestDisconnect=Q.prototype.Kg;
Q.prototype.af=function(a){var b=this;return u(function d(){return y(d,function(d){switch(d.s){case 1:if(a==b.C)return d["return"]();b.C=a;b.g.Bb();return v(d,b.g.destroy(),2);case 2:b.g=null,b.g=new We(a,function(){return gf(b)},function(){return hf(b)},function(a,d){return jf(b,a,d)},function(){return kf(b)},function(){return lf(b)}),b.g.init(),w(d)}})})};Q.prototype.changeReceiverId=Q.prototype.af;Q.prototype.Bb=function(){this.g.Bb()};Q.prototype.forceDisconnect=Q.prototype.Bb;
function mf(a){a.g.init();a.o=new M;Ie.forEach(function(a){this.o.H(this.i,a,this.L.bind(this))}.bind(a));Me.forEach(function(a){this.o.H(this.h,a,this.F.bind(this))}.bind(a));a.m={};for(var b in a.i)Object.defineProperty(a.m,b,{configurable:!1,enumerable:!0,get:a.J.bind(a,b),set:a.M.bind(a,b)});a.u={};nf(a,function(b){Object.defineProperty(a.u,b,{configurable:!1,enumerable:!0,get:function(){return of(a,b)}})});pf(a);a.j=new bc;a.j.jc=a.m;a.l=new bc;a.l.jc=a.u}
function pf(a){var b=new Map;nf(a,function(c,d){if(b.has(d)){var e=b.get(d);c.length<e.length?a.A.set(c,e):a.A.set(e,c)}else b.set(d,c)})}
function nf(a,b){function c(a){return"constructor"==a||"function"!=typeof d[a]?!1:!e.has(a)}var d=a.h,e=new Set;for(f in d)c(f)&&(e.add(f),b(f,d[f]));var f=Object.getPrototypeOf(d);for(var h=Object.getPrototypeOf({});f&&f!=h;){for(var k=t(Object.getOwnPropertyNames(f)),l=k.next();!l.done;l=k.next())l=l.value,c(l)&&(e.add(l),b(l,d[l]));f=Object.getPrototypeOf(f)}}
function lf(a){var b={video:{},player:{},playerAfterLoad:{},manifest:a.h.tc(),startTime:null};a.i.pause();Ke.forEach(function(a){b.video[a]=this.i[a]}.bind(a));a.i.ended||(b.startTime=a.i.currentTime);Pe.forEach(function(a){var c=a[1];a=this.h[a[0]]();b.player[c]=a}.bind(a));Qe.forEach(function(a){var c=a[1];a=this.h[a[0]]();b.playerAfterLoad[c]=a}.bind(a));return b}function gf(a){a.dispatchEvent(new K("caststatuschanged"))}function hf(a){a.j.dispatchEvent(new K(a.m.paused?"pause":"play"))}
function kf(a){Pe.forEach(function(a){var b=a[1];a=this.g.get("player",a[0])();this.h[b](a)}.bind(a));var b=a.g.get("player","getAssetUri")(),c=a.g.get("video","ended"),d=Promise.resolve(),e=a.i.autoplay,f=null;c||(f=a.g.get("video","currentTime"));b&&(a.i.autoplay=!1,d=a.h.load(b,f));var h={};Ke.forEach(function(a){h[a]=this.g.get("video",a)}.bind(a));d.then(function(){a.i&&(Ke.forEach(function(a){this.i[a]=h[a]}.bind(a)),Qe.forEach(function(a){var b=a[1];a=this.g.get("player",a[0])();this.h[b](a)}.bind(a)),
a.i.autoplay=e,b&&a.i.play())},function(b){a.h.dispatchEvent(new K("error",{detail:b}))})}Q.prototype.J=function(a){if("addEventListener"==a)return this.j.addEventListener.bind(this.j);if("removeEventListener"==a)return this.j.removeEventListener.bind(this.j);if(this.g.la()&&0==Object.keys(this.g.g.video).length){var b=this.i[a];if("function"!=typeof b)return b}return this.g.la()?this.g.get("video",a):(a=this.i[a],"function"==typeof a&&(a=a.bind(this.i)),a)};
Q.prototype.M=function(a,b){this.g.la()?this.g.set("video",a,b):this.i[a]=b};Q.prototype.L=function(a){this.g.la()||this.j.dispatchEvent(new K(a.type,a))};
function of(a,b){a.A.has(b)&&(b=a.A.get(b));if("addEventListener"==b)return a.l.addEventListener.bind(a.l);if("removeEventListener"==b)return a.l.removeEventListener.bind(a.l);if("getMediaElement"==b)return function(){return this.m}.bind(a);if("getSharedConfiguration"==b)return B.v("Can't share configuration across a network. Returning copy."),a.g.get("player","getConfiguration");if("getNetworkingEngine"==b)return a.g.la()&&B.v("NOTE: getNetworkingEngine() is always local!"),a.h.Yb.bind(a.h);if(a.g.la()){if("getManifest"==
b||"drmInfo"==b)return function(){B.ba(b+"() does not work while casting!");return null};if("getManifestUri"==b)return Ee("getManifestUri",'Please use "getAssetUri" instead.'),of(a,"getAssetUri");if("attach"==b||"detach"==b)return function(){B.ba(b+"() does not work while casting!");return Promise.resolve()}}return a.g.la()&&0==Object.keys(a.g.g.video).length&&Ne[b]||!a.g.la()?a.h[b].bind(a.h):a.g.get("player",b)}Q.prototype.F=function(a){this.g.la()||this.l.dispatchEvent(a)};
function jf(a,b,c){a.g.la()&&("video"==b?a.j.dispatchEvent(c):"player"==b&&a.l.dispatchEvent(c))};function qf(a,b,c,d){var e=this;bc.call(this);this.g=a;this.h=b;this.i=new M;this.L={video:a,player:b};this.C=c||function(){};this.M=d||function(a){return a};this.F=!1;this.m=!0;this.l=0;this.A=!1;this.u=!0;this.o=this.j=null;this.J=new H(function(){rf(e)});sf(this)}bb(qf,bc);A("shaka.cast.CastReceiver",qf);qf.prototype.isConnected=function(){return this.F};qf.prototype.isConnected=qf.prototype.isConnected;qf.prototype.Rf=function(){return this.m};qf.prototype.isIdle=qf.prototype.Rf;
qf.prototype.destroy=function(){var a=this;return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:return a.i&&(a.i.release(),a.i=null),d=[],a.h&&(d.push(a.h.destroy()),a.h=null),a.J&&(a.J.stop(),a.J=null),a.g=null,a.L=null,a.C=null,a.F=!1,a.m=!0,a.j=null,a.o=null,v(c,Promise.all(d),2);case 2:e=cast.receiver.CastReceiverManager.getInstance(),e.stop(),w(c)}})})};qf.prototype.destroy=qf.prototype.destroy;
function sf(a){var b=cast.receiver.CastReceiverManager.getInstance();b.onSenderConnected=a.xe.bind(a);b.onSenderDisconnected=a.xe.bind(a);b.onSystemVolumeChanged=a.hf.bind(a);a.o=b.getCastMessageBus("urn:x-cast:com.google.cast.media");a.o.onMessage=a.Wf.bind(a);a.j=b.getCastMessageBus("urn:x-cast:com.google.shaka.v2");a.j.onMessage=a.fg.bind(a);b.start();Ie.forEach(function(a){this.i.H(this.g,a,this.Ce.bind(this,"video"))}.bind(a));Me.forEach(function(a){this.i.H(this.h,a,this.Ce.bind(this,"player"))}.bind(a));
cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?a.h.Nd(3840,2160):a.h.Nd(1920,1080);a.i.H(a.g,"loadeddata",function(){this.A=!0}.bind(a));a.i.H(a.h,"loading",function(){this.m=!1;tf(this)}.bind(a));a.i.H(a.g,"playing",function(){this.m=!1;tf(this)}.bind(a));a.i.H(a.g,"pause",function(){tf(this)}.bind(a));a.i.H(a.h,"unloading",function(){this.m=!0;tf(this)}.bind(a));a.i.H(a.g,"ended",function(){var a=this;(new H(function(){a.g&&a.g.ended&&
(a.m=!0,tf(a))})).V(5)}.bind(a))}m=qf.prototype;m.xe=function(){this.l=0;this.u=!0;this.F=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length;tf(this)};function tf(a){Promise.resolve().then(function(){this.h&&(this.dispatchEvent(new K("caststatuschanged")),uf(this)||vf(this))}.bind(a))}
function wf(a,b,c){for(var d in b.player)a.h[d](b.player[d]);a.C(c);c=Promise.resolve();var e=a.g.autoplay;b.manifest&&(a.g.autoplay=!1,c=a.h.load(b.manifest,b.startTime));c.then(function(){if(a.h){for(var c in b.video)a.g[c]=b.video[c];for(var d in b.playerAfterLoad)a.h[d](b.playerAfterLoad[d]);a.g.autoplay=e;b.manifest&&(a.g.play(),vf(a))}},function(b){a.h.dispatchEvent(new K("error",{detail:b}))})}m.Ce=function(a,b){this.h&&(rf(this),xf(this,{type:"event",targetName:a,event:b},this.j))};
function rf(a){a.J.V(.5);var b={video:{},player:{}};Je.forEach(function(a){b.video[a]=this.g[a]}.bind(a));if(a.h.aa())for(var c in Oe)0==a.l%Oe[c]&&(b.player[c]=a.h[c]());for(var d in Ne)0==a.l%Ne[d]&&(b.player[d]=a.h[d]());if(c=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())b.video.volume=c.level,b.video.muted=c.muted;a.A&&(a.l+=1);xf(a,{type:"update",update:b},a.j);uf(a)}function uf(a){return a.u&&(a.g.duration||a.h.aa())?(yf(a),a.u=!1,!0):!1}
function yf(a,b){b=void 0===b?0:b;var c={contentId:a.h.tc(),streamType:a.h.aa()?"LIVE":"BUFFERED",contentType:""};a.h.aa()||(c.duration=a.g.duration);vf(a,b,c)}m.hf=function(){var a=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();a&&xf(this,{type:"update",update:{video:{volume:a.level,muted:a.muted}}},this.j);xf(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.j)};
m.fg=function(a){var b=Ue(a.data);B.debug("CastReceiver: message",b);switch(b.type){case "init":this.l=0;this.A=!1;this.u=!0;wf(this,b.initState,b.appData);rf(this);break;case "appData":this.C(b.appData);break;case "set":var c=b.targetName,d=b.property;b=b.value;if("video"==c){var e=cast.receiver.CastReceiverManager.getInstance();if("volume"==d){e.setSystemVolumeLevel(b);break}else if("muted"==d){e.setSystemVolumeMuted(b);break}}this.L[c][d]=b;break;case "call":c=this.L[b.targetName];c[b.methodName].apply(c,
b.args);break;case "asyncCall":c=b.targetName;d=b.methodName;"player"==c&&"load"==d&&(this.l=0,this.A=!1);e=b.id;a=a.senderId;var f=this.L[c];b=f[d].apply(f,b.args);"player"==c&&"load"==d&&(b=b.then(function(){this.u=!0}.bind(this)));b.then(this.Je.bind(this,a,e,null),this.Je.bind(this,a,e))}};
m.Wf=function(a){var b=Ue(a.data);B.debug("CastReceiver: message",b);switch(b.type){case "PLAY":this.g.play();vf(this);break;case "PAUSE":this.g.pause();vf(this);break;case "SEEK":a=b.currentTime;var c=b.resumeState;null!=a&&(this.g.currentTime=Number(a));c&&"PLAYBACK_START"==c?(this.g.play(),vf(this)):c&&"PLAYBACK_PAUSE"==c&&(this.g.pause(),vf(this));break;case "STOP":this.h.Ud().then(function(){this.h&&vf(this)}.bind(this));break;case "GET_STATUS":yf(this,Number(b.requestId));break;case "VOLUME":c=
b.volume;a=c.level;c=c.muted;var d=this.g.volume,e=this.g.muted;null!=a&&(this.g.volume=Number(a));null!=c&&(this.g.muted=c);d==this.g.volume&&e==this.g.muted||vf(this);break;case "LOAD":this.l=0;this.u=this.A=!1;a=b.media;c=b.currentTime;d=this.M(a.contentId);e=b.autoplay||!0;this.C(a.customData);e&&(this.g.autoplay=!0);this.h.load(d,c).then(function(){this.h&&yf(this)}.bind(this))["catch"](function(a){var c="LOAD_FAILED";7==a.category&&7E3==a.code&&(c="LOAD_CANCELLED");xf(this,{requestId:Number(b.requestId),
type:c},this.o)}.bind(this));break;default:B.v("Unrecognized message type from the generic Chromecast controller!",b.type),xf(this,{requestId:Number(b.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.o)}};m.Je=function(a,b,c){this.h&&xf(this,{type:"asyncComplete",id:b,error:c},this.j,a)};function xf(a,b,c,d){a.F&&(a=Te(b),d?c.getCastChannel(d).send(a):c.broadcast(a))}
function vf(a,b,c){b=void 0===b?0:b;c=void 0===c?null:c;var d=a.g.playbackRate;var e=zf;e=a.m?e.IDLE:a.h.jd()?e.Re:a.g.paused?e.Te:e.Ue;d={mediaSessionId:0,playbackRate:d,playerState:e,currentTime:a.g.currentTime,supportedMediaCommands:63,volume:{level:a.g.volume,muted:a.g.muted}};c&&(d.media=c);xf(a,{requestId:b,type:"MEDIA_STATUS",status:[d]},a.o)}var zf={IDLE:"IDLE",Ue:"PLAYING",Re:"BUFFERING",Te:"PAUSED"};function S(a,b){this.S=a;this.h=b==Af;this.g=0}A("shaka.util.DataViewReader",S);var Af=1;S.Endianness={Tg:0,Vg:Af};S.prototype.Ca=function(){return this.g<this.S.byteLength};S.prototype.hasMoreData=S.prototype.Ca;S.prototype.ka=function(){return this.g};S.prototype.getPosition=S.prototype.ka;S.prototype.sf=function(){return this.S.byteLength};S.prototype.getLength=S.prototype.sf;S.prototype.ra=function(){try{var a=this.S.getUint8(this.g);this.g+=1;return a}catch(b){Bf()}};S.prototype.readUint8=S.prototype.ra;
S.prototype.dc=function(){try{var a=this.S.getUint16(this.g,this.h);this.g+=2;return a}catch(b){Bf()}};S.prototype.readUint16=S.prototype.dc;S.prototype.N=function(){try{var a=this.S.getUint32(this.g,this.h);this.g+=4;return a}catch(b){Bf()}};S.prototype.readUint32=S.prototype.N;S.prototype.De=function(){try{var a=this.S.getInt32(this.g,this.h);this.g+=4;return a}catch(b){Bf()}};S.prototype.readInt32=S.prototype.De;
S.prototype.Pb=function(){try{if(this.h){var a=this.S.getUint32(this.g,!0);var b=this.S.getUint32(this.g+4,!0)}else b=this.S.getUint32(this.g,!1),a=this.S.getUint32(this.g+4,!1)}catch(c){Bf()}if(2097151<b)throw new D(2,3,3001);this.g+=8;return b*Math.pow(2,32)+a};S.prototype.readUint64=S.prototype.Pb;S.prototype.mb=function(a){this.g+a>this.S.byteLength&&Bf();var b=new Uint8Array(this.S.buffer,this.S.byteOffset+this.g,a);this.g+=a;return b};S.prototype.readBytes=S.prototype.mb;
S.prototype.U=function(a){this.g+a>this.S.byteLength&&Bf();this.g+=a};S.prototype.skip=S.prototype.U;S.prototype.Fe=function(a){this.g<a&&Bf();this.g-=a};S.prototype.rewind=S.prototype.Fe;S.prototype.seek=function(a){(0>a||a>this.S.byteLength)&&Bf();this.g=a};S.prototype.seek=S.prototype.seek;S.prototype.Cd=function(){for(var a=this.g;this.Ca()&&0!=this.S.getUint8(this.g);)this.g+=1;a=new Uint8Array(this.S.buffer,this.S.byteOffset+a,this.g-a);this.g+=1;return Gb(a)};
S.prototype.readTerminatedString=S.prototype.Cd;function Bf(){throw new D(2,3,3E3);};function T(){this.i=[];this.h=[];this.g=!1}A("shaka.util.Mp4Parser",T);T.prototype.box=function(a,b){var c=Cf(a);this.i[c]=0;this.h[c]=b;return this};T.prototype.box=T.prototype.box;T.prototype.ma=function(a,b){var c=Cf(a);this.i[c]=1;this.h[c]=b;return this};T.prototype.fullBox=T.prototype.ma;T.prototype.stop=function(){this.g=!0};T.prototype.stop=T.prototype.stop;
T.prototype.parse=function(a,b){var c=new Uint8Array(a);c=new S(new DataView(c.buffer,c.byteOffset,c.byteLength),0);for(this.g=!1;c.Ca()&&!this.g;)this.Fc(0,c,b)};T.prototype.parse=T.prototype.parse;
T.prototype.Fc=function(a,b,c){var d=b.ka(),e=b.N(),f=b.N(),h=!1;B.O("Parsing MP4 box",Df(f));switch(e){case 0:e=b.S.byteLength-d;break;case 1:e=b.Pb(),h=!0}var k=this.h[f];if(k){var l=null,n=null;1==this.i[f]&&(n=b.N(),l=n>>>24,n&=16777215);f=d+e;c&&f>b.S.byteLength&&(f=b.S.byteLength);f-=b.ka();b=0<f?b.mb(f):new Uint8Array(0);b=new S(new DataView(b.buffer,b.byteOffset,b.byteLength),0);k({parser:this,partialOkay:c||!1,version:l,flags:n,reader:b,size:e,start:d+a,has64BitSize:h})}else b.U(Math.min(d+
e-b.ka(),b.S.byteLength-b.ka()))};T.prototype.parseNext=T.prototype.Fc;function Ef(a){for(var b=Ff(a);a.reader.Ca()&&!a.parser.g;)a.parser.Fc(a.start+b,a.reader,a.partialOkay)}T.children=Ef;function Gf(a){for(var b=Ff(a),c=a.reader.N();0<c&&!a.parser.g;--c)a.parser.Fc(a.start+b,a.reader,a.partialOkay)}T.sampleDescription=Gf;function Hf(a){return function(b){a(b.reader.mb(b.reader.S.byteLength-b.reader.ka()))}}T.allData=Hf;
function Cf(a){for(var b=0,c=0;c<a.length;c++)b=b<<8|a.charCodeAt(c);return b}function Df(a){return String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255)}T.typeToString=Df;function Ff(a){return 8+(a.has64BitSize?8:0)+(null!=a.flags?4:0)}T.headerSize=Ff;function If(a){var b=this;this.g=[];this.h=[];this.data=[];(new T).box("moov",Ef).ma("pssh",function(a){if(1<a.version)B.v("Unrecognized PSSH version found!");else{var c=a.reader.S;c=new Uint8Array(c.buffer,c.byteOffset-12,a.size);b.data.push(c);b.g.push(G.Nc(a.reader.mb(16)));if(0<a.version){c=a.reader.N();for(var e=0;e<c;++e){var f=G.Nc(a.reader.mb(16));b.h.push(f)}}}}).parse(a);0==this.data.length&&B.v("No pssh box found!")}
function Jf(a){if(!a)return a;var b=new If(a);if(1>=b.data.length)return a;a=[];var c={};b=t(b.data);for(var d=b.next();!d.done;c={yc:c.yc},d=b.next())c.yc=d.value,a.some(function(a){return function(b){return G.Ha(b,a.yc)}}(c))||a.push(c.yc);return G.concat.apply(G,a instanceof Array?a:Sa(t(a)))};var U={sc:function(a,b){var c=U.Y(a,b);return 1!=c.length?null:c[0]},Yc:function(a,b,c){a=U.fe(a,b,c);return 1!=a.length?null:a[0]},Y:function(a,b){return Array.prototype.filter.call(a.childNodes,function(a){return a instanceof Element&&a.tagName==b})},fe:function(a,b,c){return Array.prototype.filter.call(a.childNodes,function(a){return a instanceof Element&&a.localName==c&&a.namespaceURI==b})},getAttributeNS:function(a,b,c){return a.hasAttributeNS(b,c)?a.getAttributeNS(b,c):null},uc:function(a){return Array.prototype.every.call(a.childNodes,
function(a){return a.nodeType==Node.TEXT_NODE||a.nodeType==Node.CDATA_SECTION_NODE})?a.textContent.trim():null},R:function(a,b,c,d){d=void 0===d?null:d;var e=null;a=a.getAttribute(b);null!=a&&(e=c(a));return null==e?d:e},jg:function(a){if(!a)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(a)&&(a+="Z");a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)},Ma:function(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);
if(!b)return B.v("Invalid duration string:",a),null;a=31536E3*Number(b[1]||null)+2592E3*Number(b[2]||null)+86400*Number(b[3]||null)+3600*Number(b[4]||null)+60*Number(b[5]||null)+Number(b[6]||null);return isFinite(a)?a:null},Hc:function(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=Number(b[1]);if(!isFinite(a))return null;b=Number(b[2]);return isFinite(b)?{start:a,end:b}:null},parseInt:function(a){a=Number(a);return 0===a%1?a:null},Gc:function(a){a=Number(a);return 0===a%1&&0<a?a:null},
Mb:function(a){a=Number(a);return 0===a%1&&0<=a?a:null},parseFloat:function(a){a=Number(a);return isNaN(a)?null:a},ff:function(a){var b;a=(b=a.match(/^(\d+)\/(\d+)$/))?Number(b[1])/Number(b[2]):Number(a);return isNaN(a)?null:a},Ae:function(a,b){var c=new DOMParser;try{var d=c.parseFromString(a,"text/xml")}catch(f){}if(d&&d.documentElement.tagName==b)var e=d.documentElement;return e&&0<e.getElementsByTagName("parsererror").length?null:e},ze:function(a,b){try{var c=Gb(a);return U.Ae(c,b)}catch(d){}}};var Kf=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Lf(a,b,c){var d=Mf(a),e=null;a=[];var f=[],h=new Set(d.map(function(a){return a.keyId}));h["delete"](null);if(1<h.size)throw new D(2,4,4010);c||(f=d.filter(function(a){return"urn:mpeg:dash:mp4protection:2011"==a.Ge?(e=a.init||e,!1):!0}),f.length&&(a=Nf(e,b,f),0==a.length&&(a=[zb("",e)])));if(d.length&&(c||!f.length))for(a=[],b=t(Kf.values()),c=b.next();!c.done;c=b.next())c=c.value,"org.w3.clearkey"!=c&&a.push(zb(c,e));if(h=Array.from(h)[0]||null)for(b=t(a),c=b.next();!c.done;c=b.next())for(c=
t(c.value.initData),d=c.next();!d.done;d=c.next())d.value.keyId=h;return{be:h,Xg:e,drmInfos:a,ge:!0}}function Of(a,b,c,d){var e=Lf(a,b,d);if(c.ge){a=1==c.drmInfos.length&&!c.drmInfos[0].keySystem;b=0==e.drmInfos.length;if(0==c.drmInfos.length||a&&!b)c.drmInfos=e.drmInfos;c.ge=!1}else if(0<e.drmInfos.length&&(c.drmInfos=c.drmInfos.filter(function(a){return e.drmInfos.some(function(b){return b.keySystem==a.keySystem})}),0==c.drmInfos.length))throw new D(2,4,4008);return e.be||c.be}
function Pf(a){var b=0,c=(new DataView(a)).getUint32(b,!0);b+=4;if(c!==a.byteLength)return B.v("PlayReady Object with invalid length encountered."),[];b+=2;c=[];for(var d=new DataView(a);b<a.byteLength-1;){var e=d.getUint16(b,!0);b+=2;var f=d.getUint16(b,!0);b+=2;var h=new Uint8Array(a,b,f);c.push({type:e,value:h});b+=f}return c}
function Qf(a){a=t(a.getElementsByTagName("DATA"));for(var b=a.next();!b.done;b=a.next()){b=t(b.value.childNodes);for(var c=b.next();!c.done;c=b.next())if(c=c.value,c instanceof Element&&"LA_URL"==c.tagName)return c.textContent}return""}
function Nf(a,b,c){var d=[];c=t(c);for(var e=c.next();!e.done;e=c.next()){e=e.value;var f=Kf.get(e.Ge);if(f){var h;if(h=U.Yc(e.node,"urn:microsoft:playready","pro")){h=G.Ja(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=h.length,n=k.length+16+l,p=new ArrayBuffer(n),q=new Uint8Array(p);p=new DataView(p);var r=0;p.setUint32(r,n);r+=4;p.setUint32(r,1886614376);r+=4;p.setUint32(r,0);r+=4;q.set(k,r);r+=k.length;p.setUint32(r,l);r+=4;q.set(h,r);h=[{initData:q,
initDataType:"cenc",keyId:e.keyId}]}else h=null;h=zb(f,e.init||a||h);if(f=Rf.get(f))h.licenseServerUri=f(e);d.push(h)}else for(e=b(e.node)||[],e=t(e),f=e.next();!f.done;f=e.next())d.push(f.value)}return d}
var Rf=(new Map).set("com.widevine.alpha",function(a){return(a=U.Yc(a.node,"urn:microsoft","laurl"))?a.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(a){a=U.Yc(a.node,"urn:microsoft:playready","pro");if(!a)return"";a=G.Ja(a.textContent);a=Pf(a.buffer).filter(function(a){return 1===a.type})[0];if(!a)return"";a=Ib(a.value,!0);return(a=U.Ae(a,"WRMHEADER"))?Qf(a):""});function Mf(a){var b=[];a=t(a);for(var c=a.next();!c.done;c=a.next())(c=Sf(c.value))&&b.push(c);return b}
function Sf(a){var b=a.getAttribute("schemeIdUri"),c=U.getAttributeNS(a,"urn:mpeg:cenc:2013","default_KID"),d=U.fe(a,"urn:mpeg:cenc:2013","pssh").map(U.uc);if(!b)return B.error("Missing required schemeIdUri attribute on","ContentProtection element",a),null;b=b.toLowerCase();if(c&&(c=c.replace(/-/g,"").toLowerCase(),c.includes(" ")))throw new D(2,4,4009);var e=[];try{e=d.map(function(a){return{initDataType:"cenc",initData:G.Ja(a),keyId:null}})}catch(f){throw new D(2,4,4007);}return{node:a,Ge:b,keyId:c,
init:0<e.length?e:null}};function Tf(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};return a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(b,c,d,e){if("$$"==b)return"$";var h=f[c];if(null==h)return B.v("URL template does not have an available substitution for identifier",'"'+c+'":',a),b;"RepresentationID"==c&&d&&(B.v("URL template should not contain a width specifier for identifier",'"RepresentationID":',a),d=void 0);"Time"==c&&(h=Math.round(h));switch(e){case void 0:case "d":case "i":case "u":b=
h.toString();break;case "o":b=h.toString(8);break;case "x":b=h.toString(16);break;case "X":b=h.toString(16).toUpperCase();break;default:b=h.toString()}d=window.parseInt(d,10)||1;return Array(Math.max(0,d-b.length)+1).join("0")+b})}
function Uf(a,b){var c=Vf(a,b,"timescale"),d=1;c&&(d=U.Gc(c)||1);c=Vf(a,b,"duration");(c=U.Gc(c||""))&&(c/=d);var e=Vf(a,b,"startNumber"),f=Number(Vf(a,b,"presentationTimeOffset"))||0,h=U.Mb(e||"");if(null==e||null==h)h=1;var k=Wf(a,b,"SegmentTimeline");e=null;if(k){e=d;var l=a.$.duration||Infinity;k=U.Y(k,"S");for(var n=[],p=-f,q=0;q<k.length;++q){var r=k[q],x=U.R(r,"t",U.Mb),C=U.R(r,"d",U.Mb),z=U.R(r,"r",U.parseInt);null!=x&&(x-=f);if(!C){B.v('"S" element must have a duration:','ignoring the remaining "S" elements.',
r);break}x=null!=x?x:p;z=z||0;if(0>z)if(q+1<k.length){z=U.R(k[q+1],"t",U.Mb);if(null==z){B.v('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',r);break}else if(x>=z){B.v('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',r);break}z=Math.ceil((z-x)/C)-1}else{if(Infinity==l){B.v('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',r);break}else if(x/e>=l){B.v('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',r);break}z=Math.ceil((l*e-x)/C)-1}0<n.length&&x!=p&&(Math.abs((x-p)/e)>=Fb&&B.v("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",r),n[n.length-1].end=x/e);for(r=0;r<=z;++r)p=x+C,n.push({start:x/e,end:p/e,Pg:x}),x=p}e=n}return{timescale:d,
ia:c,ob:h,sa:f/d||0,Vd:f,W:e}}function Vf(a,b,c){return[b(a.G),b(a.fa),b(a.qa)].filter(xb.Ra).map(function(a){return a.getAttribute(c)}).reduce(function(a,b){return a||b})}function Wf(a,b,c){return[b(a.G),b(a.fa),b(a.qa)].filter(xb.Ra).map(function(a){return U.sc(a,c)}).reduce(function(a,b){return a||b})}
function Xf(a,b,c,d,e,f){for(var h=U.getAttributeNS(a,"http://www.w3.org/1999/xlink","href"),k=U.getAttributeNS(a,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=0;l<a.attributes.length;l++){var n=a.attributes[l];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(a.removeAttributeNS(n.namespaceURI,n.localName),--l)}if(5<=f)return Vb(new D(2,4,4028));if("onLoad"!=k)return Vb(new D(2,4,4027));var p=yb([d],[h]);return e.request(0,mc(p,b)).ca(function(d){d=U.ze(d.data,a.tagName);if(!d)return Vb(new D(2,
4,4001,h));for(;a.childNodes.length;)a.removeChild(a.childNodes[0]);for(;d.childNodes.length;){var k=d.childNodes[0];d.removeChild(k);a.appendChild(k)}for(k=0;k<d.attributes.length;k++){var l=d.attributes[k].nodeName,n=d.getAttribute(l);a.setAttribute(l,n)}return Yf(a,b,c,p[0],e,f+1)})}
function Yf(a,b,c,d,e,f){f=void 0===f?0:f;if(U.getAttributeNS(a,"http://www.w3.org/1999/xlink","href")){var h=Xf(a,b,c,d,e,f);c&&(h=h.ca(void 0,function(){return Yf(a,b,c,d,e,f)}));return h}h=[];for(var k=0;k<a.childNodes.length;k++){var l=a.childNodes[k];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==U.getAttributeNS(l,"http://www.w3.org/1999/xlink","href")?(a.removeChild(l),--k):"SegmentTimeline"!=l.tagName&&h.push(Yf(l,b,c,d,e,f)))}return Zb(h).ca(function(){return a})};function Zf(a,b,c){this.i=a;this.h=b;this.g=c}A("shaka.media.InitSegmentReference",Zf);Zf.prototype.Tc=function(){return this.i()};Zf.prototype.createUris=Zf.prototype.Tc;Zf.prototype.dd=function(){return this.h};Zf.prototype.getStartByte=Zf.prototype.dd;Zf.prototype.cd=function(){return this.g};Zf.prototype.getEndByte=Zf.prototype.cd;function V(a,b,c,d,e,f){this.position=a;this.startTime=b;this.endTime=c;this.i=d;this.h=e;this.g=f}A("shaka.media.SegmentReference",V);V.prototype.ka=function(){return this.position};
V.prototype.getPosition=V.prototype.ka;V.prototype.xc=function(){return this.startTime};V.prototype.getStartTime=V.prototype.xc;V.prototype.qf=function(){return this.endTime};V.prototype.getEndTime=V.prototype.qf;V.prototype.Tc=function(){return this.i()};V.prototype.createUris=V.prototype.Tc;V.prototype.dd=function(){return this.h};V.prototype.getStartByte=V.prototype.dd;V.prototype.cd=function(){return this.g};V.prototype.getEndByte=V.prototype.cd;function $f(a,b,c,d){var e,f=(new T).ma("sidx",function(a){e=ag(b,d,c,a)});a&&f.parse(a);if(e)return e;B.error('Invalid box type, expected "sidx".');throw new D(2,3,3004);}
function ag(a,b,c,d){var e=[];d.reader.U(4);var f=d.reader.N();if(0==f)throw B.error("Invalid timescale."),new D(2,3,3005);if(0==d.version){var h=d.reader.N();var k=d.reader.N()}else h=d.reader.Pb(),k=d.reader.Pb();d.reader.U(2);var l=d.reader.dc();a=a+d.size+k;for(k=0;k<l;k++){var n=d.reader.N(),p=(n&2147483648)>>>31;n&=2147483647;var q=d.reader.N();d.reader.U(4);if(1==p)throw B.error("Heirarchical SIDXs are not supported."),new D(2,3,3006);e.push(new V(e.length,h/f-b,(h+q)/f-b,function(){return c},
a,a+n-1));h+=q;a+=n}d.parser.stop();return e};function bg(a){this.g=a}A("shaka.media.SegmentIndex",bg);bg.prototype.destroy=function(){this.g=null;return Promise.resolve()};bg.prototype.destroy=bg.prototype.destroy;bg.prototype.find=function(a){for(var b=this.g.length-1,c=b;0<=c;--c){var d=this.g[c],e=c<b?this.g[c+1].startTime:d.endTime;if(a>=d.startTime&&a<e)return d.position}return this.g.length&&a<this.g[0].startTime?this.g[0].position:null};bg.prototype.find=bg.prototype.find;
bg.prototype.get=function(a){if(0==this.g.length)return null;a-=this.g[0].position;return 0>a||a>=this.g.length?null:this.g[a]};bg.prototype.get=bg.prototype.get;bg.prototype.offset=function(a){for(var b=0;b<this.g.length;++b)this.g[b].startTime+=a,this.g[b].endTime+=a};bg.prototype.offset=bg.prototype.offset;
bg.prototype.sd=function(a){for(var b=[],c=0,d=0;c<this.g.length&&d<a.length;){var e=this.g[c],f=a[d];e.startTime<f.startTime?(b.push(e),c++):(e.startTime>f.startTime?0==c?b.push(f):B.v("Refusing to rewrite original references on update!"):(.1<Math.abs(e.endTime-f.endTime)?b.push(new V(e.position,f.startTime,f.endTime,f.i,f.h,f.g)):b.push(e),c++),d++)}for(;c<this.g.length;)b.push(this.g[c++]);if(b.length)for(c=b[b.length-1].position+1;d<a.length;)e=a[d++],e=new V(c++,e.startTime,e.endTime,e.i,e.h,
e.g),b.push(e);else b=a;this.g=b};bg.prototype.merge=bg.prototype.sd;bg.prototype.Vc=function(a){for(var b=0;b<this.g.length;++b)if(this.g[b].endTime>a){this.g.splice(0,b);return}this.g=[]};bg.prototype.evict=bg.prototype.Vc;function cg(a,b){for(;a.g.length;)if(a.g[a.g.length-1].startTime>=b)a.g.pop();else break;for(;a.g.length;)if(0>=a.g[0].endTime)a.g.shift();else break;if(0!=a.g.length){var c=a.g[a.g.length-1];a.g[a.g.length-1]=new V(c.position,c.startTime,b,c.i,c.h,c.g)}};function dg(a){this.h=a;this.g=new S(a,0);eg||(eg=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var eg;dg.prototype.Ca=function(){return this.g.Ca()};
function fg(a){var b=gg(a);if(7<b.length)throw new D(2,3,3002);for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=gg(a);a:{d=G.Ha;for(var e=0;e<eg.length;e++)if(d(c,eg[e])){d=!0;break a}d=!1}if(d)c=a.h.byteLength-a.g.ka();else{if(8==c.length&&c[1]&224)throw new D(2,3,3001);d=c[0]&(1<<8-c.length)-1;for(e=1;e<c.length;e++)d=256*d+c[e];c=d}c=a.g.ka()+c<=a.h.byteLength?c:a.h.byteLength-a.g.ka();d=new DataView(a.h.buffer,a.h.byteOffset+a.g.ka(),c);a.g.U(c);return new hg(b,d)}
function gg(a){var b=a.g.ra(),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new D(2,3,3002);var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=a.g.ra();return d}function hg(a,b){this.id=a;this.g=b}function ig(a){if(8<a.g.byteLength)throw new D(2,3,3002);if(8==a.g.byteLength&&a.g.getUint8(0)&224)throw new D(2,3,3001);for(var b=0,c=0;c<a.g.byteLength;c++){var d=a.g.getUint8(c);b=256*b+d}return b};function jg(){}
jg.prototype.parse=function(a,b,c,d){var e;b=new dg(new DataView(b));if(440786851!=fg(b).id)throw B.error("Not an EBML element."),new D(2,3,3008);var f=fg(b);if(408125543!=f.id)throw B.error("Not a Segment element."),new D(2,3,3009);b=f.g.byteOffset;f=new dg(f.g);for(e=null;f.Ca();){var h=fg(f);if(357149030==h.id){e=h;break}}if(!e)throw B.error("Not an Info element."),new D(2,3,3010);f=new dg(e.g);e=1E6;for(h=null;f.Ca();){var k=fg(f);if(2807729==k.id)e=ig(k);else if(17545==k.id)if(h=k,4==h.g.byteLength)h=
h.g.getFloat32(0);else if(8==h.g.byteLength)h=h.g.getFloat64(0);else throw new D(2,3,3003);}if(null==h)throw new D(2,3,3011);f=e/1E9;e=h*f;a=fg(new dg(new DataView(a)));if(475249515!=a.id)throw B.error("Not a Cues element."),new D(2,3,3007);return kg(a,b,f,e,c,d)};
function kg(a,b,c,d,e,f){function h(){return e}var k=[];a=new dg(a.g);for(var l=null,n=null;a.Ca();){var p=fg(a);if(187==p.id){var q=lg(p);q&&(p=c*q.Qg,q=b+q.qg,null!=l&&k.push(new V(k.length,l-f,p-f,h,n,q-1)),l=p,n=q)}}null!=l&&k.push(new V(k.length,l-f,d-f,h,n,null));return k}
function lg(a){var b=new dg(a.g);a=fg(b);if(179!=a.id)throw B.v("Not a CueTime element."),new D(2,3,3013);a=ig(a);b=fg(b);if(183!=b.id)throw B.v("Not a CueTrackPositions element."),new D(2,3,3012);b=new dg(b.g);for(var c=0;b.Ca();){var d=fg(b);if(241==d.id){c=ig(d);break}}return{Qg:a,qg:c}};function mg(a,b){var c=Wf(a,b,"Initialization");if(!c)return null;var d=a.G.xa,e=c.getAttribute("sourceURL");e&&(d=yb(a.G.xa,[e]));e=0;var f=null;if(c=U.R(c,"range",U.Hc))e=c.start,f=c.end;return new Zf(function(){return d},e,f)}
function ng(a,b){var c=Number(Vf(a,og,"presentationTimeOffset"))||0,d=Vf(a,og,"timescale"),e=1;d&&(e=U.Gc(d)||1);c=c/e||0;d=mg(a,og);var f=a.G.contentType;e=a.G.mimeType.split("/")[1];if("text"!=f&&"mp4"!=e&&"webm"!=e)throw B.error("SegmentBase specifies an unsupported container type.",a.G),new D(2,4,4006);if("webm"==e&&!d)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",a.G),new D(2,
4,4005);f=Wf(a,og,"RepresentationIndex");var h=Vf(a,og,"indexRange"),k=a.G.xa;h=U.Hc(h||"");if(f){var l=f.getAttribute("sourceURL");l&&(k=yb(a.G.xa,[l]));h=U.R(f,"range",U.Hc,h)}if(!h)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",a.G),new D(2,4,4002);e=pg(a,b,d,k,h.start,h.end,e,c);return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,
initSegmentReference:d,sa:c}}function pg(a,b,c,d,e,f,h,k){var l=a.presentationTimeline,n=!a.zb||!a.$.ld,p=a.$.start,q=a.$.duration,r=b,x=null;return{createSegmentIndex:function(){var a=[r(d,e,f),"webm"==h?r(c.i(),c.h,c.g):null];r=null;return Promise.all(a).then(function(a){var b=a[0];a=a[1]||null;b="mp4"==h?$f(b,e,d,k):(new jg).parse(b,a,d,k);l.Jb(b,p);x=new bg(b);n&&cg(x,q)})},findSegmentPosition:function(a){return x.find(a)},getSegmentReference:function(a){return x.get(a)}}}
function og(a){return a.ec};function qg(a,b){var c=mg(a,rg);var d=sg(a);var e=Uf(a,rg),f=e.ob;0==f&&(B.v("SegmentList@startNumber must be > 0"),f=1);var h=0;e.ia?h=e.ia*(f-1):e.W&&0<e.W.length&&(h=e.W[0].start);d={ia:e.ia,startTime:h,ob:f,sa:e.sa,W:e.W,jb:d};if(!d.ia&&!d.W&&1<d.jb.length)throw B.v("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",a.G),new D(2,4,4002);if(!d.ia&&!a.$.duration&&!d.W&&1==d.jb.length)throw B.v("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",a.G),new D(2,4,4002);if(d.W&&0==d.W.length)throw B.v("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",a.G),new D(2,4,4002);f=e=null;a.qa.id&&a.G.id&&(f=a.qa.id+","+a.G.id,e=b[f]);h=tg(a.$.duration,d.ob,a.G.xa,d);e?(e.sd(h),f=a.presentationTimeline.$b(),e.Vc(f-a.$.start)):(a.presentationTimeline.Jb(h,a.$.start),e=new bg(h),f&&a.zb&&
(b[f]=e));a.zb&&a.$.ld||cg(e,a.$.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:e.find.bind(e),getSegmentReference:e.get.bind(e),initSegmentReference:c,sa:d.sa}}function rg(a){return a.Ua}
function tg(a,b,c,d){var e=d.jb.length;d.W&&d.W.length!=d.jb.length&&(e=Math.min(d.W.length,d.jb.length),B.v("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",d.jb.length,"to",e));for(var f=[],h=d.startTime,k=0;k<e;k++){var l=d.jb[k],n=yb(c,[l.Tf]),p=void 0;p=null!=d.ia?h+d.ia:d.W?d.W[k].end:h+a;f.push(new V(k+b,h,p,function(a){return a}.bind(null,n),l.start,l.end));h=p}return f}
function sg(a){return[a.G.Ua,a.fa.Ua,a.qa.Ua].filter(xb.Ra).map(function(a){return U.Y(a,"SegmentURL")}).reduce(function(a,c){return 0<a.length?a:c}).map(function(b){b.getAttribute("indexRange")&&!a.me&&(a.me=!0,B.v("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var c=b.getAttribute("media");b=U.R(b,"mediaRange",U.Hc,{start:0,end:null});return{Tf:c,start:b.start,end:b.end}})};function ug(a,b,c,d){var e=vg(a);var f=Uf(a,wg);var h=Vf(a,wg,"media"),k=Vf(a,wg,"index");f={ia:f.ia,timescale:f.timescale,ob:f.ob,sa:f.sa,Vd:f.Vd,W:f.W,qd:h,bc:k};h=f.bc?1:0;h+=f.W?1:0;h+=f.ia?1:0;if(0==h)throw B.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",a.G),new D(2,4,4002);1!=h&&(B.v("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",a.G),f.bc?(B.info("Using the index URL template by default."),f.W=null):B.info("Using the SegmentTimeline by default."),f.ia=null);if(!f.bc&&!f.qd)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",a.G),new D(2,4,4002);if(f.bc){c=a.G.mimeType.split("/")[1];if("mp4"!=c&&"webm"!=c)throw B.error("SegmentTemplate specifies an unsupported container type.",a.G),new D(2,4,4006);
if("webm"==c&&!e)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",a.G),new D(2,4,4005);d=Tf(f.bc,a.G.id,null,a.bandwidth||null,null);d=yb(a.G.xa,[d]);a=pg(a,b,e,d,0,null,c,f.sa)}else f.ia?(d||(a.presentationTimeline.ud(f.ia),a.presentationTimeline.vd(a.$.start)),a=xg(a,f)):(h=b=null,a.qa.id&&a.G.id&&(h=a.qa.id+","+a.G.id,b=c[h]),k=yg(a,f),d=!a.zb||!a.$.ld,b?(d&&cg(new bg(k),
a.$.duration),b.sd(k),c=a.presentationTimeline.$b(),b.Vc(c-a.$.start)):(a.presentationTimeline.Jb(k,a.$.start),b=new bg(k),h&&a.zb&&(c[h]=b)),d&&cg(b,a.$.duration),a={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:b.find.bind(b),getSegmentReference:b.get.bind(b)});return{createSegmentIndex:a.createSegmentIndex,findSegmentPosition:a.findSegmentPosition,getSegmentReference:a.getSegmentReference,initSegmentReference:e,sa:f.sa}}function wg(a){return a.gc}
function xg(a,b){var c=a.$.duration,d=b.ia,e=b.ob,f=b.timescale,h=b.qd,k=a.bandwidth||null,l=a.G.id,n=a.G.xa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(a){return 0>a||c&&a>=c?null:Math.floor(a/d)},getSegmentReference:function(a){var b=a*d,p=b+d;c&&(p=Math.min(p,c));return 0>p||c&&b>=c?null:new V(a,b,p,function(){var c=Tf(h,l,a+e,k,b*f);return yb(n,[c])},0,null)}}}
function yg(a,b){for(var c=[],d=0;d<b.W.length;d++){var e=d+b.ob;c.push(new V(e,b.W[d].start,b.W[d].end,function(a,b,c,d,e,p){a=Tf(a,b,e,c,p);return yb(d,[a]).map(function(a){return a.toString()})}.bind(null,b.qd,a.G.id,a.bandwidth||null,a.G.xa,e,b.W[d].Pg+b.Vd),0,null))}return c}function vg(a){var b=Vf(a,wg,"initialization");if(!b)return null;var c=a.G.id,d=a.bandwidth||null,e=a.G.xa;return new Zf(function(){var a=Tf(b,c,null,d,null);return yb(e,[a])},0,null)};var W={Nb:{},cc:{},Fd:function(a,b){W.cc[a]=b}};A("shaka.media.ManifestParser.registerParserByExtension",W.Fd);W.Qb=function(a,b){W.Nb[a]=b};A("shaka.media.ManifestParser.registerParserByMime",W.Qb);
W.ng=function(){var a={};if(Ic()){for(var b in W.Nb)a[b]=!0;for(var c in W.cc)a[c]=!0}b={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};c=t(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var d=c.next();!d.done;d=c.next())d=d.value,a[d]=Ic()?!!W.Nb[d]:Jc(d);for(var e in b)a[e]=Ic()?!!W.cc[e]:Jc(b[e]);return a};
W.create=function(a,b,c,d){return u(function f(){var h,k;return y(f,function(f){switch(f.s){case 1:return Ba(f,2),v(f,W.rf(a,b,c,d),4);case 4:return h=f.B,f["return"](new h);case 2:throw k=Ga(f),k.severity=2,k;}})})};
W.rf=function(a,b,c,d){return u(function f(){var h,k,l,n,p;return y(f,function(f){switch(f.s){case 1:h=W;if(d){if(k=h.Nb[d.toLowerCase()])return f["return"](k);B.v("Could not determine manifest type using MIME type ",d)}if(l=h.getExtension(a)){if(n=h.cc[l])return f["return"](n);B.v("Could not determine manifest type for extension ",l)}else B.v("Could not find extension for ",a);if(d){f.I(2);break}return v(f,h.zf(a,b,c),3);case 3:if(d=f.B){if(p=W.Nb[d])return f["return"](p);B.v("Could not determine manifest type using MIME type",
d)}case 2:throw new D(2,4,4E3,a);}})})};W.zf=function(a,b,c){return u(function e(){var f,h,k;return y(e,function(e){switch(e.s){case 1:return f=mc([a],c),f.method="HEAD",v(e,b.request(0,f).promise,2);case 2:return h=e.B,k=h.headers["content-type"],e["return"](k?k.toLowerCase().split(";").shift():"")}})})};W.getExtension=function(a){a=(new hb(a)).pa.split("/").pop().split(".");return 1==a.length?"":a.pop().toLowerCase()};
W.isSupported=function(a,b){return Ic()?b in W.Nb||W.getExtension(a)in W.cc?!0:!1:!1};function X(a,b,c){this.j=a;this.Ic=b;this.m=this.l=Infinity;this.g=1;this.h=this.i=null;this.u=0;this.A=!0;this.o=0;this.C=void 0===c?!0:c}A("shaka.media.PresentationTimeline",X);X.prototype.ha=function(){return this.l};X.prototype.getDuration=X.prototype.ha;X.prototype.xf=function(){return this.g};X.prototype.getMaxSegmentDuration=X.prototype.xf;X.prototype.Fa=function(a){this.l=a};X.prototype.setDuration=X.prototype.Fa;X.prototype.Ff=function(){return this.j};
X.prototype.getPresentationStartTime=X.prototype.Ff;X.prototype.Ke=function(a){this.u=a};X.prototype.setClockOffset=X.prototype.Ke;X.prototype.hc=function(a){this.A=a};X.prototype.setStatic=X.prototype.hc;X.prototype.Pd=function(a){this.m=a};X.prototype.setSegmentAvailabilityDuration=X.prototype.Pd;X.prototype.Ag=function(a){this.Ic=a};X.prototype.setDelay=X.prototype.Ag;X.prototype.pf=function(){return this.Ic};X.prototype.getDelay=X.prototype.pf;
X.prototype.Jb=function(a,b){if(0!=a.length){var c=a[a.length-1].endTime+b;this.vd(a[0].startTime+b);this.g=a.reduce(function(a,b){return Math.max(a,b.endTime-b.startTime)},this.g);this.h=Math.max(this.h,c);null!=this.j&&this.C&&(this.j=(Date.now()+this.u)/1E3-this.h-this.g);B.K("notifySegments:","maxSegmentDuration="+this.g)}};X.prototype.notifySegments=X.prototype.Jb;X.prototype.vd=function(a){this.i=null==this.i?a:Math.min(this.i,a)};X.prototype.notifyMinSegmentStartTime=X.prototype.vd;
X.prototype.ud=function(a){this.g=Math.max(this.g,a);B.K("notifyNewSegmentDuration:","maxSegmentDuration="+this.g)};X.prototype.notifyMaxSegmentDuration=X.prototype.ud;X.prototype.offset=function(a){null!=this.i&&(this.i+=a);null!=this.h&&(this.h+=a)};X.prototype.offset=X.prototype.offset;X.prototype.aa=function(){return Infinity==this.l&&!this.A};X.prototype.isLive=X.prototype.aa;X.prototype.ib=function(){return Infinity!=this.l&&!this.A};X.prototype.isInProgress=X.prototype.ib;
X.prototype.$b=function(){if(Infinity==this.m)return this.o;var a=this.Db()-this.m;return Math.max(this.o,a)};X.prototype.getSegmentAvailabilityStart=X.prototype.$b;X.prototype.Le=function(a){this.o=a};X.prototype.setUserSeekStart=X.prototype.Le;X.prototype.Db=function(){return this.aa()||this.ib()?Math.min(Math.max(0,(Date.now()+this.u)/1E3-this.g-this.j),this.l):this.l};X.prototype.getSegmentAvailabilityEnd=X.prototype.Db;
X.prototype.Zb=function(a){var b=Math.max(this.i,this.o);if(Infinity==this.m)return Math.ceil(1E3*b)/1E3;var c=this.Db()-this.m;a=Math.min(c+a,this.Ka());return Math.max(b,a)};X.prototype.getSafeSeekRangeStart=X.prototype.Zb;X.prototype.Cb=function(){return this.Zb(0)};X.prototype.getSeekRangeStart=X.prototype.Cb;X.prototype.Ka=function(){var a=this.aa()||this.ib()?this.Ic:0;return Math.max(0,this.Db()-a)};X.prototype.getSeekRangeEnd=X.prototype.Ka;
X.prototype.Pe=function(){return null==this.j||null!=this.h&&this.C?!1:!0};X.prototype.usingPresentationStartTime=X.prototype.Pe;function zg(a,b,c,d){a=mc(a,d);if(0!=b||null!=c)a.headers.Range=c?"bytes="+b+"-"+c:"bytes="+b+"-";return a};function Ag(){var a=this;this.h=this.g=null;this.j=[];this.i=null;this.u=[];this.m=1;this.A={};this.C=0;this.F=new cb(5);this.o=new H(function(){Bg(a)});this.l=new ic}A("shaka.dash.DashParser",Ag);m=Ag.prototype;m.configure=function(a){this.g=a};m.start=function(a,b){var c=this;return u(function e(){var f;return y(e,function(e){switch(e.s){case 1:return c.j=[a],c.h=b,v(e,Cg(c),2);case 2:f=e.B;c.h&&Dg(c,f);if(!c.h)throw new D(2,7,7001);return e["return"](c.i)}})})};
m.stop=function(){this.g=this.h=null;this.j=[];this.i=null;this.u=[];this.A={};null!=this.o&&(this.o.stop(),this.o=null);return this.l.destroy()};m.update=function(){Cg(this)["catch"](function(a){if(this.h)this.h.onError(a)}.bind(this))};m.onExpirationUpdated=function(){};
function Cg(a){var b=Date.now(),c=a.h.networkingEngine.request(0,mc(a.j,a.g.retryParameters));jc(a.l,c);return c.promise.then(function(b){if(a.h)return b.uri&&!a.j.includes(b.uri)&&a.j.unshift(b.uri),Eg(a,b.data,b.uri)}).then(function(){var c=(Date.now()-b)/1E3;db(a.F,1,c);return c})}function Eg(a,b,c){b=U.ze(b,"MPD");if(!b)throw new D(2,4,4001,c);b=Yf(b,a.g.retryParameters,a.g.dash.xlinkFailGracefully,c,a.h.networkingEngine);jc(a.l,b);return b.promise.then(function(b){return Fg(a,b,c)})}
function Fg(a,b,c){return u(function e(){var f,h,k,l,n,p,q,r,x,C,z,F,I,R,sa,ba,Ya,Ia,ma,Za,ea,ta,Ja,Pa,wa,$a,lb;return y(e,function(e){switch(e.s){case 1:l=xb;n=U;p=[c];q=n.Y(b,"Location").map(n.uc).filter(l.Ra);0<q.length&&(r=yb(p,q),p=a.j=r);x=n.Y(b,"BaseURL").map(n.uc);C=yb(p,x);z=a.g.dash.ignoreMinBufferTime;F=0;z||(F=n.R(b,"minBufferTime",n.Ma));a.C=n.R(b,"minimumUpdatePeriod",n.Ma,-1);I=n.R(b,"availabilityStartTime",n.jg);R=n.R(b,"timeShiftBufferDepth",n.Ma);sa=n.R(b,"maxSegmentDuration",n.Ma);
ba=b.getAttribute("type")||"static";Ya=a.g.dash.ignoreSuggestedPresentationDelay;Ia=null;Ya||(Ia=n.R(b,"suggestedPresentationDelay",n.Ma));a.i?ma=a.i.presentationTimeline:(Za=Math.max(a.g.dash.defaultPresentationDelay,1.5*F),ea=null!=Ia?Ia:Za,ma=new X(I,ea,a.g.dash.autoCorrectDrift));ta={zb:"static"!=ba,presentationTimeline:ma,qa:null,$:null,fa:null,G:null,bandwidth:0,me:!1};for(var Bb=ta,Cb=C,Db=U.R(b,"mediaPresentationDuration",U.Ma),mb=[],Da=0,nb=U.Y(b,"Period"),Ea=0;Ea<nb.length;Ea++){var Eb=
nb[Ea];Da=U.R(Eb,"start",U.Ma,Da);var Ka=U.R(Eb,"duration",U.Ma),ja=null;if(Ea!=nb.length-1){var Md=U.R(nb[Ea+1],"start",U.Ma);null!=Md&&(ja=Md-Da)}else null!=Db&&(ja=Db-Da);Md=Fb;ja&&Ka&&Math.abs(ja-Ka)>Md&&B.v("There is a gap/overlap between Periods",Eb);null==ja&&(ja=Ka);Eb=Gg(a,Bb,Cb,{start:Da,duration:ja,node:Eb,ld:null==ja||Ea==nb.length-1});mb.push(Eb);Ka=Bb.qa.id;a.u.includes(Ka)||(a.u.push(Ka),a.i&&(a.h.filterNewPeriod(Eb),a.i.periods.push(Eb)));if(null==ja){Ea!=nb.length-1&&B.v("Skipping Period",
Ea+1,"and any subsequent Periods:","Period",Ea+1,"does not have a valid start time.",mb[Ea+1]);Da=null;break}Da+=ja}null==a.i&&a.h.filterAllPeriods(mb);null!=Db?(Da!=Db&&B.v("@mediaPresentationDuration does not match the total duration of all","Periods."),f=mb,h=Db,k=!1):(f=mb,h=Da,k=!0);Ja=h;Pa=f;ma.hc("static"==ba);"static"!=ba&&k||ma.Fa(Ja||Infinity);(wa=ma.aa())&&!isNaN(a.g.availabilityWindowOverride)&&(R=a.g.availabilityWindowOverride);null==R&&(R=Infinity);ma.Pd(R);ma.ud(sa||1);if(a.i){e.I(0);
break}a.i={presentationTimeline:ma,periods:Pa,offlineSessionIds:[],minBufferTime:F||0};if(!ma.Pe()){e.I(0);break}$a=n.Y(b,"UTCTiming");return v(e,Hg(a,C,$a),4);case 4:lb=e.B;if(!a.h)return e["return"]();ma.Ke(lb);w(e)}})})}
function Gg(a,b,c,d){b.qa=Ig(d.node,null,c);b.$=d;b.qa.id||(B.info("No Period ID given for Period with start time "+d.start+",  Assigning a default"),b.qa.id="__shaka_period_"+d.start);U.Y(d.node,"EventStream").forEach(a.kg.bind(a,d.start,d.duration));c=U.Y(d.node,"AdaptationSet").map(a.ig.bind(a,b)).filter(xb.Ra);if(b.zb){b=[];for(var e=t(c),f=e.next();!f.done;f=e.next()){f=t(f.value.tg);for(var h=f.next();!h.done;h=f.next())b.push(h.value)}if(b.length!=(new Set(b)).size)throw new D(2,4,4018);}var k=
c.filter(function(a){return!a.Td});c.filter(function(a){return a.Td}).forEach(function(a){var b=a.Td.split(" ");k.forEach(function(c){b.includes(c.id)&&c.streams.forEach(function(b){b.trickModeVideo=a.streams.find(function(a){return Hc(b.codecs)[0]==Hc(a.codecs)[0]})})})});b=Jg(k,"video");e=Jg(k,"audio");if(!b.length&&!e.length)throw new D(2,4,4004);c=a.g.disableAudio;if(!e.length||c)e=[null];c=a.g.disableVideo;if(!b.length||c)b=[null];c=[];for(f=0;f<e.length;f++)for(h=0;h<b.length;h++)Kg(a,e[f],
b[h],c);b=[];if(!a.g.disableText)for(a=Jg(k,"text"),e=0;e<a.length;e++)b.push.apply(b,a[e].streams);return{startTime:d.start,textStreams:b,variants:c}}function Jg(a,b){return a.filter(function(a){return a.contentType==b})}
function Kg(a,b,c,d){if(b||c)if(b&&c){var e=b.drmInfos;var f=c.drmInfos;if(e.length&&f.length?0<zd(e,f).length:1){f=zd(b.drmInfos,c.drmInfos);for(var h=0;h<b.streams.length;h++)for(var k=0;k<c.streams.length;k++)e=(c.streams[k].bandwidth||0)+(b.streams[h].bandwidth||0),e={id:a.m++,language:b.language,primary:b.pd||c.pd,audio:b.streams[h],video:c.streams[k],bandwidth:e,drmInfos:f,allowedByApplication:!0,allowedByKeySystem:!0},d.push(e)}}else for(f=b||c,h=0;h<f.streams.length;h++)e=f.streams[h].bandwidth||
0,e={id:a.m++,language:f.language||"und",primary:f.pd,audio:b?f.streams[h]:null,video:c?f.streams[h]:null,bandwidth:e,drmInfos:f.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},d.push(e)}
m.ig=function(a,b){a.fa=Ig(b,a.qa,null);if("image"==a.fa.contentType)return B.v("Skipping Image AdaptationSet",a.fa),null;var c=!1,d=U.Y(b,"Role"),e=d.map(function(a){return a.getAttribute("value")}).filter(xb.Ra),f=void 0,h="text"==a.fa.contentType;h&&(f="subtitle");for(var k=0;k<d.length;k++){var l=d[k].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=d[k].getAttribute("value"),l){case "main":c=!0;break;case "caption":case "subtitle":f=l}}var n=null,p=!1;U.Y(b,"EssentialProperty").forEach(function(a){"http://dashif.org/guidelines/trickmode"==
a.getAttribute("schemeIdUri")?n=a.getAttribute("value"):p=!0});k=U.Y(b,"Accessibility");var q=new Map;d={};k=t(k);for(l=k.next();!l.done;d={Vb:d.Vb},l=k.next()){var r=l.value;l=r.getAttribute("schemeIdUri");r=r.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==l||"urn:scte:dash:cc:cea-708:2015"==l?(d.Vb=1,null!=r?r.split(";").forEach(function(a){return function(b){if(b.includes("=")){b=b.split("=");var c=b[0].startsWith("CC")?b[0]:"CC"+b[0];b=b[1].split(",")[0].split(":").pop()}else c="CC"+a.Vb,
a.Vb+=2;q.set(c,N(b))}}(d)):q.set("CC1","und")):"urn:mpeg:dash:role:2011"==l&&null!=r&&(e.push(r),"captions"==r&&(f="caption"))}if(p)return null;d=U.Y(b,"ContentProtection");var x=Lf(d,this.g.dash.customScheme,this.g.dash.ignoreDrmInfo);d=N(b.getAttribute("lang")||"und");k=b.getAttribute("label");(l=U.Y(b,"Label"))&&l.length&&(l=l[0],l.textContent&&(k=l.textContent));l=U.Y(b,"Representation");e=l.map(this.lg.bind(this,a,x,f,d,k,c,e,q)).filter(function(a){return!!a});if(0==e.length){if(this.g.dash.ignoreEmptyAdaptationSet||
h)return null;throw new D(2,4,4003);}a.fa.contentType&&"application"!=a.fa.contentType||(a.fa.contentType=Lg(e[0].mimeType,e[0].codecs),e.forEach(function(b){b.type=a.fa.contentType}));e.forEach(function(a){x.drmInfos.forEach(function(b){a.keyId&&b.keyIds.push(a.keyId)})});h=l.map(function(a){return a.getAttribute("id")}).filter(xb.Ra);return{id:a.fa.id||"__fake__"+this.m++,contentType:a.fa.contentType,language:d,pd:c,streams:e,drmInfos:x.drmInfos,Td:n,tg:h}};
m.lg=function(a,b,c,d,e,f,h,k,l){a.G=Ig(l,a.fa,null);if(!Mg(a.G))return B.v("Skipping Representation",a.G),null;a.bandwidth=U.R(l,"bandwidth",U.Gc)||0;var n=a.G.contentType;n="text"==n||"application"==n;try{var p=this.ug.bind(this);if(a.G.ec)var q=ng(a,p);else if(a.G.Ua)q=qg(a,this.A);else if(a.G.gc)q=ug(a,p,this.A,!!this.i);else{var r=a.G.xa,x=a.$.duration||0;q={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(a){return 0<=a&&a<x?1:null},getSegmentReference:function(a){return 1!=
a?null:new V(1,0,x,function(){return r},0,null)},initSegmentReference:null,sa:0}}}catch(C){if(n&&4002==C.code)return null;throw C;}l=U.Y(l,"ContentProtection");l=Of(l,this.g.dash.customScheme,b,this.g.dash.ignoreDrmInfo);return{id:this.m++,originalId:a.G.id,createSegmentIndex:q.createSegmentIndex,findSegmentPosition:q.findSegmentPosition,getSegmentReference:q.getSegmentReference,initSegmentReference:q.initSegmentReference,presentationTimeOffset:q.sa,mimeType:a.G.mimeType,codecs:a.G.codecs,frameRate:a.G.frameRate,
pixelAspectRatio:a.G.pixelAspectRatio,bandwidth:a.bandwidth,width:a.G.width,height:a.G.height,kind:c,encrypted:0<b.drmInfos.length,keyId:l,language:d,label:e,type:a.fa.contentType,primary:f,trickModeVideo:null,emsgSchemeIdUris:a.G.emsgSchemeIdUris,roles:h,channelsCount:a.G.wd,audioSamplingRate:a.G.audioSamplingRate,closedCaptions:k}};
function Bg(a){u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:return B.info("Updating manifest..."),d=0,Ba(c,2),v(c,Cg(a),4);case 4:d=c.B;Fa(c,3);break;case 2:e=Ga(c),a.h&&(e.severity=1,a.h.onError(e));case 3:if(!a.h)return c["return"]();Dg(a,d);w(c)}})})}function Dg(a,b){0>a.C||a.o.V(Math.max(3,a.C-b,eb(a.F)))}
function Ig(a,b,c){b=b||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,wd:null,audioSamplingRate:null};c=c||b.xa;var d=U.Mb,e=U.ff,f=U.Y(a,"BaseURL").map(U.uc),h=a.getAttribute("contentType")||b.contentType,k=a.getAttribute("mimeType")||b.mimeType,l=a.getAttribute("codecs")||b.codecs;e=U.R(a,"frameRate",e)||b.frameRate;var n=a.getAttribute("sar")||b.pixelAspectRatio,p=U.Y(a,"InbandEventStream"),q=b.emsgSchemeIdUris.slice();p=t(p);for(var r=p.next();!r.done;r=p.next())r=
r.value.getAttribute("schemeIdUri"),q.includes(r)||q.push(r);p=U.Y(a,"AudioChannelConfiguration");p=Ng(p)||b.wd;r=U.R(a,"audioSamplingRate",d)||b.audioSamplingRate;h||(h=Lg(k,l));return{xa:yb(c,f),ec:U.sc(a,"SegmentBase")||b.ec,Ua:U.sc(a,"SegmentList")||b.Ua,gc:U.sc(a,"SegmentTemplate")||b.gc,width:U.R(a,"width",d)||b.width,height:U.R(a,"height",d)||b.height,contentType:h,mimeType:k,codecs:l,frameRate:e,pixelAspectRatio:n,emsgSchemeIdUris:q,id:a.getAttribute("id"),wd:p,audioSamplingRate:r}}
function Ng(a){for(var b=0;b<a.length;++b){var c=a[b],d=c.getAttribute("schemeIdUri");if(d&&(c=c.getAttribute("value")))switch(d){case "urn:mpeg:dash:outputChannelPositionList:2012":return c.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var e=parseInt(c,10);if(!e){B.v("Channel parsing failure! Ignoring scheme and value",d,c);continue}return e;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":e=
parseInt(c,16);if(!e){B.v("Channel parsing failure! Ignoring scheme and value",d,c);continue}for(a=0;e;)e&1&&++a,e>>=1;return a;default:B.v("Unrecognized audio channel scheme:",d,c)}}return null}
function Mg(a){var b=a.ec?1:0;b+=a.Ua?1:0;b+=a.gc?1:0;if(0==b){if("text"==a.contentType||"application"==a.contentType)return!0;B.v("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',a);return!1}1!=b&&(B.v("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
a),a.ec?(B.info("Using SegmentBase by default."),a.Ua=null):B.info("Using SegmentList by default."),a.gc=null);return!0}
function Og(a,b,c,d){b=yb(b,[c]);b=mc(b,a.g.retryParameters);b.method=d;b=a.h.networkingEngine.request(4,b);jc(a.l,b);return b.promise.then(function(a){if("HEAD"==d){if(!a.headers||!a.headers.date)return B.v("UTC timing response is missing","expected date header"),0;a=a.headers.date}else a=Gb(a.data);a=Date.parse(a);return isNaN(a)?(B.v("Unable to parse date from UTC timing response"),0):a-Date.now()})}
function Hg(a,b,c){c=c.map(function(a){return{scheme:a.getAttribute("schemeIdUri"),value:a.getAttribute("value")}});var d=a.g.dash.clockSyncUri;!c.length&&d&&c.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:d});return xb.df(c,function(a){var c=a.scheme;a=a.value;switch(c){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Og(this,b,a,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Og(this,
b,a,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return c=Date.parse(a),isNaN(c)?0:c-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return B.ba("NTP UTCTiming scheme is not supported"),Promise.reject();default:return B.ba("Unrecognized scheme in UTCTiming element",c),Promise.reject()}}.bind(a))["catch"](function(){B.ba("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}m.kg=function(a,b,c){var d=U.Mb,e=c.getAttribute("schemeIdUri")||"",f=c.getAttribute("value")||"",h=U.R(c,"timescale",d)||1;U.Y(c,"Event").forEach(function(c){var k=U.R(c,"presentationTime",d)||0,n=U.R(c,"duration",d)||0;k=k/h+a;n=k+n/h;null!=b&&(k=Math.min(k,a+b),n=Math.min(n,a+b));c={schemeIdUri:e,value:f,startTime:k,endTime:n,id:c.getAttribute("id")||"",eventElement:c};this.h.onTimelineRegionAdded(c)}.bind(this))};
m.ug=function(a,b,c){a=zg(a,b,c,this.g.retryParameters);a=this.h.networkingEngine.request(1,a);jc(this.l,a);return a.promise.then(function(a){return a.data})};function Lg(a,b){return be(Dc(a,b))?"text":a.split("/")[0]}W.Fd("mpd",Ag);W.Qb("application/dash+xml",Ag);W.Qb("video/vnd.mpeg.dash.mpd",Ag);function Pg(a,b,c,d){this.h=a;this.type=b;this.g=c;this.segments=d||null}function Qg(a,b,c,d){this.id=a;this.name=b;this.g=c;this.value=void 0===d?null:d}Qg.prototype.toString=function(){function a(a){return a.name+"="+(isNaN(Number(a.value))?'"'+a.value+'"':a.value)}var b="#"+this.name,c=this.g?this.g.map(a):[];this.value&&c.unshift(this.value);0<c.length&&(b+=":"+c.join(","));return b};function Rg(a,b){this.name=a;this.value=b}
Qg.prototype.getAttribute=function(a){var b=this.g.filter(function(b){return b.name==a});return b.length?b[0]:null};function Sg(a,b,c){return(a=a.getAttribute(b))?a.value:c||null}function Tg(a,b){this.h=b;this.g=a};var Ug={Ab:function(a,b){return a.filter(function(a){return a.name==b})},cb:function(a,b){var c=Ug.Ab(a,b);return c.length?c[0]:null},Zc:function(a,b,c){return a.filter(function(a){var d=a.getAttribute("TYPE");a=a.getAttribute("GROUP-ID");return d.value==b&&a.value==c})},Sc:function(a,b){return yb([a],[b])[0]},kd:function(a){return/^#(?!EXT)/m.test(a)}};function Vg(a){this.h=a;this.g=0}function Wg(a){Xg(a,/[ \t]+/gm)}function Xg(a,b){b.lastIndex=a.g;var c=b.exec(a.h);c=null==c?null:{position:c.index,length:c[0].length,wg:c};if(a.g==a.h.length||null==c||c.position!=a.g)return null;a.g+=c.length;return c.wg}function Yg(a){return a.g==a.h.length?null:(a=Xg(a,/[^ \t\n]*/gm))?a[0]:null};function Zg(){this.g=0}
function $g(a,b,c){b=Gb(b);b=b.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var d=b.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(d[0]))throw new D(2,4,4015);b=0;for(var e=1;e<d.length;e++)if(!Ug.kd(d[e])){var f=ah(a,d[e]);--a.g;if(bh.includes(f.name)){b=1;break}else"EXT-X-STREAM-INF"==f.name&&(e+=1)}e=[];for(f=1;f<d.length;)if(Ug.kd(d[f]))f+=1;else{var h=ah(a,d[f]);if(ch.includes(h.name)){if(1!=b)throw new D(2,4,4017);d=d.splice(f,d.length-f);a=dh(a,c,d,e);return new Pg(c,b,e,a)}e.push(h);f+=1;"EXT-X-STREAM-INF"==
h.name&&(h.g.push(new Rg("URI",d[f])),f+=1)}return new Pg(c,b,e)}function dh(a,b,c,d){var e=[],f=[];c.forEach(function(c){if(/^(#EXT)/.test(c))c=ah(a,c),bh.includes(c.name)?d.push(c):f.push(c);else{if(Ug.kd(c))return[];c=Ug.Sc(b,c.trim());e.push(new Tg(c,f));f=[]}});return e}
function ah(a,b){var c=a.g++,d=b.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!d)throw new D(2,4,4016,b);var e=d[1],f=d[2];d=[];var h;if(f){f=new Vg(f);var k;(k=Xg(f,/^([^,=]+)(?:,|$)/g))&&(h=k[1]);for(var l=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;k=Xg(f,l);)d.push(new Rg(k[1],k[2]||k[3]))}return new Qg(c,e,d,h)}var bh="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),ch="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function eh(a){try{var b=eh.parse(a);return Xb({uri:a,Bd:a,data:b.data,headers:{"content-type":b.contentType}})}catch(c){return Vb(c)}}A("shaka.net.DataUriPlugin",eh);
eh.parse=function(a){var b=a.split(":");if(2>b.length||"data"!=b[0])throw B.error("Bad data URI, failed to parse scheme"),new D(2,1,1004,a);b=b.slice(1).join(":").split(",");if(2>b.length)throw B.error("Bad data URI, failed to extract encoding and MIME type"),new D(2,1,1004,a);var c=b[0];a=window.decodeURIComponent(b.slice(1).join(","));b=c.split(";");c=b[0];var d=!1;1<b.length&&"base64"==b[b.length-1]&&(d=!0,b.pop());return{data:d?G.Ja(a).buffer:Kb(a),contentType:c}};lc("data",eh);function fh(){var a=this;this.g=this.j=null;this.ea=1;this.L=new Map;this.Z=new Set;this.h=new Map;this.i=null;this.F="";this.C=new Zg;this.X=0;this.m=new H(function(){gh(a)});this.l=hh;this.A=null;this.J=0;this.M=Infinity;this.o=new ic;this.P=[];this.u=new Map;this.da=!1}A("shaka.hls.HlsParser",fh);m=fh.prototype;m.configure=function(a){this.g=a};
m.start=function(a,b){var c=this;return u(function e(){var f,h;return y(e,function(e){switch(e.s){case 1:return c.j=b,v(e,ih(c,mc([a],c.g.retryParameters),0),2);case 2:return f=e.B,c.F=f.uri,v(e,jh(c,f.data),3);case 3:return h=c.X,0<h&&c.m.V(h),e["return"](c.A)}})})};m.stop=function(){this.m&&(this.m.stop(),this.m=null);var a=[];this.o&&(a.push(this.o.destroy()),this.o=null);this.g=this.j=null;this.L.clear();this.Z.clear();this.h.clear();this.A=null;return Promise.all(a)};
m.update=function(){if(this.l!=kh.$a){for(var a=[],b=t(this.h.values()),c=b.next();!c.done;c=b.next())a.push(lh(this,c.value));return Promise.all(a)}};
function lh(a,b){return u(function d(){var e,f,h,k,l,n,p,q,r,x,C;return y(d,function(d){switch(d.s){case 1:return e=Ug,f=kh,h=b.We,v(d,ih(a,mc([h],a.g.retryParameters),0),2);case 2:k=d.B;l=$g(a.C,k.data,k.uri);if(1!=l.type)throw new D(2,4,4017);p=(n=e.cb(l.g,"EXT-X-MEDIA-SEQUENCE"))?Number(n.value):0;q=b.stream;return v(d,mh(a,b.Pc,l,p,q.mimeType,q.codecs),3);case 3:r=d.B;b.fc.g=r;x=r[r.length-1];if(C=e.cb(l.g,"EXT-X-ENDLIST"))nh(a,f.$a),a.i.Fa(x.endTime);w(d)}})})}m.onExpirationUpdated=function(){};
function jh(a,b){return u(function d(){var e,f,h,k,l,n,p,q,r,x,C;return y(d,function(d){switch(d.s){case 1:e=$g(a.C,b,a.F);if(0!=e.type)throw new D(2,4,4022);return v(d,oh(a,e),2);case 2:f=d.B;if(!a.j)throw new D(2,7,7001);if(a.da&&0==f.variants.length)throw B.info("No stream is created, because we don't support AES-128","encryption yet"),new D(2,4,4034);a.j.filterAllPeriods([f]);h=Infinity;k=0;l=Infinity;for(var F=t(a.h.values()),z=F.next();!z.done;z=F.next())n=z.value,h=Math.min(h,n.td),k=Math.max(k,
n.td),"text"!=n.stream.type&&(l=Math.min(l,n.duration));a.l!=kh.$a?(a.i=new X(0,3*a.J),a.i.hc(!1)):(a.i=new X(null,0),a.i.hc(!0));ph(a);if(a.l!=kh.$a){a.X=a.M;p=kh;a.l==p.Wd&&(q=a.i.Ic,isNaN(a.g.availabilityWindowOverride)||(q=a.g.availabilityWindowOverride),a.i.Pd(q));for(r=0;95443.7176888889<=k;)r+=95443.7176888889,k-=95443.7176888889;if(r)for(B.debug("Offsetting live streams by",r,"to compensate for rollover"),F=t(a.h.values()),z=F.next();!z.done;z=F.next())x=z.value,95443.7176888889>x.td?(B.K("Offset applied to",
x.stream.type),x.stream.presentationTimeOffset=-r,x.fc.offset(r)):B.K("Offset NOT applied to",x.stream.type)}else for(a.i.Fa(l),a.i.offset(-h),F=t(a.h.values()),z=F.next();!z.done;z=F.next())C=z.value,C.stream.presentationTimeOffset=h,C.fc.offset(-h),cg(C.fc,l);a.A={presentationTimeline:a.i,periods:[f],offlineSessionIds:[],minBufferTime:0};w(d)}})})}
function oh(a,b){return u(function d(){var e,f,h,k,l,n,p,q,r,x,C,z;return y(d,function(d){switch(d.s){case 1:return e=Ug,f=xb,h=b.g,k=e.Ab(b.g,"EXT-X-MEDIA"),l=k.filter(function(a){return"SUBTITLES"==qh(a,"TYPE")}.bind(a)),n=l.map(function(a){var b=this;return u(function ba(){var d;return y(ba,function(e){switch(e.s){case 1:if(b.g.disableText)return e["return"](null);Ba(e,2);return v(e,rh(b,a),4);case 4:return e["return"](e.B);case 2:d=Ga(e);if(b.g.hls.ignoreTextStreamFailures)return e["return"](null);
throw d;}})})}.bind(a)),p=k.filter(function(a){return"CLOSED-CAPTIONS"==qh(a,"TYPE")}),sh(a,p),v(d,Promise.all(n),2);case 2:return q=d.B,r=e.Ab(h,"EXT-X-STREAM-INF"),x=r.map(function(a){return th(this,a,b)}.bind(a)),v(d,Promise.all(x),3);case 3:return C=d.B,z=C.reduce(f.Rc,[]),z=z.filter(function(a){return null!=a}),d["return"]({startTime:0,variants:z,textStreams:q.filter(function(a){return null!=a})})}})})}
function th(a,b,c){return u(function e(){var f,h,k,l,n,p,q,r,x,C,z,F,I,R,sa,ba,Ya,Ia,ma,Za,ea,ta,Ja,Pa,wa,$a,lb,dc,Bb;return y(e,function(e){switch(e.s){case 1:f=Ab;h=Ug;k=[];a.g.disableVideo||k.push("avc1.42E01E");a.g.disableAudio||k.push("mp4a.40.2");l=k.join(",");n=Sg(b,"CODECS",l);p=uh(n.split(/\s*,\s*/));q=b.getAttribute("RESOLUTION");x=r=null;C=Sg(b,"FRAME-RATE");z=Number(Sg(b,"AVERAGE-BANDWIDTH"))||Number(qh(b,"BANDWIDTH"));q&&(F=q.value.split("x"),r=F[0],x=F[1]);I=h.Ab(c.g,"EXT-X-MEDIA");
I=I.filter(function(a){return"CLOSED-CAPTIONS"!=qh(a,"TYPE")});I=I.filter(function(a){var b=Sg(a,"URI")||"";return"SUBTITLES"==(Sg(a,"TYPE")||"")||""!=b});R=Sg(b,"AUDIO");sa=Sg(b,"VIDEO");R?I=h.Zc(I,"AUDIO",R):sa&&(I=h.Zc(I,"VIDEO",sa));if(ba=vh(f.za,p)){if(Ya=Sg(b,"SUBTITLES"))if(Ia=h.Zc(I,"SUBTITLES",Ya),Ia.length&&(ma=a.L.get(Ia[0].id)))ma.stream.codecs=ba;fc(p,ba)}Za=I.map(function(a){return wh(this,a,p)}.bind(a));ea=[];ta=[];return v(e,Promise.all(Za),2);case 2:Pa=e.B;Pa=Pa.filter(function(a){return null!=
a});R?ea=Pa:sa&&(ta=Pa);B.debug("Guessing stream type for",b.toString());$a=!1;ea.length||ta.length?ea.length?(dc=qh(b,"URI"),Bb=ea[0].Pc,dc==Bb?(B.debug("Guessing audio-only."),wa=f.Sb,$a=!0):(B.debug("Guessing video."),wa=f.Za)):(B.debug("Guessing audio."),wa=f.Sb):1==p.length?(lb=vh(f.Za,p),q||C||lb?(B.debug("Guessing video-only."),wa=f.Za):(B.debug("Guessing audio-only."),wa=f.Sb)):(B.debug("Guessing multiplexed audio+video."),wa=f.Za,p=[p.join(",")]);if($a){e.I(3);break}return v(e,xh(a,b,p,wa),
4);case 4:Ja=e.B;case 3:if(Ja)Ja.stream.type==f.Sb?ea=[Ja]:ta=[Ja];else if(null===Ja)return B.debug("streamInfo is null"),e["return"]([]);ta&&yh(ta);ea&&yh(ea);return e["return"](zh(a,ea,ta,z,r,x,C))}})})}function yh(a){a.forEach(function(a){if(a){var b=a.stream.codecs.split(",");b=b.filter(function(a){return"mp4a.40.34"!=a});a.stream.codecs=b.join(",")}})}
function zh(a,b,c,d,e,f,h){c.forEach(function(a){if(a=a.stream)a.width=Number(e)||void 0,a.height=Number(f)||void 0,a.frameRate=Number(h)||void 0}.bind(a));var k=a.g?a.g.disableAudio:!1;if(!b.length||k)b=[null];k=a.g?a.g.disableVideo:!1;if(!c.length||k)c=[null];k=[];b=t(b);for(var l=b.next();!l.done;l=b.next()){l=l.value;for(var n=t(c),p=n.next();!p.done;p=n.next()){var q=p.value;p=l?l.stream:null;var r=q?q.stream:null,x=l?l.drmInfos:null,C=q?q.drmInfos:null;q=(q?q.Pc:"")+" - "+(l?l.Pc:"");var z=
void 0;if(p&&r)if(x.length&&C.length?0<zd(x,C).length:1)z=zd(x,C);else{B.v("Incompatible DRM info in HLS variant.  Skipping.");continue}else p?z=x:r&&(z=C);a.Z.has(q)?B.debug("Skipping variant which only differs in text streams."):(p=Ah(a,p,r,d,z),k.push(p),a.Z.add(q))}}return k}function Ah(a,b,c,d,e){return{id:a.ea++,language:b?b.language:"und",primary:!!b&&b.primary||!!c&&c.primary,audio:b,video:c,bandwidth:d,drmInfos:e,allowedByApplication:!0,allowedByKeySystem:!0}}
function rh(a,b){return u(function d(){var e;return y(d,function(d){switch(d.s){case 1:return qh(b,"TYPE"),v(d,wh(a,b,[]),2);case 2:return e=d.B,d["return"](e.stream)}})})}function sh(a,b){for(var c=t(b),d=c.next();!d.done;d=c.next()){d=d.value;qh(d,"TYPE");var e=Sg(d,"LANGUAGE")||"und";e=N(e);var f=qh(d,"GROUP-ID");d=qh(d,"INSTREAM-ID");a.u.get(f)||a.u.set(f,new Map);a.u.get(f).set(d,e)}}
function wh(a,b,c){return u(function e(){var f,h,k,l,n,p,q,r,x,C,z;return y(e,function(e){switch(e.s){case 1:f=qh(b,"URI");if(a.h.has(f))return e["return"](a.h.get(f));h=qh(b,"TYPE").toLowerCase();k=Ab;"subtitles"==h&&(h=k.za);l=N(Sg(b,"LANGUAGE","und"));n=Sg(b,"NAME");p=b.getAttribute("DEFAULT");q="YES"==p;r=Sg(b,"CHANNELS");if("audio"==h)if(r){var F=r.split("/")[0];F=parseInt(F,10)}else F=null;else F=null;x=F;C=Sg(b,"CHARACTERISTICS");return v(e,Bh(a,f,c,h,l,q,n,x,null,C),2);case 2:z=e.B;if(a.h.has(f))return e["return"](a.h.get(f));
if(null==z)return e["return"](null);a.L.set(b.id,z);a.h.set(f,z);return e["return"](z)}})})}
function xh(a,b,c,d){return u(function f(){var h,k,l,n,p;return y(f,function(f){switch(f.s){case 1:h=Ab;k=qh(b,"URI");if(a.h.has(k))return f["return"](a.h.get(k));l=Sg(b,"CLOSED-CAPTIONS");n=null;d==h.Za&&l&&"NONE"!=l&&(n=a.u.get(l));return v(f,Bh(a,k,c,d,"und",!1,null,null,n,null),2);case 2:p=f.B;if(null==p)return f["return"](null);if(a.h.has(k))return f["return"](a.h.get(k));a.h.set(k,p);return f["return"](p)}})})}
function Bh(a,b,c,d,e,f,h,k,l,n){return u(function q(){var r,x,C,z,F,I,R,sa,ba,Ya,Ia,ma,Za,ea,ta,Ja,Pa,wa,$a,lb,dc,Bb,Cb,Db,mb,Da,nb,Ea;return y(q,function(q){switch(q.s){case 1:return r=Ug,x=r.Sc(a.F,b),v(q,ih(a,mc([x],a.g.retryParameters),0),2);case 2:C=q.B;x=C.uri;z=$g(a.C,C.data,x);if(1!=z.type)throw new D(2,4,4017);F=[];z.segments.forEach(function(a){a=r.Ab(a.h,"EXT-X-KEY");F.push.apply(F,a)});I=!1;R=[];sa=null;for(var Ka=t(F),ja=Ka.next();!ja.done;ja=Ka.next())if(ba=ja.value,Ya=qh(ba,"METHOD"),
"NONE"!=Ya){I=!0;if("AES-128"==Ya)return B.v("Unsupported HLS Encryption",Ya),a.da=!0,q["return"](null);Ia=qh(ba,"KEYFORMAT");(Za=(ma=Ch[Ia])?ma(ba):null)?(Za.keyIds.length&&(sa=Za.keyIds[0]),R.push(Za)):B.v("Unsupported HLS KEYFORMAT",Ia)}if(I&&!R.length)throw new D(2,4,4026);Dh(a,z);ea=Eh(d,c);return v(q,Fh(a,d,ea,z),3);case 3:return ta=q.B,Gh.includes(ta)&&(ea=""),Pa=(Ja=r.cb(z.g,"EXT-X-MEDIA-SEQUENCE"))?Number(Ja.value):0,Ba(q,4),v(q,mh(a,b,z,Pa,ta,ea),6);case 6:wa=q.B;Fa(q,5);break;case 4:$a=
Ga(q);if(4035==$a.code)return B.ba("Skipping unsupported HLS stream",ta,b),q["return"](null);throw $a;case 5:lb=wa[0].startTime;dc=wa[wa.length-1].endTime;Bb=dc-lb;Cb=new bg(wa);Db=Hh(z);mb=void 0;"text"==d&&(mb="subtitle");Da=[];if(n)for(Ka=t(n.split(",")),ja=Ka.next();!ja.done;ja=Ka.next())nb=ja.value,Da.push(nb);Ea={id:a.ea++,originalId:h,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:Cb.find.bind(Cb),getSegmentReference:Cb.get.bind(Cb),initSegmentReference:Db,presentationTimeOffset:0,
mimeType:ta,codecs:ea,kind:mb,encrypted:I,keyId:sa,language:e,label:h,type:d,primary:f,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:Da,channelsCount:k,audioSamplingRate:null,closedCaptions:l};return q["return"]({stream:Ea,fc:Cb,drmInfos:R,Pc:b,We:x,td:lb,Yg:dc,duration:Bb})}})})}
function Dh(a,b){var c=kh,d=Ug.cb(b.g,"EXT-X-PLAYLIST-TYPE"),e=Ug.cb(b.g,"EXT-X-ENDLIST");e=d&&"VOD"==d.value||e;d=d&&"EVENT"==d.value&&!e;d=!e&&!d;e?nh(a,c.$a):(d?nh(a,c.Wd):nh(a,c.Se),c=Ih(b.g,"EXT-X-TARGETDURATION"),c=Number(c.value),a.J=Math.max(c,a.J),a.M=Math.min(c,a.M))}
function Hh(a){var b=Ug.Ab(a.g,"EXT-X-MAP");if(!b.length)return null;if(1<b.length)throw new D(2,4,4020);b=b[0];var c=qh(b,"URI"),d=Ug.Sc(a.h,c);a=0;c=null;if(b=Sg(b,"BYTERANGE"))a=b.split("@"),b=Number(a[0]),a=Number(a[1]),c=a+b-1;return new Zf(function(){return[d]},a,c)}
function Jh(a,b,c,d){var e=b.h,f=b.g;b=Ih(e,"EXTINF").value.split(",");b=d+Number(b[0]);var h=0,k=null;if(e=Ug.cb(e,"EXT-X-BYTERANGE"))h=e.value.split("@"),e=Number(h[0]),h=h[1]?Number(h[1]):a.g+1,k=h+e-1;return new V(c,d,b,function(){return[f]},h,k)}function ph(a){a.i&&(a.P.forEach(function(b){a.i.Jb(b,0)}),a.P=[])}
function mh(a,b,c,d,e,f){return u(function k(){var l,n,p,q,r,x,C,z,F,I,R;return y(k,function(k){switch(k.s){case 1:return l=c.segments,n=[],p=l[0].g,q=Jh(null,l[0],d,0),r=Hh(c),v(k,Kh(a,b,r,q,e,f),2);case 2:x=k.B;B.debug("First segment",p.split("/").pop(),"starts at",x);for(var ba=0;ba<l.length;++ba)C=l[ba],z=n[n.length-1],F=0==ba?x:z.endTime,I=d+ba,R=Jh(z,C,I,F),n.push(R);a.P.push(n);ph(a);return k["return"](n)}})})}
function Lh(a,b){return u(function d(){var e,f,h,k,l,n;return y(d,function(d){switch(d.s){case 1:e=1;f=zg(b.i(),b.h,b.h+2048-1,a.g.retryParameters);h=zg(b.i(),b.h,b.g,a.g.retryParameters);if(a.g.hls.useFullSegmentsForStartTime)return d["return"](ih(a,h,e));Ba(d,2);return v(d,ih(a,f,e),4);case 4:return k=d.B,d["return"](k);case 2:l=Ga(d);if(7001==l.code)throw l;B.ba("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",
f.uris[0]);return v(d,ih(a,h,e),5);case 5:return n=d.B,d["return"](n)}})})}
function Kh(a,b,c,d,e,f){return u(function k(){var l,n,p,q,r,x,C,z,F;return y(k,function(k){switch(k.s){case 1:if(a.A){l=a.h.get(b);n=l.fc;if(p=n.get(d.position))return B.K("Found segment start time in previous manifest"),k["return"](p.startTime);B.debug("Unable to find segment start time in previous manifest!")}B.K("Fetching segment to find start time");e=e.toLowerCase();if(Gh.includes(e))throw B.ba("Raw formats are not yet supported.  Skipping "+e),new D(1,4,4035);if("video/webm"==e)throw B.ba("WebM in HLS is not yet supported.  Skipping."),
new D(1,4,4035);if("video/mp4"!=e&&"audio/mp4"!=e){k.I(2);break}q=[Lh(a,d)];c&&q.push(Lh(a,c));return v(k,Promise.all(q),3);case 3:return r=k.B,x=r[0],C=r[1]||r[0],k["return"](Mh(b,x.uri,x.data,C.data));case 2:if("video/mp2t"!=e){k.I(4);break}return v(k,Lh(a,d),5);case 5:return z=k.B,k["return"](Nh(b,z.uri,z.data));case 4:if("application/mp4"!=e&&!e.startsWith("text/")){k.I(6);break}return v(k,Lh(a,d),7);case 7:return F=k.B,k["return"](Oh(e,f,F.data));case 6:throw new D(2,4,4030,b);}})})}
function Mh(a,b,c,d){var e=0;(new T).box("moov",Ef).box("trak",Ef).box("mdia",Ef).ma("mdhd",function(a){a.reader.U(0==a.version?8:16);e=a.reader.N();a.parser.stop()}).parse(d,!0);if(!e)throw B.error("Unable to find timescale in init segment!"),new D(2,4,4030,a,b);var f=0,h=!1;(new T).box("moof",Ef).box("traf",Ef).ma("tfdt",function(a){f=(0==a.version?a.reader.N():a.reader.Pb())/e;h=!0;a.parser.stop()}).parse(c,!0);if(!h)throw new D(2,4,4030,a,b);return f}
function Nh(a,b,c){function d(){f.seek(h+188);k=f.ra();71!=k&&(f.seek(h+192),k=f.ra());71!=k&&(f.seek(h+204),k=f.ra());71!=k&&e();f.Fe(1)}function e(){throw new D(2,4,4030,a,b);}for(var f=new S(new DataView(c),0),h=0,k=0;;)if(h=f.ka(),k=f.ra(),71!=k&&e(),c=f.dc(),8191==(c&8191))d();else if(c&16384)if(c=(f.ra()&48)>>4,0!=c&&2!=c||e(),3==c&&(c=f.ra(),f.U(c)),1!=f.N()>>8)d();else{f.U(3);c=f.ra()>>6;0!=c&&1!=c||e();0==f.ra()&&e();c=f.ra();var l=f.dc(),n=f.dc();return(1073741824*((c&14)>>1)+((l&65534)<<
14|(n&65534)>>1))/9E4}else d()}function Oh(a,b,c){a=Dc(a,b);if(!be(a))return 0;b=new $d(null);ce(b,a);return b.xc(c)}function uh(a){var b=new Set,c=[];a=t(a);for(var d=a.next();!d.done;d=a.next()){d=d.value;var e=Hc(d)[0];b.has(e)?B.debug("Ignoring duplicate codec"):(c.push(d),b.add(e))}return c}function vh(a,b){for(var c=Ph[a],d=0;d<c.length;d++)for(var e=0;e<b.length;e++)if(c[d].test(b[e].trim()))return b[e].trim();return"text"==a?"":null}
function Eh(a,b){if(1==b.length)return b[0];var c=vh(a,b);if(null!=c)return c;throw new D(2,4,4025,b);}
function Fh(a,b,c,d){return u(function f(){var h,k,l,n,p,q,r,x,C,z;return y(f,function(f){switch(f.s){case 1:h=Ab;k=d.segments[0].g;l=new hb(k);n=l.pa.split(".").pop();p=Qh[b];if(q=p[n])return f["return"](q);if(b==h.za)return c&&"vtt"!=c&&"wvtt"!=c?f["return"]("application/mp4"):f["return"]("text/vtt");r=mc([k],a.g.retryParameters);r.method="HEAD";return v(f,ih(a,r,1),2);case 2:return x=f.B,C=x.headers["content-type"],C?f["return"](C.split(";")[0]):(z=p.mp4,f["return"](z))}})})}
function qh(a,b){var c=a.getAttribute(b);if(!c)throw new D(2,4,4023,b);return c.value}function Ih(a,b){var c=Ug.cb(a,b);if(!c)throw new D(2,4,4024,b);return c}
var Ph={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},Gh=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],Qh={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",
cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function gh(a){u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:B.info("Updating manifest...");if(!a.j)return c["return"]();Ba(c,2);return v(c,a.update(),4);case 4:d=a.X;a.m.V(d);Fa(c,0);break;case 2:e=Ga(c);if(!a.j)return c["return"]();e.severity=1;a.j.onError(e);a.m.V(.1);w(c)}})})}
function nh(a,b){a.l=b;a.i&&a.i.hc(a.l==kh.$a);a.l!=kh.$a||a.m.stop()}function ih(a,b,c){if(!a.o)throw new D(2,7,7001);b=a.j.networkingEngine.request(c,b);jc(a.o,b);return b.promise}
var Ch={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(a){var b=qh(a,"METHOD");Ee("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var c=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(!c.includes(b))return B.error("Widevine in HLS is only supported with [",c.join(", "),"], not",b),null;b=qh(a,"URI");b=eh.parse(b);b=new Uint8Array(b.data);b=zb("com.widevine.alpha",[{initDataType:"cenc",initData:b}]);if(a=Sg(a,"KEYID"))b.keyIds=[a.toLowerCase().substr(2)];
return b}},hh="VOD",kh={$a:hh,Se:"EVENT",Wd:"LIVE"};W.Fd("m3u8",fh);W.Qb("application/x-mpegurl",fh);W.Qb("application/vnd.apple.mpegurl",fh);function Rh(){this.g=new Map}function Sh(a,b,c){Th(a,b).text=c}function Th(a,b){a.g.has(b)||a.g.set(b,new Uh);return a.g.get(b)}function Uh(){this.text=this.variant=null};function Vh(a,b){this.g=a;this.h=new Set([a]);b=b||[];for(var c=t(b),d=c.next();!d.done;d=c.next())this.add(d.value)}Vh.prototype.add=function(a){if(Wh(this.g,a))return this.h.add(a),!0;B.v("Rejecting variant - not compatible with root.");return!1};
function Wh(a,b){var c;if(!(c=!!a.audio!=!!b.audio||!!a.video!=!!b.video||a.language!=b.language)&&(c=a.audio&&b.audio)){c=a.audio;var d=b.audio;c=!(c.channelsCount==d.channelsCount&&Xh(c,d)&&Yh(c.roles,d.roles))}!c&&(c=a.video&&b.video)&&(c=a.video,d=b.video,c=!(Xh(c,d)&&Yh(c.roles,d.roles)));return c?!1:!0}Vh.prototype.values=function(){return this.h.values()};
function Xh(a,b){if(a.mimeType!=b.mimeType)return!1;var c=a.codecs.split(",").map(function(a){return Hc(a)[0]}),d=b.codecs.split(",").map(function(a){return Hc(a)[0]});if(c.length!=d.length)return!1;c.sort();d.sort();for(var e=0;e<c.length;e++)if(c[e]!=d[e])return!1;return!0}function Yh(a,b){var c=new Set(a),d=new Set(b);c["delete"]("main");d["delete"]("main");if(c.size!=d.size)return!1;c=t(c);for(var e=c.next();!e.done;e=c.next())if(!d.has(e.value))return!1;return!0};function Zh(a){this.g=a;this.h=new $h(a.language,"",a.audio&&a.audio.channelsCount?a.audio.channelsCount:0,"")}Zh.prototype.create=function(a){var b=this,c=a.filter(function(a){return Wh(b.g,a)});return c.length?new Vh(c[0],c):this.h.create(a)};function $h(a,b,c,d){this.i=a;this.j=b;this.g=c;this.h=void 0===d?"":d}
$h.prototype.create=function(a){var b=[];b=ai(a,this.i);var c=a.filter(function(a){return a.primary});b=b.length?b:c.length?c:a;a=bi(b,this.j);a.length?b=a:B.v("No exact match for variant role could be found.");this.g&&(a=O.ee(b,this.g),a.length?b=a:B.v("No exact match for the channel count could be found."));this.h&&(a=ci(b,this.h),a.length?b=a:B.v("No exact match for variant label could be found."));a=new Vh(b[0]);b=t(b);for(c=b.next();!c.done;c=b.next())c=c.value,Wh(a.g,c)&&a.add(c);return a};
function ai(a,b){var c=N(b),d=Be(c,a.map(function(a){return Ae(a)}));return d?a.filter(function(a){return d==Ae(a)}):[]}function bi(a,b){return a.filter(function(a){return a.audio?b?a.audio.roles.includes(b):0==a.audio.roles.length:!1})}function ci(a,b){return a.filter(function(a){return a.audio?a.audio.label.toLowerCase()==b.toLowerCase():!1})};function di(){this.g=ei;this.h=(new Map).set(ei,2).set(fi,1)}function gi(a,b,c){a.h.set(ei,c).set(fi,b)}var fi=0,ei=1;function hi(a,b){this.l=a;this.m=ii(a);this.g=a.g.currentTime;this.j=Date.now()/1E3;this.h=!1;this.o=b;this.i=function(){}}hi.prototype.release=function(){this.l=null;this.i=function(){}};function ji(a,b){a.i=b}function ki(a){this.g=a}function ii(a){if(a.g.paused||0==a.g.playbackRate||0==a.g.buffered.length)var b=!1;else a:{b=a.g.buffered;a=a.g.currentTime;for(var c=0;c<b.length;c++){var d=b.start(c),e=b.end(c);if(!(a<d-.1||a>e-.5)){b=!0;break a}}b=!1}return b};function li(a,b,c,d,e){var f=this;this.g=a;this.F=b;this.C=c;this.u=e;this.j=new M;this.o=!1;this.A=a.readyState;this.i=!1;this.h=d;this.m=!1;this.j.H(a,"waiting",function(){return mi(f)});this.l=(new H(function(){mi(f)})).Oa(.25)}li.prototype.release=function(){this.j&&(this.j.release(),this.j=null);null!=this.l&&(this.l.stop(),this.l=null);this.h&&(this.h.release(),this.h=null);this.g=this.F=this.u=null};li.prototype.zd=function(){this.m=!0;mi(this)};
function mi(a){if(0!=a.g.readyState){if(a.g.seeking){if(!a.o)return}else a.o=!1;if(!a.g.paused||0==a.g.currentTime){a.g.readyState!=a.A&&(a.i=!1,a.A=a.g.readyState);var b;if(!(b=!a.h)){b=a.h;var c=b.l,d=ii(c),e=c.g.currentTime,f=Date.now()/1E3;if(b.g!=e||b.m!=d)b.j=f,b.g=e,b.m=d,b.h=!1;e=f-b.j;if(d=e>=b.o&&d&&!b.h)b.i(b.g,e),b.h=!0,b.g=c.g.currentTime;b=!d}if(b){f=a.C.smallGapLimit;b=a.g.currentTime;c=a.g.buffered;a:{if(c&&c.length&&!(1==c.length&&1E-6>c.end(0)-c.start(0)))for(d=navigator.userAgent.match(/Edge\//)||
Mc("Trident/")||Lc()||Mc("CrKey")?.5:.1,e=0;e<c.length;e++)if(c.start(e)>b&&(0==e||c.end(e-1)-b<=d)){d=e;break a}d=null}if(null!=d&&(0!=d||a.m)){e=c.start(d);var h=a.F.Ka();if(!(e>=h)){h=e-b;f=h<=f;var k=!1;if(!(.001>h)){if(!f&&!a.i){a.i=!0;var l=new K("largegap",{currentTime:b,gapSize:h});l.cancelable=!0;a.u(l);a.C.jumpLargeGaps&&!l.defaultPrevented?k=!0:B.info("Ignoring large gap at",b,"size",h)}if(f||k)0==d?B.info("Jumping forward",h,"seconds because of gap before start time of",e):B.info("Jumping forward",
h,"seconds because of gap starting at",c.end(d-1),"and ending at",e),a.g.currentTime=e}}}}}}};function ni(a){var b=this;this.i=a;this.g=new Set;this.h=(new H(function(){oi(b,!1)})).Oa(.25)}ni.prototype.release=function(){this.h.stop();for(var a=t(this.g),b=a.next();!b.done;b=a.next())b.value.release();this.g.clear()};function oi(a,b){for(var c=t(a.g),d=c.next();!d.done;d=c.next())d.value.l(a.i.currentTime,b)};function pi(a){var b=[];a=t(a);for(var c=a.next();!c.done;c=a.next()){c=t(c.value.variants);for(var d=c.next();!d.done;d=c.next())b.push(d.value)}return b}function qi(a,b){for(var c=null,d=t(a),e=d.next();!e.done;e=d.next())e=e.value,b>=e.startTime&&(c=e);return c};function ri(a){this.i=a;this.g=null;this.h=function(){}}ri.prototype.release=function(){this.g=this.i=null;this.h=function(){}};ri.prototype.l=function(a){var b=this.g,c=this.i.periods;a=qi(c,a)||c[0];b!=a&&this.h(a);this.g=a};function si(a,b){a.h=b};function ti(a){var b=this;this.g=a;this.j=!1;this.i=this.g.wc();this.h=new H(function(){b.g.pe(.25*b.i)})}ti.prototype.release=function(){this.h&&(this.h.stop(),this.h=null);this.g=null};ti.prototype.set=function(a){this.i=a;ui(this)};ti.prototype.vc=function(){return this.g.vc()};function ui(a){a.h.stop();var b=a.j?0:a.i;if(0<=b)try{a.g.wc()!=b&&a.g.Od(b);return}catch(c){}a.h.Oa(.25);0!=a.g.wc()&&a.g.Od(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function vi(a,b,c,d){b==HTMLMediaElement.HAVE_NOTHING||a.readyState>=b?d():(b=wi.get(b),c.ya(a,b,d))}var wi=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function xi(a,b,c){var d=this;this.g=a;this.l=b;this.j=c;this.m=!1;this.h=new M;this.i=new yi(a);vi(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){zi(d,d.j)})}xi.prototype.release=function(){this.h&&(this.h.release(),this.h=null);null!=this.i&&(this.i.release(),this.i=null);this.l=function(){};this.g=null};function Ai(a){return a.m?a.g.currentTime:a.j}function Bi(a,b){0<a.g.readyState?Ci(a.i,b):vi(a.g,HTMLMediaElement.HAVE_METADATA,a.h,function(){zi(a,a.j)})}
function zi(a,b){.001>Math.abs(a.g.currentTime-b)?Di(a):(a.h.ya(a.g,"seeking",function(){Di(a)}),Ci(a.i,0==a.g.currentTime?b:a.g.currentTime))}function Di(a){a.m=!0;a.h.H(a.g,"seeking",function(){return a.l()})}function yi(a){var b=this;this.h=a;this.m=10;this.l=this.i=this.j=0;this.g=new H(function(){0>=b.j?(B.v(["Failed to move playhead from",b.i,"to",b.l].join(" ")),b.g.stop()):b.h.currentTime!=b.i?b.g.stop():(b.h.currentTime=b.l,b.j--)})}
yi.prototype.release=function(){this.g&&(this.g.stop(),this.g=null);this.h=null};function Ci(a,b){a.i=a.h.currentTime;a.l=b;a.j=a.m;a.h.currentTime=b;a.g.Oa(.1)};function Ei(a){function b(){null==c.i?c.j=!0:(c.h.ya(c.g,"seeking",function(){c.j=!0}),c.g.currentTime=Math.max(0,c.g.currentTime+c.i))}var c=this;this.g=a;this.j=!1;this.i=null;this.h=new M;vi(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.h,function(){b()})}Ei.prototype.release=function(){this.h&&(this.h.release(),this.h=null);this.g=null};Ei.prototype.A=function(a){this.i=this.j?this.i:a};Ei.prototype.l=function(){return(this.j?this.g.currentTime:this.i)||0};Ei.prototype.C=function(){};
function Fi(a,b,c,d,e,f){var h=this;this.i=a;this.g=b.presentationTimeline;this.J=b.minBufferTime||0;this.m=c;this.F=e;this.u=null;this.j=new li(a,b.presentationTimeline,c,Gi(a,c),f);this.h=new xi(a,function(){a:{var a=h.j;a.o=!0;a.m=!1;a.i=!1;a=Ai(h.h);var b=Hi(h,a);if(.001<Math.abs(b-a)){var c=Date.now()/1E3;if(!h.u||h.u<c-1){h.u=c;Bi(h.h,b);a=void 0;break a}}B.K("Seek to "+a);h.F();a=void 0}return a},Ii(this,d));this.o=(new H(function(){if(0!=h.i.readyState&&!h.i.paused){var a=Ai(h.h),b=h.g.Cb(),
c=h.g.Ka();3>c-b&&(b=c-3);a<b&&(b=Hi(h,a),B.info("Jumping forward "+(b-a)+" seconds to catch up with the seek range."),h.i.currentTime=b)}})).Oa(.25)}Fi.prototype.release=function(){this.h&&(this.h.release(),this.h=null);this.j&&(this.j.release(),this.j=null);this.o&&(this.o.stop(),this.o=null);this.i=this.h=this.g=this.m=null;this.F=function(){}};Fi.prototype.A=function(a){Bi(this.h,a)};Fi.prototype.l=function(){var a=Ai(this.h);return 0<this.i.readyState&&!this.i.paused?Ji(this,a):a};
function Ii(a,b){null==b?b=Infinity>a.g.ha()?a.g.Cb():a.g.Ka():0>b&&(b=a.g.Ka()+b);return Ki(a,Ji(a,b))}Fi.prototype.C=function(){this.j.zd()};function Ki(a,b){var c=a.g.ha();return b>=c?c-a.m.durationBackoff:b}
function Hi(a,b){var c=Fd.bind(null,a.i.buffered),d=Math.max(a.J,a.m.rebufferingGoal),e=a.m.safeSeekOffset,f=a.g.Cb(),h=a.g.Ka(),k=a.g.ha();3>h-f&&(f=h-3);var l=a.g.Zb(d),n=a.g.Zb(e);d=a.g.Zb(d+e);if(b>=k)return B.K("Playhead past duration."),Ki(a,b);if(b>h)return B.K("Playhead past end."),h;if(b<f){if(c(n))return B.K("Playhead before start & start is buffered"),n;B.K("Playhead before start & start is unbuffered");return d}if(b>=l||c(b))return B.K("Playhead in safe region or in buffered region."),
b;B.K("Playhead outside safe region & in unbuffered region.");return d}function Ji(a,b){var c=a.g.Cb();if(b<c)return c;c=a.g.Ka();return b>c?c:b}function Gi(a,b){if(!b.stallEnabled)return null;var c=b.stallSkip,d=new hi(new ki(a),b.stallThreshold);ji(d,function(b,d){B.debug("Stall detected at "+b+" for "+d+" seconds.");c?(B.debug("Seeking forward "+c+" seconds to break stall."),a.currentTime+=c):(B.debug("Pausing and unpausing to break stall."),a.pause(),a.play())});return d};function Li(a){var b=this;this.h=function(){};this.g=new Set;this.j=a;this.i=(new H(function(){for(var a=b.j(),d=t(b.g),e=d.next();!e.done;e=d.next())e=e.value,e.endTime<a.start&&b.g["delete"](e)})).Oa(2)}Li.prototype.release=function(){this.h=function(){};this.g.clear();this.i.stop()};function Mi(a,b){a.h=b};function Ni(a){var b=this;this.m=a;this.j=new Map;this.g=function(){};this.h=function(){};this.i=function(){};this.o=[{rb:null,qb:Oi,hb:function(a,d){return b.g(a,d)}},{rb:Pi,qb:Oi,hb:function(a,d){return b.g(a,d)}},{rb:Qi,qb:Oi,hb:function(a,d){return b.g(a,d)}},{rb:Oi,qb:Pi,hb:function(a,d){return b.h(a,d)}},{rb:Oi,qb:Qi,hb:function(a,d){return b.h(a,d)}},{rb:Pi,qb:Qi,hb:function(a,d){return b.i(a,d)}},{rb:Qi,qb:Pi,hb:function(a,d){return b.i(a,d)}}]}
Ni.prototype.release=function(){this.m=null;this.j.clear();this.g=function(){};this.h=function(){};this.i=function(){}};Ni.prototype.l=function(a,b){for(var c=t(this.m.g),d=c.next();!d.done;d=c.next()){d=d.value;var e=this.j.get(d),f=a<d.startTime?Pi:a>d.endTime?Qi:Oi;this.j.set(d,f);for(var h=t(this.o),k=h.next();!k.done;k=h.next())k=k.value,k.rb==e&&k.qb==f&&k.hb(d,b)}};function Ri(a,b,c,d){a.g=b;a.h=c;a.i=d}var Pi=1,Oi=2,Qi=3;function Si(a,b){this.g=b;this.i=a;this.l=null;this.u=1;this.F=Promise.resolve();this.m=[];this.o=new Map;this.h=new Map;this.C=!1;this.M=null;this.L=this.j=this.A=!1;this.J=0}Si.prototype.destroy=function(){var a=this;return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:d=[];for(var f=t(a.h.values()),k=f.next();!k.done;k=f.next())e=k.value,Ti(e),d.push(Ui(e));return v(c,Promise.all(d),2);case 2:a.h.clear(),a.o.clear(),a.g=null,a.i=null,a.F=null,a.m=null,a.l=null,a.j=!0,w(c)}})})};
Si.prototype.configure=function(a){this.l=a;this.M=new Sb({maxAttempts:Math.max(a.retryParameters.maxAttempts,2),baseDelay:a.retryParameters.baseDelay,backoffFactor:a.retryParameters.backoffFactor,fuzzFactor:a.retryParameters.fuzzFactor,timeout:0},!0)};
Si.prototype.start=function(){var a=this;return u(function c(){var d,e,f;return y(c,function(c){switch(c.s){case 1:return d=a.g.eb(),e=Vi(a,d),f=a.g.ue(a.i.periods[e]),f.variant||f.text?v(c,Wi(a,f.variant?f.variant.audio:null,f.variant?f.variant.video:null,f.text,d),2):(B.error("init: no Streams chosen"),c["return"](new D(2,5,5005)));case 2:if(a.j)return c["return"]();B.debug("init: completed initial Stream setup");a.g&&a.g.Yf&&(B.K("init: calling onInitialStreamsSetup()..."),a.g.Yf());w(c)}})})};
function Xi(a){return Yi(a,"audio")}function Zi(a){return Yi(a,"video")}function Yi(a,b){var c=a.h.get(b);return c?c.Ta||c.stream:null}
function $i(a,b){return u(function d(){var e,f,h,k,l,n,p,q,r,x;return y(d,function(d){switch(d.s){case 1:return e=Ab,v(d,te(a.g.T,e.za),2);case 2:return a.J++,a.L=!1,f=a.J,h=a.g.T,k=new Map,l=new Set,k.set(e.za,b),l.add(b),v(d,h.init(k,!1),3);case 3:return a.j?d["return"]():v(d,aj(a,l),4);case 4:if(a.j)return d["return"]();p=(n=a.g.T.l.isTextVisible())||a.l.alwaysStreamText;a.J!=f||a.h.has(e.za)||a.L||!p||(q=a.g.eb(),r=Vi(a,q),x=bj(b,r,0),a.h.set(e.za,x),cj(a,x,0));w(d)}})})}
function dj(a){a.L=!0;var b=a.h.get("text");b&&(Ti(b),Ui(b)["catch"](function(){}),a.h["delete"]("text"))}function ej(a,b){var c=a.h.get("video");if(c){var d=c.stream;if(d)if(B.debug("setTrickPlay",b),b){var e=d.trickModeVideo;e&&!c.Ta&&(B.debug("Engaging trick mode stream",e),fj(a,e,!1,0,!1),c.Ta=d)}else if(d=c.Ta)B.debug("Restoring non-trick-mode stream",d),c.Ta=null,fj(a,d,!0,0,!1)}}
function gj(a,b,c,d){var e=!1;if(b.video){var f=fj(a,b.video,c,d,!1);e=e||f}b.audio&&(a=fj(a,b.audio,c,d,!1),e=e||a);return e}
function fj(a,b,c,d,e){var f=a.h.get(b.type);if(!f&&"text"==b.type&&a.l.ignoreTextStreamFailures)return $i(a,b),!0;if(!f)return!1;var h=hj(a,b),k=Array.from(a.h.values()).every(function(a){return a.oa==f.oa});if(c&&h!=f.oa&&k)return B.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),a.h.forEach(function(b){ij(a,b)}),!0;f.Ta&&(B.debug("switch during trick play mode",b),b.trickModeVideo?(f.Ta=b,b=b.trickModeVideo,B.debug("switch found trick play stream",b)):
(f.Ta=null,B.debug("switch found no special trick play stream")));k=a.m[h];if(!k||!k.Rb)return!1;k=a.o.get(b.id);if(!k||!k.Rb)return!1;if(f.stream==b&&!e)return B.debug("switch: Stream "+jj(f)+" already active"),!1;"text"==b.type&&ke(a.g.T,Dc(b.mimeType,b.codecs));f.stream=b;f.Ac=!0;B.debug("switch: switching to Stream "+jj(f));kj(a,f,h)&&(B.info("Aborting current segment request to switch."),f.lb.abort());c&&(f.ab?f.Qc=!0:f.Sa?(f.Wa=!0,f.oc=d,f.Qc=!0):(Ti(f),lj(a,f,!0,d)["catch"](function(b){if(a.g)a.g.onError(b)})));
return!0}function kj(a,b,c){if(!b.lb)return!1;var d=a.g.eb(),e=oe(a.g.T,b.type),f=mj(a,b,d,e,c);c=f?f.g?f.g-f.h:null:null;f&&!c&&(c=(f.endTime-f.xc())*b.stream.bandwidth/8);if(isNaN(c))return!1;(f=b.stream.initSegmentReference)&&(c+=(f.g?f.g-f.h:null)||0);f=a.g.getBandwidthEstimate();return 8*c/f<e-d-Math.max(a.i.minBufferTime||0,a.l.rebufferingGoal)||b.lb.h.g>c?!0:!1}
function nj(a){function b(b){var e=a.g.T;"text"==b?(b=e.g,b=null==b.g||null==b.h?!1:c>=b.g&&c<b.h):(b=ne(e,b),b=Fd(b,c,d));return b}var c=a.g.eb(),d=a.l.smallGapLimit,e=!1,f=Vi(a,c);if(Ac(a.h.values(),function(a){return a.oa==f}))for(var h=t(a.h.keys()),k=h.next();!k.done;k=h.next())k=k.value,b(k)||(ij(a,a.h.get(k)),e=!0);else Ac(a.h.keys(),b)||(B.debug("(all): seeked: unbuffered seek: clearing all buffers"),a.h.forEach(function(b){ij(a,b)}),e=!0);e||B.debug("(all): seeked: buffered seek: presentationTime="+
c)}function ij(a,b){var c=jj(b);b.ab?B.debug(c,"clear: already clearing the buffer"):b.Wa?B.debug(c,"clear: already waiting"):b.Sa?(B.debug(c,"clear: currently updating"),b.Wa=!0,b.oc=0):null==me(a.g.T,b.type)?(B.debug(c,"clear: nothing buffered"),null==b.Pa&&cj(a,b,0)):(B.debug(c,"clear: handling right now"),Ti(b),lj(a,b,!1,0)["catch"](function(b){if(a.g)a.g.onError(b)}))}
function Wi(a,b,c,d,e){return u(function h(){var k,l,n,p,q,r,x;return y(h,function(h){switch(h.s){case 1:return k=a.g.eb(),l=Vi(a,k),n=Ab,p=new Map,q=new Set,b&&(p.set(n.Sb,b),q.add(b)),c&&(p.set(n.Za,c),q.add(c)),d&&(p.set(n.za,d),q.add(d)),r=a.g.T,x=a.l.forceTransmuxTS,v(h,r.init(p,x),2);case 2:if(a.j)return h["return"]();oj(a);return v(h,aj(a,q),3);case 3:if(a.j)return h["return"]();p.forEach(function(b,c){if(!a.h.has(c)){var d=bj(b,l,e);a.h.set(c,d);cj(a,d,0)}});w(h)}})})}
function bj(a,b,c){return{stream:a,type:a.type,Hb:null,La:null,Ta:null,Ac:!0,oa:b,endOfStream:!1,Sa:!1,Pa:null,Wa:!1,oc:0,Qc:!1,ab:!1,Ed:!1,ac:!1,Hd:c||0,lb:null}}
function pj(a,b){var c=a.m[b];if(c)return B.debug("(all) Period "+b+" is being or has been set up"),c.promise;B.debug("(all) setting up Period "+b);c={promise:new E,Rb:!1};a.m[b]=c;for(var d=new Set,e=t(a.i.periods[b].variants),f=e.next();!f.done;f=e.next())f=f.value,f.video&&d.add(f.video),f.video&&f.video.trickModeVideo&&d.add(f.video.trickModeVideo),f.audio&&d.add(f.audio);e=t(a.i.periods[b].textStreams);for(f=e.next();!f.done;f=e.next())d.add(f.value);a.F=a.F.then(function(){if(!this.j)return aj(this,
d)}.bind(a)).then(function(){this.j||(this.m[b].promise.resolve(),this.m[b].Rb=!0,B.K("(all) setup Period "+b))}.bind(a))["catch"](function(a){this.j||(this.m[b].promise["catch"](function(){}),this.m[b].promise.reject(),delete this.m[b],B.v("(all) failed to setup Period "+b),this.g.onError(a))}.bind(a));return c.promise}
function aj(a,b){return u(function d(){var e,f,h,k,l,n,p;return y(d,function(d){switch(d.s){case 1:e=[];for(var q=t(b),x=q.next();!x.done;x=q.next())f=x.value,(h=a.o.get(f.id))?(B.debug("(all) Stream "+f.id+" is being or has been set up"),e.push(h.promise)):(B.K("(all) setting up Stream "+f.id),a.o.set(f.id,{promise:new E,Rb:!1}),e.push(f.createSegmentIndex()));Ba(d,2);return v(d,Promise.all(e),4);case 4:if(a.j)return d["return"]();Fa(d,3);break;case 2:k=Ga(d);if(a.j)return d["return"]();d=t(b);for(x=
d.next();!x.done;x=d.next())l=x.value,a.o.get(l.id).promise["catch"](function(){}),a.o.get(l.id).promise.reject(),a.o["delete"](l.id);throw k;case 3:q=t(b);for(x=q.next();!x.done;x=q.next())n=x.value,p=a.o.get(n.id),p.Rb||(p.promise.resolve(),p.Rb=!0,B.K("(all) setup Stream "+n.id));w(d)}})})}function oj(a){var b=a.i.presentationTimeline.ha();Infinity>b?a.g.T.Fa(b):a.g.T.Fa(Math.pow(2,32))}
function qj(a,b){if(!a.j){var c=jj(b);if(!b.Sa&&null!=b.Pa&&!b.ab)if(b.Pa=null,b.Wa)B.debug(c,"skipping update and clearing the buffer"),lj(a,b,b.Qc,b.oc);else{try{var d=rj(a,b);null!=d&&(cj(a,b,d),b.ac=!1)}catch(e){sj(a,e);return}d=Array.from(a.h.values());tj(a,b);a.C&&d.every(function(a){return a.endOfStream})&&(B.K(c,"calling endOfStream()..."),a.g.T.endOfStream().then(function(){if(!this.j){var a=this.g.T.ha();0!=a&&a<this.i.presentationTimeline.ha()&&this.i.presentationTimeline.Fa(a)}}.bind(a)))}}}
function rj(a,b){if(uj(b))return se(a.g.T,b.stream.originalId||""),null;var c=jj(b),d=a.g.eb(),e=vj(a,b,d);B.O(c,"timeNeeded="+e);var f=hj(a,b.stream),h=Vi(a,e),k=pe(a.g.T,b.type,d);B.O(c,"update_:","presentationTime="+d,"bufferedAhead="+k);var l=Math.max(a.i.minBufferTime||0,a.l.rebufferingGoal,a.l.bufferingGoal)*a.u;if(e>=a.i.presentationTimeline.ha())return B.debug(c,"buffered to end of presentation"),b.endOfStream=!0,"video"==b.type&&(e=a.h.get("text"))&&"application/cea-608"==e.stream.mimeType&&
(e.endOfStream=!0),null;b.endOfStream=!1;b.oa=h;if(h!=f)return B.debug(c,"need Period "+h,"presentationTime="+d,"timeNeeded="+e,"currentPeriodIndex="+f),null;if(k>=l)return B.O(c,"buffering goal met"),.5;c=oe(a.g.T,b.type);c=mj(a,b,d,c,f);if(!c)return 1;var n=Infinity;Array.from(a.h.values()).forEach(function(b){uj(b)||(b=vj(a,b,d),n=Math.min(n,b))});if(e>=n+a.i.presentationTimeline.g)return 1;b.Hd=0;wj(a,b,d,f,c);return null}
function vj(a,b,c){if(!b.Hb||!b.La)return Math.max(c,b.Hd);c=hj(a,b.Hb);return a.i.periods[c].startTime+b.La.endTime}
function mj(a,b,c,d,e){var f=jj(b);if(b.La&&b.stream==b.Hb)return d=b.La.position+1,B.O(f,"next position known:","position="+d),xj(a,b,e,d);b.La?(B.K(f,"next position unknown: another Stream buffered"),f=hj(a,b.Hb),f=yj(a,b,a.i.periods[f].startTime+b.La.endTime,e)):(B.K(f,"next position unknown: nothing buffered"),f=yj(a,b,d||c,e));if(null==f)return null;c=null;null==d&&(c=xj(a,b,e,Math.max(0,f-1)));return c||xj(a,b,e,f)}
function yj(a,b,c,d){var e=jj(b);a=a.i.periods[d];B.debug(e,"looking up segment:","presentationTime="+c,"currentPeriod.startTime="+a.startTime);c=Math.max(0,c-a.startTime);b=b.stream.findSegmentPosition(c);null==b&&B.v(e,"cannot find segment:","currentPeriod.startTime="+a.startTime,"lookupTime="+c);return b}
function xj(a,b,c,d){var e=jj(b);c=a.i.periods[c];b=b.stream.getSegmentReference(d);if(!b)return B.K(e,"segment does not exist:","currentPeriod.startTime="+c.startTime,"position="+d),null;d=a.i.presentationTimeline;a=d.$b();d=d.Db();return c.startTime+b.endTime<a||c.startTime+b.startTime>d?(B.O(e,"segment is not available:","currentPeriod.startTime="+c.startTime,"reference.startTime="+b.startTime,"reference.endTime="+b.endTime,"availabilityStart="+a,"availabilityEnd="+d),null):b}
function wj(a,b,c,d,e){var f=jj(b),h=a.i.periods[d];B.K(f,"fetchAndAppend_:","presentationTime="+c,"currentPeriod.startTime="+h.startTime,"reference.position="+e.position,"reference.startTime="+e.startTime,"reference.endTime="+e.endTime);var k=b.stream,l=a.i.presentationTimeline.ha(),n=a.i.periods[d+1];d=zj(a,b,d,Math.max(0,h.startTime-.1),n?n.startTime+.01:l);b.Sa=!0;b.Ac=!1;B.O(f,"fetching segment");l=Aj(a,b,e);Promise.all([d,l]).then(function(a){if(!this.j&&!this.A)return Bj(this,b,c,h,k,e,a[1])}.bind(a)).then(function(){this.j||
this.A||(b.Sa=!1,b.Ed=!1,b.Wa||this.g.zd(),cj(this,b,0),Cj(this,b,k),B.K(f,"finished fetch and append"))}.bind(a))["catch"](function(a){this.j||this.A||(b.Sa=!1,"text"==b.type&&this.l.ignoreTextStreamFailures?(1001==a.code?B.v(f,"Text stream failed to download. Proceeding without it."):B.v(f,"Text stream failed to parse. Proceeding without it."),this.h["delete"]("text")):7001==a.code?(b.Sa=!1,b.Pa=null,cj(this,b,0)):3017==a.code?Dj(this,b,a):(B.error(f,"failed fetch and append: code="+a.code),b.ac=
!0,a.severity=2,sj(this,a)))}.bind(a))}
function Dj(a,b,c){var d=jj(b);if(Array.from(a.h.values()).some(function(a){return a!=b&&a.Ed}))B.debug(d,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var e=Math.round(100*a.u);if(20<e)a.u-=.2;else if(4<e)a.u-=.04;else{B.error(d,"MediaSource threw QuotaExceededError too many times");b.ac=!0;a.A=!0;a.g.onError(c);return}B.v(d,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*a.u))+"%");b.Ed=!0}cj(a,b,4)}
function zj(a,b,c,d,e){if(!b.Ac)return Promise.resolve();var f=jj(b);c=a.i.periods[c].startTime-b.stream.presentationTimeOffset;B.K(f,"setting timestamp offset to "+c);B.K(f,"setting append window start to "+d);B.K(f,"setting append window end to "+e);d=ue(a.g.T,b.type,c,d,e);if(!b.stream.initSegmentReference)return d;B.K(f,"fetching init segment");a=Aj(a,b,b.stream.initSegmentReference).then(function(a){if(!this.j)return B.K(f,"appending init segment"),qe(this.g.T,b.type,a,null,null,b.stream.closedCaptions&&
0<b.stream.closedCaptions.size)}.bind(a))["catch"](function(a){b.Ac=!0;return Promise.reject(a)});return Promise.all([d,a])}
function Bj(a,b,c,d,e,f,h){var k=jj(b),l=e.closedCaptions&&0<e.closedCaptions.size;null!=e.emsgSchemeIdUris&&0<e.emsgSchemeIdUris.length&&(new T).ma("emsg",a.P.bind(a,d,f,e.emsgSchemeIdUris)).parse(h);return Ej(a,b,c).then(function(){if(!this.j)return B.K(k,"appending media segment"),qe(this.g.T,b.type,h,f.startTime+d.startTime,f.endTime+d.startTime,l)}.bind(a)).then(function(){if(!this.j)return B.O(k,"appended media segment"),b.Hb=e,b.La=f,Promise.resolve()}.bind(a))}
Si.prototype.P=function(a,b,c,d){var e=d.reader.Cd(),f=d.reader.Cd(),h=d.reader.N(),k=d.reader.N(),l=d.reader.N(),n=d.reader.N();d=d.reader.mb(d.reader.S.byteLength-d.reader.ka());a=a.startTime+b.startTime+k/h;if(c.includes(e))if("urn:mpeg:dash:event:2012"==e)this.g.Zf();else this.g.onEvent(new K("emsg",{detail:{startTime:a,endTime:a+l/h,schemeIdUri:e,value:f,timescale:h,presentationTimeDelta:k,eventDuration:l,id:n,messageData:d}}))};
function Ej(a,b,c){var d=jj(b);B.O(d,"checking buffer length");var e=Math.max(a.l.bufferBehind,a.i.presentationTimeline.g),f=me(a.g.T,b.type);if(null==f)return B.O(d,"buffer behind okay because nothing buffered:","presentationTime="+c,"bufferBehind="+e),Promise.resolve();var h=c-f,k=h-e;if(.01>=k)return B.O(d,"buffer behind okay:","presentationTime="+c,"bufferedBehind="+h,"bufferBehind="+e,"underflow="+Math.abs(k)),Promise.resolve();B.K(d,"buffer behind too large:","presentationTime="+c,"bufferedBehind="+
h,"bufferBehind="+e,"overflow="+k);return a.g.T.remove(b.type,f,f+k).then(function(){this.j||B.K(d,"evicted "+k+" seconds")}.bind(a))}
function Cj(a,b,c){if(!a.C){var d=jj(b);b=Array.from(a.h.values());if(1!=b.length||"text"!=b[0].type)a.C=b.every(function(a){return"text"==a.type?!0:!a.Wa&&!a.ab&&a.La});if(a.C){B.debug(d,"startup complete");c=hj(a,c);a.m[c]||pj(a,c).then(function(){this.j||(B.K(d,"calling onCanSwitch()..."),this.g.te())}.bind(a))["catch"](xb.Bc);for(c=0;c<a.i.periods.length;++c)pj(a,c)["catch"](xb.Bc);a.g.gg&&(B.K(d,"calling onStartupComplete()..."),a.g.gg())}}}
function tj(a,b){var c=jj(b),d=hj(a,b.stream);if(b.oa!=d){var e=b.oa,f=Array.from(a.h.values());f.every(function(a){return a.oa==e||uj(a)})?f.every(Fj)?(B.debug(c,"all need Period "+e),pj(a,e).then(function(){if(!this.j)if(f.every(function(a){var b=Fj(a),c=hj(this,a.stream);return uj(a)?!0:b&&a.oa==e&&c!=e}.bind(this))){var a=this.i.periods[e];B.K(c,"calling onChooseStreams()...");var b=this.g.ue(a),d=new Map;b.variant&&b.variant.video&&d.set("video",b.variant.video);b.variant&&b.variant.audio&&d.set("audio",
b.variant.audio);b.text&&d.set("text",b.text);b=t(this.h.keys());for(var n=b.next();!n.done;n=b.next())if(n=n.value,!d.has(n)&&"text"!=n){B.error(c,"invalid Streams chosen: missing "+n+" Stream");this.g.onError(new D(2,5,5005));return}b=t(Array.from(d.keys()));for(n=b.next();!n.done;n=b.next())if(n=n.value,!this.h.has(n))if("text"==n)Wi(this,null,null,d.get("text"),a.startTime),d["delete"](n);else{B.error(c,"invalid Streams chosen: unusable "+n+" Stream");this.g.onError(new D(2,5,5005));return}b=
t(Array.from(this.h.keys()));for(n=b.next();!n.done;n=b.next()){n=n.value;var p=this.h.get(n),q=d.get(n);if(q){var r=uj(p);r&&(p.oa=e,p.Hd=a.startTime);fj(this,q,!1,0,!1);r&&uj(p)||cj(this,this.h.get(n),0)}else this.h["delete"](n)}B.K(c,"calling onCanSwitch()...");this.g.te()}else B.debug(c,"ignoring transition to Period",e,"since another is happening")}.bind(a))["catch"](xb.Bc)):B.debug(c,"all MediaStates need Period "+e+", but not all MediaStates are idle"):B.debug(c,"not all MediaStates need Period "+
e)}}function uj(a){return a&&"text"==a.type&&"application/cea-608"==a.stream.mimeType}function Fj(a){return!a.Sa&&null==a.Pa&&!a.Wa&&!a.ab}function Vi(a,b){var c=qi(a.i.periods,b+Fb);return c?a.i.periods.indexOf(c):0}
function hj(a,b){for(var c=a.i.periods,d=0;d<c.length;d++){for(var e=c[d],f=new Set,h=t(e.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&f.add(k.audio),k.video&&f.add(k.video),k.video&&k.video.trickModeVideo&&f.add(k.video.trickModeVideo);e=t(e.textStreams);for(h=e.next();!h.done;h=e.next())f.add(h.value);if(f.has(b))return d}return-1}
function Aj(a,b,c){var d=zg(c.i(),c.h,c.g,a.l.retryParameters);B.O("fetching: reference=",c);a=a.g.Ib.request(1,d);b.lb=a;return a.promise.then(function(a){b.lb=null;return a.data})}
function lj(a,b,c,d){return u(function f(){var h,k,l,n;return y(f,function(f){switch(f.s){case 1:return h=jj(b),b.Wa=!1,b.Qc=!1,b.oc=0,b.ab=!0,b.Hb=null,b.La=null,B.debug(h,"clearing buffer"),d?(l=a.g.eb(),n=a.g.T.ha(),k=a.g.T.remove(b.type,l+d,n)):k=te(a.g.T,b.type).then(function(){if(!this.j&&c)return this.g.T.flush(b.type)}.bind(a)),v(f,k,2);case 2:if(a.j)return f["return"]();B.debug(h,"cleared buffer");b.ab=!1;b.endOfStream=!1;cj(a,b,0);w(f)}})})}
function cj(a,b,c){var d=jj(b),e=b.type;"text"!=e||a.h.has(e)?(B.O(d,"updating in "+c+" seconds"),b.Pa=(new Rb(function(){return u(function h(){var c;return y(h,function(d){switch(d.s){case 1:return Ba(d,2),v(d,qj(a,b),4);case 4:Fa(d,0);break;case 2:c=Ga(d);if(a.g)a.g.onError(c);w(d)}})})})).V(c)):B.K(d,"Text stream is unloaded. No update is needed.")}function Ti(a){null!=a.Pa&&(a.Pa.stop(),a.Pa=null)}
function Ui(a){return u(function c(){return y(c,function(c){switch(c.s){case 1:if(a.lb)return v(c,a.lb.abort(),0);c.I(0)}})})}function sj(a,b){Ub(a.M).then(function(){this.j||(this.g.onError(b),b.handled||this.l.failureCallback(b))}.bind(a))}function jj(a){return"("+a.type+":"+a.stream.id+")"};function Gj(a,b,c,d,e,f){if(200<=c&&299>=c&&202!=c)return{uri:e||d,Bd:d,data:b,headers:a,fromCache:!!a["x-shaka-from-cache"]};e=null;try{e=Jb(b)}catch(h){}B.debug("HTTP error text:",e);throw new D(401==c||403==c?2:1,1,1001,d,c,e,a,f);};function Hj(a,b,c,d){var e=new Hj.h;Bc(b.headers).forEach(function(a,b){e.append(b,a)});var f=new Hj.g,h={Zd:!1,Oe:!1};a=Hj.u(a,c,{body:b.body||void 0,headers:e,method:b.method,signal:f.signal,credentials:b.allowCrossSiteCredentials?"include":void 0},h,d);a=new J(a,function(){h.Zd=!0;f.abort();return Promise.resolve()});if(b=b.retryParameters.timeout){var k=new H(function(){h.Oe=!0;f.abort()});k.V(b/1E3);a["finally"](function(){k.stop()})}return a}A("shaka.net.HttpFetchPlugin",Hj);
Hj.u=function(a,b,c,d,e){return u(function h(){var k,l,n,p,q,r,x,C,z,F,I,R,sa,ba;return y(h,function(h){switch(h.s){case 1:return k=Hj.l,l=Hj.i,r=q=0,x=Date.now(),Ba(h,2),v(h,k(a,c),4);case 4:return n=h.B,C=n.clone().body.getReader(),F=(z=n.headers.get("Content-Length"))?parseInt(z,10):0,I=function(a){function b(){return u(function ea(){var c,d,h;return y(ea,function(k){switch(k.s){case 1:return Ba(k,2),v(k,C.read(),4);case 4:c=k.B;Fa(k,3);break;case 2:return d=Ga(k),B.K("error reading from stream",
d.message),k["return"]();case 3:c.done||(q+=c.value.byteLength);h=Date.now();if(100<h-x||c.done)e(h-x,q-r,F-q),r=q,x=h;c.done?a.close():(a.enqueue(c.value),b());w(k)}})})}b()},new l({start:I}),v(h,n.arrayBuffer(),5);case 5:p=h.B;Fa(h,3);break;case 2:R=Ga(h);if(d.Zd)throw new D(1,1,7001,a,b);if(d.Oe)throw new D(1,1,1003,a,b);throw new D(1,1,1002,a,R,b);case 3:return sa={},ba=n.headers,ba.forEach(function(a,b){sa[b.trim()]=a}),h["return"](Gj(sa,p,n.status,a,n.url,b))}})})};
Hj.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(a){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Hj.isSupported=Hj.isSupported;Hj.l=window.fetch;Hj.g=window.AbortController;Hj.i=window.ReadableStream;Hj.h=window.Headers;Hj.isSupported()&&(lc("http",Hj,2),lc("https",Hj,2));function Ij(a,b,c,d){var e=new Ij.j,f=Date.now(),h=0,k=new Promise(function(k,n){e.open(b.method,a,!0);e.responseType="arraybuffer";e.timeout=b.retryParameters.timeout;e.withCredentials=b.allowCrossSiteCredentials;e.onabort=function(){n(new D(1,1,7001,a,c))};e.onload=function(b){b=b.target;var d=b.getAllResponseHeaders().trim().split("\r\n"),e={};d=t(d);for(var f=d.next();!f.done;f=d.next())f=f.value.split(": "),e[f[0].toLowerCase()]=f.slice(1).join(": ");try{var h=Gj(e,b.response,b.status,a,b.responseURL,
c);k(h)}catch(F){n(F)}};e.onerror=function(b){n(new D(1,1,1002,a,b,c))};e.ontimeout=function(){n(new D(1,1,1003,a,c))};e.onprogress=function(a){var b=Date.now();if(100<b-f||a.lengthComputable&&a.loaded==a.total)d(b-f,a.loaded-h,a.total-a.loaded),h=a.loaded,f=b};for(var l in b.headers)e.setRequestHeader(l.toLowerCase(),b.headers[l]);e.send(b.body)});return new J(k,function(){e.abort();return Promise.resolve()})}A("shaka.net.HttpXHRPlugin",Ij);Ij.j=window.XMLHttpRequest;lc("http",Ij,1);
lc("https",Ij,1);function Jj(){this.g=this.j=this.h=0;this.i=new Map;this.l=0}function Kj(a,b){a.h+=b;var c=a.l;a.l++;a.i.set(c,b);return c}Jj.prototype.close=function(a,b){if(this.i.has(a)){var c=this.i.get(a);this.i["delete"](a);this.j+=c;this.g+=b}};function Lj(a,b,c){this.m=a;this.h=new Map;this.i=!1;this.l=b;this.j=c;this.g=new Jj}Lj.prototype.destroy=function(){this.i=!0;return Promise.all(this.h.values()).then(function(){},function(){})};
function Mj(a,b,c,d,e,f){var h=Kj(a.g,d);d=a.h.get(b)||Promise.resolve();a.h.set(b,d.then(function(){return u(function l(){var b,d,q,r,x,C;return y(l,function(l){switch(l.s){case 1:return v(l,Nj(a,c),2);case 2:b=l.B;if(a.i)throw new D(2,9,7001);if(e){d=new Uint8Array(b);q=new If(d);for(var n in q.data)r=Number(n),x=q.data[r],C=q.g[r],a.j(x,C)}a.g.close(h,b.byteLength);n=a.g;a.l(0==n.h?0:n.j/n.h,a.g.g);return l["return"](f(b))}})})}))}
function Oj(a){return u(function c(){return y(c,function(c){switch(c.s){case 1:return v(c,Promise.all(a.h.values()),2);case 2:return c["return"](a.g.g)}})})}function Nj(a,b){return u(function d(){var e,f;return y(d,function(d){switch(d.s){case 1:return e=a.m.request(1,b),v(d,e.promise,2);case 2:return f=d.B,d["return"](f.data)}})})};function Pj(a,b){var c=this;this.i=a;this.h=a.objectStore(b);this.g=new E;a.onabort=function(a){a.preventDefault();c.g.reject()};a.onerror=function(a){a.preventDefault();c.g.reject()};a.oncomplete=function(){c.g.resolve()}}Pj.prototype.abort=function(){try{this.i.abort()}catch(a){}return this.g["catch"](function(){})};
function Qj(a,b){return new Promise(function(c,d){var e=a.h.openCursor();e.onerror=d;e.onsuccess=function(a){a=a.target.result;if(!a)return c();b(a.key,a.value,a);a["continue"]()}})}Pj.prototype.store=function(){return this.h};Pj.prototype.promise=function(){return this.g};function Rj(a){this.h=a;this.g=[]}Rj.prototype.destroy=function(){return Promise.all(this.g.map(function(a){return a.abort()}))};function Sj(a,b){return Tj(a,b,"readwrite")}function Tj(a,b,c){c=a.h.transaction([b],c);var d=new Pj(c,b);a.g.push(d);d.promise().then(function(){fc(a.g,d)},function(){fc(a.g,d)});return d};function Uj(a,b,c){this.h=new Rj(a);this.i=b;this.g=c}m=Uj.prototype;m.destroy=function(){return this.h.destroy()};m.hasFixedKeySpace=function(){return!0};m.addSegments=function(){return Vj(this.i)};m.removeSegments=function(a,b){return Wj(this,this.i,a,b)};m.getSegments=function(a){var b=this;return u(function d(){var e;return y(d,function(d){switch(d.s){case 1:return v(d,Xj(b,b.i,a),2);case 2:return e=d.B,d["return"](e.map(function(a){return b.ae(a)}))}})})};m.addManifests=function(){return Vj(this.g)};
m.updateManifestExpiration=function(a,b){var c=Sj(this.h,this.g),d=c.store();d.get(a).onsuccess=function(c){if(c=c.target.result)c.expiration=b,d.put(c,a)};return c.promise()};m.removeManifests=function(a,b){return Wj(this,this.g,a,b)};m.getManifests=function(a){var b=this;return u(function d(){var e;return y(d,function(d){switch(d.s){case 1:return v(d,Xj(b,b.g,a),2);case 2:return e=d.B,d["return"](e.map(function(a){return b.pc(a)}))}})})};
m.getAllManifests=function(){var a=this;return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:return d=Tj(a.h,a.g,"readonly"),e=new Map,v(c,Qj(d,function(c,d){e.set(c,a.pc(d))}),2);case 2:return v(c,d.promise(),3);case 3:return c["return"](e)}})})};m.ae=function(a){return a};m.pc=function(a){return a};function Vj(a){return Promise.reject(new D(2,9,9011,"Cannot add new value to "+a))}
m.add=function(a,b){var c=this;return u(function e(){var f,h,k,l,n;return y(e,function(e){switch(e.s){case 1:f=Sj(c.h,a);h=f.store();k=[];for(var p=t(b),r=p.next();!r.done;r=p.next())l=r.value,n=h.add(l),n.onsuccess=function(a){k.push(a.target.result)};return v(e,f.promise(),2);case 2:return e["return"](k)}})})};
function Wj(a,b,c,d){a=Sj(a.h,b);b=a.store();var e={};c=t(c);for(var f=c.next();!f.done;e={key:e.key},f=c.next())e.key=f.value,b["delete"](e.key).onsuccess=function(a){return function(){return d(a.key)}}(e);return a.promise()}
function Xj(a,b,c){return u(function e(){var f,h,k,l,n,p,q;return y(e,function(e){switch(e.s){case 1:f=Tj(a.h,b,"readonly");h=f.store();k={};l=[];n={};p=t(c);for(q=p.next();!q.done;n={request:n.request,key:n.key},q=p.next())n.key=q.value,n.request=h.get(n.key),n.request.onsuccess=function(a){return function(){void 0==a.request.result&&l.push(a.key);k[a.key]=a.request.result}}(n);return v(e,f.promise(),2);case 2:if(l.length)throw new D(2,9,9012,"Could not find values for "+l);return e["return"](c.map(function(a){return k[a]}))}})})}
;function Yj(a){this.g=new Rj(a)}Yj.prototype.destroy=function(){return this.g.destroy()};Yj.prototype.getAll=function(){var a=this;return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:return d=Tj(a.g,"session-ids","readonly"),e=[],v(c,Qj(d,function(a,c){e.push(c)}),2);case 2:return v(c,d.promise(),3);case 3:return c["return"](e)}})})};Yj.prototype.add=function(a){var b=Sj(this.g,"session-ids"),c=b.store();a=t(a);for(var d=a.next();!d.done;d=a.next())c.add(d.value);return b.promise()};
Yj.prototype.remove=function(a){var b=this;return u(function d(){var e;return y(d,function(d){switch(d.s){case 1:return e=Sj(b.g,"session-ids"),v(d,Qj(e,function(b,d,e){0<=a.indexOf(d.sessionId)&&e["delete"]()}),2);case 2:return v(d,e.promise(),0)}})})};function Zj(){this.g=new Map}Zj.prototype.destroy=function(){for(var a=[],b=t(this.g.values()),c=b.next();!c.done;c=b.next())a.push(c.value.destroy());this.g.clear();return Promise.all(a)};Zj.prototype.init=function(){var a=this;ak.forEach(function(b,c){var d=b();d?a.g.set(c,d):B.info("Skipping "+c+" as it is not supported on this platform")});for(var b=[],c=t(this.g.values()),d=c.next();!d.done;d=c.next())b.push(d.value.init());return Promise.all(b)};
function bk(a){var b=null;a.g.forEach(function(a,d){a.getCells().forEach(function(a,c){a.hasFixedKeySpace()||b||(b={path:{Ea:d,ja:c},ja:a})})});if(b)return b;throw new D(2,9,9013,"Could not find a cell that supports add-operations");}function ck(a,b){a.g.forEach(function(a,d){a.getCells().forEach(function(a,c){b({Ea:d,ja:c},a)})})}
function dk(a,b,c){a=a.g.get(b);if(!a)throw new D(2,9,9013,"Could not find mechanism with name "+b);b=a.getCells().get(c);if(!b)throw new D(2,9,9013,"Could not find cell with name "+c);return b}function ek(a,b){a.g.forEach(function(a){b(a.getEmeSessionCell())})}function fk(a){var b=Array.from(a.g.keys());if(!b.length)throw new D(2,9,9E3,"No supported storage mechanisms found");return a.g.get(b[0]).getEmeSessionCell()}
Zj.prototype.erase=function(){var a=this;return u(function c(){var d,e,f;return y(c,function(c){switch(c.s){case 1:return d=Array.from(a.g.values()),e=0<d.length,e||(f=ak,f.forEach(function(a){(a=a())&&d.push(a)})),v(c,Promise.all(d.map(function(a){return a.erase()})),2);case 2:if(e)c.I(0);else return v(c,Promise.all(d.map(function(a){return a.destroy()})),0)}})})};function gk(a,b){ak.set(a,b)}A("shaka.offline.StorageMuxer.register",gk);A("shaka.offline.StorageMuxer.unregister",function(a){ak["delete"](a)});
var ak=new Map;function hk(a){Uj.apply(this,arguments)}xa(hk,Uj);hk.prototype.updateManifestExpiration=function(a,b){var c=Sj(this.h,this.g),d=c.store(),e=new E;d.get(a).onsuccess=function(c){(c=c.target.result)?(c.expiration=b,d.put(c),e.resolve()):e.reject(new D(2,9,9012,"Could not find values for "+a))};return c.promise().then(function(){return e})};
hk.prototype.pc=function(a){return{originalManifestUri:a.originalManifestUri,duration:a.duration,size:a.size,expiration:null==a.expiration?Infinity:a.expiration,periods:a.periods.map(ik),sessionIds:a.sessionIds,drmInfo:a.drmInfo,appMetadata:a.appMetadata}};function ik(a){jk(a);a.streams.forEach(function(){});return{startTime:a.startTime,streams:a.streams.map(kk)}}
function kk(a){var b=a.initSegmentUri?lk(a.initSegmentUri):null;return{id:a.id,originalId:null,primary:a.primary,presentationTimeOffset:a.presentationTimeOffset,contentType:a.contentType,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,pixelAspectRatio:void 0,kind:a.kind,language:a.language,label:a.label,width:a.width,height:a.height,initSegmentKey:b,encrypted:a.encrypted,keyId:a.keyId,segments:a.segments.map(mk),variantIds:a.variantIds}}
function mk(a){var b=lk(a.uri);return{startTime:a.startTime,endTime:a.endTime,dataKey:b}}hk.prototype.ae=function(a){return{data:a.data}};function lk(a){var b;if((b=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(a))||(b=/^offline:segment\/([0-9]+)$/.exec(a)))return Number(b[1]);throw new D(2,9,9004,"Could not parse uri "+a);}
function jk(a){var b=a.streams.filter(function(a){return"audio"==a.contentType}),c=a.streams.filter(function(a){return"video"==a.contentType});if(!b.every(function(a){return a.variantIds})||!c.every(function(a){return a.variantIds})){b.forEach(function(a){a.variantIds=[]});c.forEach(function(a){a.variantIds=[]});var d=0;if(c.length&&!b.length){B.debug("Found video-only content. Creating variants for video.");var e=d++;c.forEach(function(a){a.variantIds.push(e)})}if(!c.length&&b.length){B.debug("Found audio-only content. Creating variants for audio.");
var f=d++;b.forEach(function(a){a.variantIds.push(f)})}c.length&&b.length&&(B.debug("Found audio-video content. Creating variants."),b.forEach(function(a){c.forEach(function(b){var c=d++;a.variantIds.push(c);b.variantIds.push(c)})}))}};function nk(a,b,c,d){Uj.call(this,a,b,c);this.j=d}xa(nk,Uj);nk.prototype.hasFixedKeySpace=function(){return this.j};nk.prototype.addSegments=function(a){return this.j?Vj(this.i):this.add(this.i,a)};nk.prototype.addManifests=function(a){return this.j?Vj(this.g):this.add(this.g,a)};nk.prototype.pc=function(a){null==a.expiration&&(a.expiration=Infinity);return a};function ok(){this.l=this.i=this.h=this.g=this.j=null}m=ok.prototype;
m.init=function(){var a=this,b=new E,c=window.indexedDB.open("shaka_offline_db",4);c.onsuccess=function(c){c=c.target.result;a.j=c;var d=c.objectStoreNames;d.contains("manifest")&&d.contains("segment")?(B.debug("Mounting v1 idb storage cell"),d=new hk(c,"segment","manifest")):d=null;a.g=d;d=c.objectStoreNames;d.contains("manifest-v2")&&d.contains("segment-v2")?(B.debug("Mounting v2 idb storage cell"),d=new nk(c,"segment-v2","manifest-v2",!0)):d=null;a.h=d;d=c.objectStoreNames;d.contains("manifest-v3")&&
d.contains("segment-v3")?(B.debug("Mounting v3 idb storage cell"),d=new nk(c,"segment-v3","manifest-v3",!1)):d=null;a.i=d;c.objectStoreNames.contains("session-ids")?(B.debug("Mounting session ID idb storage cell"),c=new Yj(c)):c=null;a.l=c;b.resolve()};c.onupgradeneeded=function(a){a=a.target.result;for(var b=t(["segment-v3","manifest-v3","session-ids"]),c=b.next();!c.done;c=b.next())c=c.value,a.objectStoreNames.contains(c)||a.createObjectStore(c,{autoIncrement:!0})};c.onerror=function(a){b.reject(new D(2,
9,9001,c.error));a.preventDefault()};return b};m.destroy=function(){var a=this;return u(function c(){return y(c,function(c){switch(c.s){case 1:if(!a.g){c.I(2);break}return v(c,a.g.destroy(),2);case 2:if(!a.h){c.I(4);break}return v(c,a.h.destroy(),4);case 4:if(!a.i){c.I(6);break}return v(c,a.i.destroy(),6);case 6:if(!a.l){c.I(8);break}return v(c,a.l.destroy(),8);case 8:a.j&&a.j.close(),w(c)}})})};
m.getCells=function(){var a=new Map;this.g&&a.set("v1",this.g);this.h&&a.set("v2",this.h);this.i&&a.set("v3",this.i);return a};m.getEmeSessionCell=function(){return this.l};
m.erase=function(){var a=this;return u(function c(){return y(c,function(c){switch(c.s){case 1:if(!a.g){c.I(2);break}return v(c,a.g.destroy(),2);case 2:if(!a.h){c.I(4);break}return v(c,a.h.destroy(),4);case 4:if(!a.i){c.I(6);break}return v(c,a.i.destroy(),6);case 6:return a.j&&a.j.close(),v(c,pk(),8);case 8:return a.j=null,a.g=null,a.h=null,a.i=null,v(c,a.init(),0)}})})};
function pk(){var a=new E,b=window.indexedDB.deleteDatabase("shaka_offline_db");b.onblocked=function(){B.v("Deleting","shaka_offline_db","is being blocked")};b.onsuccess=function(){a.resolve()};b.onerror=function(c){a.reject(new D(2,9,9001,b.error));c.preventDefault()};return a}gk("idb",function(){return Mc("CrKey")||!window.indexedDB?null:new ok});function qk(a,b,c,d){this.g=a;this.l=b;this.j=c;this.i=d;this.h=["offline:",a,"/",b,"/",c,"/",d].join("")}qk.prototype.Ea=function(){return this.l};qk.prototype.ja=function(){return this.j};qk.prototype.key=function(){return this.i};qk.prototype.toString=function(){return this.h};
function rk(a){a=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(a);if(null==a)return null;var b=a[1];if("manifest"!=b&&"segment"!=b)return null;var c=a[2];if(!c)return null;var d=a[3];return d&&null!=b?new qk(b,c,d,Number(a[4])):null};function sk(a,b){this.h=a;this.g=b}function tk(a,b){var c=new X(null,0);c.Fa(b.duration);var d=b.periods.map(function(b){return uk(a,b,c)}),e=b.drmInfo?[b.drmInfo]:[];b.drmInfo&&d.forEach(function(a){a.variants.forEach(function(a){a.drmInfos=e})});return{presentationTimeline:c,minBufferTime:2,offlineSessionIds:b.sessionIds,periods:d}}
function uk(a,b,c){var d=b.streams.filter(function(a){return"audio"==a.contentType}),e=b.streams.filter(function(a){return"video"==a.contentType});d=vk(a,d,e);e=b.streams.filter(function(a){return"text"==a.contentType}).map(function(b){return wk(a,b)});b.streams.forEach(function(d){d=d.segments.map(function(b,c){return xk(a,c,b)});c.Jb(d,b.startTime)});return{startTime:b.startTime,variants:Array.from(d.values()),textStreams:e}}
function vk(a,b,c){for(var d=new Set,e=t(b),f=e.next();!f.done;f=e.next()){var h=t(f.value.variantIds);for(f=h.next();!f.done;f=h.next())d.add(f.value)}e=t(c);for(f=e.next();!f.done;f=e.next())for(h=t(f.value.variantIds),f=h.next();!f.done;f=h.next())d.add(f.value);e=new Map;d=t(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f,{id:f,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});b=t(b);for(d=b.next();!d.done;d=b.next())for(d=
d.value,f=wk(a,d),h=t(d.variantIds),d=h.next();!d.done;d=h.next())d=e.get(d.value),d.language=f.language,d.primary=d.primary||f.primary,d.audio=f;c=t(c);for(b=c.next();!b.done;b=c.next())for(d=b.value,b=wk(a,d),f=t(d.variantIds),d=f.next();!d.done;d=f.next())d=e.get(d.value),d.primary=d.primary||b.primary,d.video=b;return e}
function wk(a,b){var c=b.segments.map(function(b,c){return xk(a,c,b)}),d=new bg(c);c={id:b.id,originalId:b.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(a){return d.find(a)},getSegmentReference:function(a){return d.get(a)},initSegmentReference:null,presentationTimeOffset:b.presentationTimeOffset,mimeType:b.mimeType,codecs:b.codecs,width:b.width||void 0,height:b.height||void 0,frameRate:b.frameRate||void 0,pixelAspectRatio:b.pixelAspectRatio||void 0,
kind:b.kind,encrypted:b.encrypted,keyId:b.keyId,language:b.language,label:b.label||null,type:b.contentType,primary:b.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null};null!=b.initSegmentKey&&(c.initSegmentReference=yk(a,b.initSegmentKey));return c}function xk(a,b,c){var d=new qk("segment",a.h,a.g,c.dataKey);return new V(b,c.startTime,c.endTime,function(){return[d.toString()]},0,null)}
function yk(a,b){var c=new qk("segment",a.h,a.g,b);return new Zf(function(){return[c.toString()]},0,null)};function zk(){this.g=null}m=zk.prototype;m.configure=function(){};
m.start=function(a){var b=this;return u(function d(){var e,f,h,k,l,n;return y(d,function(d){switch(d.s){case 1:e=rk(a);b.g=e;if(null==e||"manifest"!=e.g)return d["return"](Promise.reject(new D(2,1,9004,e)));f=new Zj;Ca(d,2);return v(d,f.init(),4);case 4:return v(d,dk(f,e.Ea(),e.ja()),5);case 5:return h=d.B,v(d,h.getManifests([e.key()]),6);case 6:return k=d.B,l=k[0],n=new sk(e.Ea(),e.ja()),d["return"](tk(n,l));case 2:return Ha(d),v(d,f.destroy(),7);case 7:La(d,0)}})})};m.stop=function(){return Promise.resolve()};
m.update=function(){};
m.onExpirationUpdated=function(a,b){var c=this;return u(function e(){var f,h,k,l,n,p,q,r;return y(e,function(e){switch(e.s){case 1:return f=c.g,h=new Zj,Ba(e,2,3),v(e,h.init(),5);case 5:return v(e,dk(h,f.Ea(),f.ja()),6);case 6:return k=e.B,v(e,k.getManifests([f.key()]),7);case 7:l=e.B;n=l[0];p=n.sessionIds.includes(a);q=void 0==n.expiration||n.expiration>b;if(!p||!q){e.I(3);break}B.debug("Updating expiration for stored content");return v(e,k.updateManifestExpiration(f.key(),b),3);case 3:return Ha(e),
v(e,h.destroy(),10);case 10:La(e,0);break;case 2:r=Ga(e),B.error("There was an error updating",f,r),e.I(3)}})})};W.Qb("application/x-offline-manifest",zk);function Ak(a){var b=rk(a);return b&&"manifest"==b.g?Ak.m(a):b&&"segment"==b.g?Ak.o(b.key(),b):Vb(new D(2,1,9004,a))}A("shaka.offline.OfflineScheme",Ak);Ak.m=function(a){a={uri:a,Bd:a,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}};return Xb(a)};
Ak.o=function(a,b){var c=new Zj;return Xb(void 0).ca(function(){return c.init()}).ca(function(){return dk(c,b.Ea(),b.ja())}).ca(function(a){return a.getSegments([b.key()])}).ca(function(a){return{uri:b,Bd:b,data:a[0].data,headers:{}}})["finally"](function(){return c.destroy()})};lc("offline",Ak);function Bk(a,b,c){return u(function e(){var f,h,k,l,n,p;return y(e,function(e){switch(e.s){case 1:f=[];for(var q=[],x=t(c),C=x.next();!C.done;C=x.next()){C=C.value;for(var z=!1,F=t(q),I=F.next();!I.done;I=F.next())if(I=I.value,Ck(I.info,C)){I.sessionIds.push(C.sessionId);z=!0;break}z||q.push({info:C,sessionIds:[C.sessionId]})}h=t(q);k=h.next();case 2:if(k.done){e.I(4);break}l=k.value;n=Dk(a,b,l);return v(e,n,5);case 5:p=e.B;f=f.concat(p);k=h.next();e.I(2);break;case 4:return e["return"](f)}})})}
function Dk(a,b,c){return u(function e(){var f,h,k,l;return y(e,function(e){switch(e.s){case 1:return f=new Rc({Ib:b,onError:function(){},Dc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Ba(e,2),f.configure(a),v(e,Zc(f,c.info.keySystem,c.info.licenseUri,c.info.serverCertificate,c.info.audioCapabilities,c.info.videoCapabilities),4);case 4:Fa(e,3);break;case 2:return h=Ga(e),B.v("Error initializing EME",h),v(e,f.destroy(),5);case 5:return e["return"]([]);case 3:return Ba(e,6),
v(e,fd(f),8);case 8:Fa(e,7);break;case 6:return k=Ga(e),B.v("Error setting server certificate",k),v(e,f.destroy(),9);case 9:return e["return"]([]);case 7:return l=[],v(e,Promise.all(c.sessionIds.map(function(a){return u(function r(){var b;return y(r,function(c){switch(c.s){case 1:return Ba(c,2),v(c,id(f,a),4);case 4:l.push(a);Fa(c,0);break;case 2:b=Ga(c),B.v("Error deleting offline session",b),w(c)}})})})),10);case 10:return v(e,f.destroy(),11);case 11:return e["return"](l)}})})}
function Ck(a,b){function c(a,b){return a.robustness==b.robustness&&a.contentType==b.contentType}return a.keySystem==b.keySystem&&a.licenseUri==b.licenseUri&&hc(a.audioCapabilities,b.audioCapabilities,c)&&hc(a.videoCapabilities,b.videoCapabilities,c)};function Ek(a,b){var c=Fk(),d=this;this.m=b;this.i=a;this.j=c;this.o=null;this.l=[];this.h=this.g=null;this.u=!0;this.A=Promise.resolve().then(function(){return Gk(d)})}Ek.prototype.destroy=function(){var a=this;return u(function c(){var d;return y(c,function(c){switch(c.s){case 1:return a.u=!1,a.h&&a.h.abort(),Hk(a),v(c,a.A,2);case 2:a.g&&a.g.Da.kb();for(var e=t(a.l),h=e.next();!h.done;h=e.next())d=h.value,d.Da.kb();a.g=null;a.l=[];a.m=null;w(c)}})})};
function Ik(a,b){var c={Kb:function(){},Cc:function(){},kb:function(){},onError:function(){},Ec:function(){},$g:function(){}};a.l.push({create:b,Da:c});a.h&&a.h.abort();Hk(a);return c}
function Gk(a){return u(function c(){return y(c,function(c){switch(c.s){case 1:if(a.u){if(0==a.l.length||a.g&&!a.g.gb)var d=!1;else{a.g&&(a.g.Da.kb(),a.g=null);d=a.l.shift();var f=d.create(a.j);f?(d.Da.Kb(),a.g={node:f.node,payload:f.payload,gb:f.gb,Da:d.Da}):d.Da.Ec();d=!0}d?d=Promise.resolve():a.g?d=Jk(a):(a.m.Xf(a.i),a.o=new E,d=a.o);return v(c,d,1)}c.I(0)}})})}
function Jk(a){return u(function c(){var d,e;return y(c,function(c){switch(c.s){case 1:return a.i=a.m.Af(a.i,a.j,a.g.node,a.g.payload),Ba(c,2),a.h=a.m.ef(a.i,a.j,a.g.payload),v(c,a.h.promise,4);case 4:a.h=null;a.i==a.g.node&&(a.g.Da.Cc(),a.g=null);Fa(c,0);break;case 2:d=Ga(c);if(7001==d.code)a.g.Da.kb();else a.g.Da.onError(d);a.g=null;a.h=null;e=a;return v(c,a.m.handleError(a.j,d),5);case 5:e.i=c.B,w(c)}})})}function Hk(a){a.o&&(a.o.resolve(),a.o=null)};function Kk(a){this.g=null;for(var b=0;b<a.textTracks.length;++b){var c=a.textTracks[b];c.mode="disabled";"Shaka Player TextTrack"==c.label&&(this.g=c)}this.g||(this.g=a.addTextTrack("subtitles","Shaka Player TextTrack"));this.g.mode="hidden"}A("shaka.text.SimpleTextDisplayer",Kk);Kk.prototype.remove=function(a,b){if(!this.g)return!1;Lk(this.g,function(c){return c.startTime<b&&c.endTime>a});return!0};Kk.prototype.remove=Kk.prototype.remove;
Kk.prototype.append=function(a){var b=Mk,c=a.map(function(a){if(a.nestedCues.length){var b=a.nestedCues.map(function(a){return a.spacer?"\n":a.payload+" "}).join("").replace(/ $/m,"");a=a.clone();a.nestedCues=[];a.payload=b}return a}),d=[];a=this.g.cues?Array.from(this.g.cues):[];var e={};c=t(c);for(var f=c.next();!f.done;e={Fb:e.Fb},f=c.next())e.Fb=f.value,a.some(function(a){return function(b){return b.startTime==a.Fb.startTime&&b.endTime==a.Fb.endTime&&b.text==a.Fb.payload?!0:!1}}(e))||(f=b(e.Fb))&&
d.push(f);d.slice().sort(function(a,b){return a.startTime!=b.startTime?a.startTime-b.startTime:a.endTime!=b.endTime?a.endTime-b.startTime:"line"in VTTCue.prototype?d.indexOf(b)-d.indexOf(a):d.indexOf(a)-d.indexOf(b)}).forEach(function(a){this.g.addCue(a)}.bind(this))};Kk.prototype.append=Kk.prototype.append;Kk.prototype.destroy=function(){this.g&&Lk(this.g,function(){return!0});this.g=null;return Promise.resolve()};Kk.prototype.destroy=Kk.prototype.destroy;
Kk.prototype.isTextVisible=function(){return"showing"==this.g.mode};Kk.prototype.isTextVisible=Kk.prototype.isTextVisible;Kk.prototype.setTextVisibility=function(a){this.g.mode=a?"showing":"hidden"};Kk.prototype.setTextVisibility=Kk.prototype.setTextVisibility;
function Mk(a){if(a.startTime>=a.endTime)return B.v("Invalid cue times: "+a.startTime+" - "+a.endTime),null;var b=new VTTCue(a.startTime,a.endTime,a.payload);b.lineAlign=a.lineAlign;b.positionAlign=a.positionAlign;a.size&&(b.size=a.size);try{b.align=a.textAlign}catch(c){}"center"==a.textAlign&&"center"!=b.align&&(b.align="middle");"vertical-lr"==a.writingMode?b.vertical="lr":"vertical-rl"==a.writingMode&&(b.vertical="rl");1==a.lineInterpretation&&(b.snapToLines=!1);null!=a.line&&(b.line=a.line);null!=
a.position&&(b.position=a.position);return b}function Lk(a,b){var c=a.mode;a.mode="showing"==c?"showing":"hidden";for(var d=a.cues,e=d.length-1;0<=e;e--){var f=d[e];f&&b(f)&&a.removeCue(f)}a.mode=c};function Nk(a,b,c,d,e){var f=e in d,h=!0,k;for(k in b){var l=e+"."+k,n=f?d[e]:c[k];f||k in c?void 0===b[k]?void 0===n||f?delete a[k]:a[k]=cc(n):n.constructor==Object&&b[k]&&b[k].constructor==Object?(a[k]||(a[k]=cc(n)),l=Nk(a[k],b[k],n,d,l),h=h&&l):typeof b[k]!=typeof n||null==b[k]||"function"!=typeof b[k]&&b[k].constructor!=n.constructor?(B.kc("Invalid config, wrong type for "+l),h=!1):("function"==typeof c[k]&&c[k].length!=b[k].length&&B.ba("Unexpected number of arguments for "+l),a[k]=b[k]):(B.kc("Invalid config, unrecognized key "+
l),h=!1)}return h}A("shaka.util.ConfigUtils.mergeConfigObjects",Nk);function Ok(a,b){for(var c={},d=c,e=0,f=0;;){e=a.indexOf(".",e);if(0>e)break;if(0==e||"\\"!=a[e-1])f=a.substring(f,e).replace(/\\\./g,"."),d[f]={},d=d[f],f=e+1;e+=1}d[a.substring(f).replace(/\\\./g,".")]=b;return c}A("shaka.util.ConfigUtils.convertToConfigObject",Ok);function Pk(){}A("shaka.util.PlayerConfiguration",Pk);
function Qk(){var a=5E5,b=Infinity;navigator.connection&&(navigator.connection.downlink&&(a=1E6*navigator.connection.downlink),navigator.connection.saveData&&(b=360));var c={retryParameters:Tb(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:rd,fairPlayTransform:!0,updateExpirationTime:1},d={retryParameters:Tb(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(a){if(a)return null},clockSyncUri:"",ignoreDrmInfo:!1,
xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},e={retryParameters:Tb(),failureCallback:function(a){B.error("Unhandled streaming error",a);return[a]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,
forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};if(Mc("Web0S")||Lc()||Mc("CrKey"))e.stallSkip=0;var f={trackSelectionCallback:function(a){return u(function n(){return y(n,function(b){switch(b.s){case 1:return b["return"](a)}})})},progressCallback:function(a,b){return[a,b]},usePersistentLicense:!0},h={drm:c,manifest:d,streaming:e,offline:f,abrFactory:P,abr:{enabled:!0,defaultBandwidthEstimate:a,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,
restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:b,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},playRangeStart:0,playRangeEnd:Infinity,
textDisplayFactory:function(){return null}};f.trackSelectionCallback=function(a){return u(function n(){return y(n,function(b){switch(b.s){case 1:return b["return"](Rk(a,h.preferredAudioLanguage))}})})};return h}function Sk(a,b,c){var d={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Nk(a,b,c||Qk(),d,"")}
Pk.mergeConfigObjects=Sk;
function Rk(a,b){var c=a.filter(function(a){return"variant"==a.type}),d=[],e=Be(b,c.map(function(a){return a.language}));e&&(d=c.filter(function(a){return N(a.language)==e}));0==d.length&&(d=c.filter(function(a){return a.primary}));0==d.length&&(1<(new Set(c.map(function(a){return a.language}))).size&&B.v("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),d=c);var f=d.filter(function(a){return a.height&&480>=a.height});f.length&&
(f.sort(function(a,b){return b.height-a.height}),d=f.filter(function(a){return a.height==f[0].height}));c=[];if(d.length){var h=Math.floor(d.length/2);d.sort(function(a,b){return a.bandwidth-b.bandwidth});c.push(d[h])}d=t(a);for(h=d.next();!h.done;h=d.next())h=h.value,"text"==h.type&&c.push(h);return c};function Tk(){this.g=null;this.h=[]}function Uk(a,b){if(null==a.g)a.g={timestamp:Date.now()/1E3,state:b,duration:0};else{var c=Date.now()/1E3;a.g.duration=c-a.g.timestamp;a.g.state!=b&&(a.h.push(a.g),a.g={timestamp:c,state:b,duration:0})}}function Vk(a,b){var c=0;a.g&&a.g.state==b&&(c+=a.g.duration);for(var d=t(a.h),e=d.next();!e.done;e=d.next())e=e.value,c+=e.state==b?e.duration:0;return c}
function Wk(a){function b(a){return{timestamp:a.timestamp,state:a.state,duration:a.duration}}for(var c=[],d=t(a.h),e=d.next();!e.done;e=d.next())c.push(b(e.value));a.g&&c.push(b(a.g));return c};function Xk(){this.h=this.i=null;this.g=[]};function Yk(){this.j=this.C=this.m=this.h=this.o=this.u=this.A=this.l=this.F=NaN;this.g=new Tk;this.i=new Xk};function Y(a,b){var c=this;bc.call(this);this.o=Zk;this.g=null;this.ub=!1;this.l=new M;this.Uc=this.u=this.Tb=this.i=this.C=this.j=this.rc=this.L=this.ic=this.J=this.wb=this.A=this.M=this.m=this.X=null;this.re=1E9;this.lc=new Set;this.yb=!0;this.wa=null;this.qe=!1;this.oe=0;this.va=null;this.Z=new Rh;this.h=$k(this);this.mc={width:Infinity,height:Infinity};this.F=null;this.tb=new $h(this.h.preferredAudioLanguage,this.h.preferredVariantRole,this.h.preferredAudioChannelCount);this.ua=this.h.preferredTextLanguage;
this.Xa=this.h.preferredTextRole;this.Wc=[];b&&b(this);this.X=al(this);this.l.H(window,"online",function(){c.Id()});this.P={name:"detach"};this.da={name:"attach"};this.Qa={name:"unload"};this.nd={name:"manifest-parser"};this.md={name:"manifest"};this.vb={name:"media-source"};this.ad={name:"drm-engine"};this.ea={name:"load"};this.od={name:"src-equals-drm-engine"};this.xb={name:"src-equals"};var d=new Map;d.set(this.da,function(a,b){return Yb(bl(c,a,b))});d.set(this.P,function(a){a.D&&(c.l.ta(a.D,"error"),
a.D=null);c.g=null;a=Promise.resolve();return Yb(a)});d.set(this.Qa,function(a){return Yb(cl(c,a))});d.set(this.vb,function(a){a=dl(c,a);return Yb(a)});d.set(this.nd,function(a,b){var d=el(c,a,b);return Yb(d)});d.set(this.md,function(a){return fl(c,a)});d.set(this.ad,function(a){a=gl(c,a);return Yb(a)});d.set(this.ea,function(a,b){return Yb(hl(c,a,b))});d.set(this.od,function(a,b){var d=il(c,a,b);return Yb(d)});d.set(this.xb,function(a,b){return jl(c,a,b)});this.Ya=new Ek(this.P,{Af:function(a,b,
d,k){var e=null;a==c.P&&(e=d==c.P?c.P:c.da);a==c.da&&(e=d==c.P||b.D!=k.D?c.P:d==c.da?c.da:d==c.vb||d==c.ea?c.vb:d==c.xb?c.od:null);a==c.vb&&(e=d==c.ea&&b.D==k.D?c.nd:c.Qa);a==c.nd&&(e=kl(c.ea,c.md,c.Qa,d,b,k));a==c.md&&(e=kl(c.ea,c.ad,c.Qa,d,b,k));a==c.ad&&(e=kl(c.ea,c.ea,c.Qa,d,b,k));a==c.od&&(e=d==c.xb&&b.D==k.D?c.xb:c.Qa);if(a==c.ea||a==c.xb)e=c.Qa;a==c.Qa&&(e=k.D&&b.D==k.D?c.da:c.P);return e},ef:function(a,b,h){c.dispatchEvent(new K("onstatechange",{state:a.name}));return d.get(a)(b,h)},handleError:function(a,
b){return u(function k(){return y(k,function(d){switch(d.s){case 1:return B.v("The walker saw an error:"),b instanceof D?B.v("Error Code:",b.code):(B.v("Error Message:",b.message),B.v("Error Stack:",b.stack)),v(d,cl(c,a),2);case 2:return d["return"](a.D?c.da:c.P)}})})},Xf:function(a){c.dispatchEvent(new K("onstateidle",{state:a.name}))}});a&&this.Ub(a,!0)}bb(Y,bc);A("shaka.Player",Y);
Y.prototype.destroy=function(){var a=this;return u(function c(){var d;return y(c,function(c){switch(c.s){case 1:if(a.o==ll)return c["return"]();a.o=ll;d=Ik(a.Ya,function(){return{node:a.P,payload:Fk(),gb:!1}});return v(c,new Promise(function(c){d.Kb=function(){B.info("Preparing to destroy walker...")};d.Cc=function(){c();a.dispatchEvent(new K("loaded"))};d.kb=function(){c()};d.onError=function(){c()};d.Ec=function(){c()}}),2);case 2:return v(c,a.Ya.destroy(),3);case 3:a.l&&(a.l.release(),a.l=null);
a.Uc=null;a.u=null;a.h=null;if(!a.X){c.I(0);break}return v(c,a.X.destroy(),5);case 5:a.X=null,w(c)}})})};Y.prototype.destroy=Y.prototype.destroy;Y.version="v2.5.23";var ml=["2","5"];Fe=new function(a){this.g=a;this.i=Ge;this.h=He}(new De(Number(ml[0]),Number(ml[1])));var nl=["output-restricted","internal-error"],ol={};Y.registerSupportPlugin=function(a,b){ol[a]=b};
Y.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var a=Oc();return a&&12>a||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:Ic()?!0:Jc("application/x-mpegurl")};
Y.probeSupport=function(){return xd().then(function(a){for(var b=W.ng(),c={},d=t('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),e=
d.next();!e.done;e=d.next()){e=e.value;c[e]=Ic()?be(e)?!0:MediaSource.isTypeSupported(e)||Ob(e):Jc(e);var f=e.split(";")[0];c[f]=c[f]||c[e]}a={manifest:b,media:c,drm:a};for(var h in ol)a[h]=ol[h]();return a})};Y.prototype.Ub=function(a,b){b=void 0===b?!0:b;if(this.o==ll)return Promise.reject(pl());var c=Fk();c.D=a;Ic()||(b=!1);var d=b?this.vb:this.da,e=Ik(this.Ya,function(){return{node:d,payload:c,gb:!1}});e.Kb=function(){return B.info("Starting attach...")};return ql(e)};Y.prototype.attach=Y.prototype.Ub;
Y.prototype.detach=function(){var a=this;if(this.o==ll)return Promise.reject(pl());var b=Ik(this.Ya,function(){return{node:a.P,payload:Fk(),gb:!1}});b.Kb=function(){return B.info("Starting detach...")};return ql(b)};Y.prototype.detach=Y.prototype.detach;
Y.prototype.Ud=function(a){var b=this;a=void 0===a?!0:a;if(this.o==ll)return Promise.reject(pl());Ic()||(a=!1);var c=Fk(),d=Ik(this.Ya,function(d){var e=d.D&&a?b.vb:d.D?b.da:b.P;c.D=d.D;return{node:e,payload:c,gb:!1}});d.Kb=function(){return B.info("Starting unload...")};return ql(d)};Y.prototype.unload=Y.prototype.Ud;
Y.prototype.load=function(a,b,c){if(this.o==ll)return Promise.reject(pl());this.dispatchEvent(new K("loading"));var d=Fk();d.uri=a;d.Rd=Date.now()/1E3;c&&"string"!=typeof c&&(Ee("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),d.Ia=function(){return new c});c&&"string"==typeof c&&(d.mimeType=c);void 0!==b&&(d.startTime=b);var e=rl(this,d)?this.xb:this.ea,f=Ik(this.Ya,function(a){if(null==a.D)return null;d.D=a.D;return{node:e,payload:d,gb:!0}});f.Kb=
function(){return B.info("Starting load of "+a+"...")};return new Promise(function(a,b){f.Ec=function(){return b(new D(2,7,7002))};f.Cc=function(){return a()};f.kb=function(){return b(pl())};f.onError=function(a){return b(a)}})};Y.prototype.load=Y.prototype.load;
function rl(a,b){if(b.Ia)return!1;if(!Ic())return!0;var c=b.mimeType,d=b.uri||"";c||(c={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[W.getExtension(d)]);return c?""==(b.D||Kc()).canPlayType(c)?!1:W.isSupported(d,c)?Nc()&&a.h.streaming.useNativeHlsOnSafari:!0:!1}
function bl(a,b,c){null==b.D&&(b.D=c.D,a.l.H(b.D,"error",function(){var b=sl(a);b&&a.Va(b)}));a.g=b.D;return Promise.resolve()}
function cl(a,b){return u(function d(){var e;return y(d,function(d){switch(d.s){case 1:return a.o!=ll&&(a.o=Zk),e=a.Wc.map(function(a){return a()}),a.Wc=[],v(d,Promise.all(e),2);case 2:a.dispatchEvent(new K("unloading"));b.Ia=null;b.mimeType=null;b.startTime=null;b.uri=null;b.D&&(a.l.ta(b.D,"loadedmetadata"),a.l.ta(b.D,"playing"),a.l.ta(b.D,"pause"),a.l.ta(b.D,"ended"),a.l.ta(b.D,"ratechange"));a.wb&&(a.wb.release(),a.wb=null);a.ic&&(a.ic.stop(),a.ic=null);if(!a.C){d.I(3);break}return v(d,a.C.stop(),
4);case 4:a.C=null;case 3:if(!a.u){d.I(5);break}return v(d,a.u.stop(),5);case 5:if(!a.j){d.I(7);break}return v(d,a.j.destroy(),8);case 8:a.j=null;case 7:a.J&&(a.J.release(),a.J=null);a.A&&(a.A.release(),a.A=null);if(!a.M){d.I(9);break}return v(d,a.M.destroy(),10);case 10:a.M=null;case 9:if(!b.D||!b.D.src){d.I(11);break}return v(d,new Promise(function(a){return(new H(a)).V(.1)}),12);case 12:b.D.removeAttribute("src"),b.D.load();case 11:if(!a.m){d.I(13);break}return v(d,a.m.destroy(),14);case 14:a.m=
null;case 13:a.Z.g.clear(),a.Tb=null,a.L=null,a.lc.clear(),a.i=null,a.F=null,a.fd=null,a.yb=!0,tl(a),w(d)}})})}function dl(a,b){return u(function d(){var e,f,h,k;return y(d,function(d){switch(d.s){case 1:return e=window.muxjs?new Cd:new Dd,f=a.h.textDisplayFactory,h=new f,a.fd=f,k=new ge(b.D,e,h),v(d,k.C,2);case 2:a.M=k,w(d)}})})}
function el(a,b,c){return u(function e(){var f,h,k,l;return y(e,function(e){switch(e.s){case 1:b.Ia=c.Ia;b.mimeType=c.mimeType;b.uri=c.uri;f=b.uri;h=a.X;a.Tb=f;if(b.Ia){a.C=b.Ia();e.I(2);break}k=a;return v(e,W.create(f,h,a.h.manifest.retryParameters,b.mimeType),3);case 3:k.C=e.B;case 2:l=cc(a.h.manifest),c.D&&"AUDIO"===c.D.nodeName&&(l.disableVideo=!0),a.C.configure(l),w(e)}})})}
function fl(a,b){var c=b.uri,d=a.X;a.rc=new Li(function(){return a.He()});Mi(a.rc,function(b){ul(a,"timelineregionadded",b)});var e={networkingEngine:d,filterNewPeriod:function(b){return a.Xc(b)},filterAllPeriods:function(b){return vl(a,b)},onTimelineRegionAdded:function(b){var c=a.rc;a:{var d=t(c.g);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.schemeIdUri==b.schemeIdUri&&e.id==b.id&&e.startTime==b.startTime&&e.endTime==b.endTime){d=e;break a}d=null}null==d&&(c.g.add(b),c.h(b))},onEvent:function(b){return a.dispatchEvent(b)},
onError:function(b){return a.Va(b)}};return new J(Promise.resolve().then(function(){return u(function h(){var b;return y(h,function(d){switch(d.s){case 1:return b=a,v(d,a.C.start(c,e),2);case 2:b.i=d.B;a.dispatchEvent(new K("manifestparsed"));if(0==a.i.periods.length)throw new D(2,4,4014);wl(a.i.periods);w(d)}})})}),function(){B.info("Aborting parser step...");return a.C.stop()})}
function gl(a,b){return u(function d(){return y(d,function(d){switch(d.s){case 1:return a.m=xl(a,{Ib:a.X,onError:function(b){a.Va(b)},Dc:function(b){yl(a,b)},onExpirationUpdated:function(b,d){zl(a,b,d)},onEvent:function(b){a.dispatchEvent(b)}}),a.m.configure(a.h.drm),v(d,Yc(a.m,pi(a.i.periods),a.i.offlineSessionIds),2);case 2:return v(d,a.m.Ub(b.D),3);case 3:vl(a,a.i.periods),w(d)}})})}
function hl(a,b,c){return u(function e(){var f,h,k,l,n,p,q,r,x,C;return y(e,function(e){switch(e.s){case 1:return b.startTime=c.startTime,f=b.D,h=b.uri,a.Tb=h,a.J=new ti({wc:function(){return b.D.playbackRate},vc:function(){return b.D.defaultPlaybackRate},Od:function(a){b.D.playbackRate=a},pe:function(a){b.D.currentTime+=a}}),a.F=new Yk,k=function(){return Al(a)},l=function(){return Bl(a)},a.l.H(f,"playing",k),a.l.H(f,"pause",k),a.l.H(f,"ended",k),a.l.H(f,"ratechange",l),n=a.h.abrFactory,a.u&&a.Uc==
n||(a.Uc=n,a.u=new n,a.u.configure(a.h.abr)),Cl(a,a.i.periods),a.tb=new $h(a.h.preferredAudioLanguage,a.h.preferredVariantRole,a.h.preferredAudioChannelCount),a.ua=a.h.preferredTextLanguage,a.Xa=a.h.preferredTextRole,Dl(a.i.presentationTimeline,a.h.playRangeStart,a.h.playRangeEnd),a.u.init(function(b,c,e){c=void 0===c?!1:c;e=void 0===e?0:e;B.debug("switch_");a:{var f=t(a.i.periods);for(var h=f.next();!h.done;h=f.next())if(h=h.value,h.variants.includes(b)){f=h;break a}f=null}El(a,f,b,!0);a.j&&gj(a.j,
b,c,e)&&Fl(a)}),a.A=Gl(a,b.startTime),a.wb=Hl(a),p=Math.max(a.i.minBufferTime,a.h.streaming.rebufferingGoal),Il(a,p),a.j=Jl(a),a.j.configure(a.h.streaming),O.$d(a.i,a.h.preferredAudioChannelCount),a.o=Kl,a.dispatchEvent(new K("streaming")),v(e,a.j.start(),2);case 2:a.h.streaming.startAtSegmentBoundary&&(q=a.A.l(),r=Ll(a,q),a.A.A(r)),a.i.periods.forEach(a.Xc.bind(a)),Ml(a),Fl(a),x=Nl(a)||a.i.periods[0],C=x.variants.some(function(a){return a.primary}),a.h.preferredAudioLanguage||C||B.v("No preferred audio language set.  We will choose an arbitrary language initially"),
Ol(a,x.variants),a.l.ya(f,"loadedmetadata",function(){a.F.h=Date.now()/1E3-c.Rd}),w(e)}})})}
function il(a,b,c){return u(function e(){var f,h;return y(e,function(e){switch(e.s){case 1:return f=Ab,a.m=xl(a,{Ib:a.X,onError:function(b){a.Va(b)},Dc:function(b){yl(a,b)},onExpirationUpdated:function(b,c){zl(a,b,c)},onEvent:function(b){a.dispatchEvent(b)}}),a.m.configure(a.h.drm),h={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:c.mimeType?c.mimeType.split(";")[0]:"video/mp4",codecs:c.mimeType?Gc(c.mimeType):"",encrypted:!0,keyId:null,language:"und",label:null,type:f.Za,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(e,Yc(a.m,[h],[]),2);case 2:return v(e,a.m.Ub(b.D),0)}})})}
function jl(a,b,c){function d(){return Al(a)}b.uri=c.uri;b.startTime=c.startTime;a.Tb=b.uri;a.F=new Yk;a.A=new Ei(b.D);null!=b.startTime&&a.A.A(b.startTime);a.J=new ti({wc:function(){return b.D.playbackRate},vc:function(){return b.D.defaultPlaybackRate},Od:function(a){b.D.playbackRate=a},pe:function(a){b.D.currentTime+=a}});Il(a,a.h.streaming.rebufferingGoal);a.l.H(b.D,"playing",d);a.l.H(b.D,"pause",d);a.l.H(b.D,"ended",d);a.l.H(b.D,"ratechange",function(){return Bl(a)});"none"!=a.g.preload&&a.l.ya(b.D,
"loadedmetadata",function(){a.F.h=Date.now()/1E3-c.Rd});a.g.audioTracks&&(a.l.H(a.g.audioTracks,"addtrack",function(){return Ml(a)}),a.l.H(a.g.audioTracks,"removetrack",function(){return Ml(a)}),a.l.H(a.g.audioTracks,"change",function(){return Ml(a)}));if(a.g.textTracks){var e=a.g.textTracks;a.l.H(e,"addtrack",function(){return Ml(a)});a.l.H(e,"removetrack",function(){return Ml(a)});a.l.H(e,"change",function(){return Ml(a)})}b.D.src=b.uri;(Lc()||Mc("Web0S"))&&b.D.load();a.o=Pl;a.dispatchEvent(new K("streaming"));
var f=new E;vi(a.g,HTMLMediaElement.HAVE_METADATA,a.l,function(){f.resolve()});var h=!1;a.Wc.push(function(){h=!0});vi(a.g,HTMLMediaElement.HAVE_CURRENT_DATA,a.l,function(){return u(function l(){var b;return y(l,function(c){switch(c.s){case 1:if(h)return c["return"]();Ql(a);b=Rl(a);if(b.find(function(a){return"disabled"!=a.mode})){c.I(2);break}return v(c,new Promise(function(b){a.l.ya(a.g.textTracks,"change",b);(new H(b)).V(1)}),2);case 2:if(h)return c["return"]();Sl(a);w(c)}})})});a.g.error?f.reject(sl(a)):
"none"==a.g.preload&&(B.ba('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),f.resolve());a.l.ya(a.g,"error",function(){f.reject(sl(a))});return new J(f,function(){f.reject(new D(2,7,7001));return Promise.resolve()})}
function Ql(a){var b=a.h.preferredAudioLanguage;if(""!=b){a.Jd(b);var c=a.h.preferredVariantRole;""!=c&&a.Jd(b,c)}}function Sl(a){var b=a.h.preferredTextLanguage;if(""!=b){a.Kd(b);var c=a.h.preferredTextRole;""!=c&&a.Kd(b,c)}}
function wl(a){function b(a){return a.video&&a.audio||a.video&&a.video.codecs.includes(",")}a.some(function(a){return a.variants.some(b)})&&(B.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),a.forEach(function(a){a.variants=a.variants.filter(b)}))}function xl(a,b){return new Rc(b,a.h.drm.updateExpirationTime)}function al(a){return new L(function(b,c){a.u&&a.u.segmentDownloaded(b,c)})}
function Gl(a,b){return new Fi(a.g,a.i,a.h.streaming,b,function(){a.wb&&oi(a.wb,!0);a.j&&nj(a.j);a.L&&Tl(a)},function(b){return a.dispatchEvent(b)})}function Hl(a){var b=new ri(a.i);si(b,function(){Ml(a)});var c=new Ni(a.rc);Ri(c,function(b){ul(a,"timelineregionenter",b)},function(b){ul(a,"timelineregionexit",b)},function(b,c){c||(ul(a,"timelineregionenter",b),ul(a,"timelineregionexit",b))});var d=new ni(a.g);d.g.add(b);d.g.add(c);return d}
function Il(a,b){a.L=new di;a.L.g=fi;gi(a.L,b,Math.min(.5,b/2));tl(a);a.ic=(new H(function(){Tl(a)})).Oa(.25)}function Tl(a){switch(a.o){case Pl:var b=a.g.ended?!0:Ed(a.g.buffered)>=a.g.duration-1;break;case Kl:a:if(a.g.ended||le(a.M))b=!0;else{if(a.i.presentationTimeline.aa()){var c=a.i.presentationTimeline.Db();if(Ed(a.g.buffered)>=c){b=!0;break a}}b=!1}break;default:b=!1}var d=Gd(a.g.buffered,a.g.currentTime);c=a.L;var e=b,f=c.h.get(c.g);b=c.g;d=e||d>=f?ei:fi;c.g=d;b!=d&&tl(a)}
function Jl(a){return new Si(a.i,{eb:function(){return a.A.l()},getBandwidthEstimate:function(){return a.u.getBandwidthEstimate()},T:a.M,Ib:a.X,ue:a.Vf.bind(a),te:a.Ze.bind(a),onError:a.Va.bind(a),onEvent:function(b){return a.dispatchEvent(b)},Zf:a.$f.bind(a),zd:a.eg.bind(a)})}Y.prototype.configure=function(a,b){2==arguments.length&&"string"==typeof a&&(a=Ok(a,b));var c=Sk(this.h,a,$k(this));Ul(this);return c};Y.prototype.configure=Y.prototype.configure;
function Ul(a){if(a.C){var b=cc(a.h.manifest);a.g&&"AUDIO"===a.g.nodeName&&(b.disableVideo=!0);a.C.configure(b)}a.m&&a.m.configure(a.h.drm);if(a.j){a.j.configure(a.h.streaming);try{a.i.periods.forEach(a.Xc.bind(a))}catch(f){a.Va(f)}var c=Xi(a.j),d=Zi(a.j);b=Nl(a);c=O.ie(c,d,b.variants);a.u&&c&&c.allowedByApplication&&c.allowedByKeySystem?Ol(a,b.variants):(B.debug("Choosing new streams after changing configuration"),Vl(a,b))}if(a.M&&(b=a.h.textDisplayFactory,a.fd!=b)){c=new b;d=a.M;var e=d.l;d.l=c;
e&&(c.setTextVisibility(e.isTextVisible()),e.destroy());d.g&&(d.g.i=c);a.fd=b;a.j&&(b=a.j,(c=b.h.get("text"))&&fj(b,c.stream,!0,0,!0))}a.u&&(a.u.configure(a.h.abr),a.h.abr.enabled&&!a.yb?a.u.enable():a.u.disable(),Wl(a));a.L&&(b=a.h.streaming.rebufferingGoal,a.i&&(b=Math.max(b,a.i.minBufferTime)),gi(a.L,b,Math.min(.5,b/2)))}Y.prototype.getConfiguration=function(){var a=$k(this);Sk(a,this.h,$k(this));return a};Y.prototype.getConfiguration=Y.prototype.getConfiguration;
Y.prototype.vg=function(){for(var a in this.h)delete this.h[a];Sk(this.h,$k(this),$k(this));Ul(this)};Y.prototype.resetConfiguration=Y.prototype.vg;Y.prototype.tf=function(){return this.o};Y.prototype.getLoadMode=Y.prototype.tf;Y.prototype.yf=function(){return this.g};Y.prototype.getMediaElement=Y.prototype.yf;Y.prototype.Yb=function(){return this.X};Y.prototype.getNetworkingEngine=Y.prototype.Yb;Y.prototype.tc=function(){return this.Tb};Y.prototype.getAssetUri=Y.prototype.tc;
Y.prototype.wf=function(){Ee("getManifestUri",'Please use "getAssetUri" instead.');return this.tc()};Y.prototype.getManifestUri=Y.prototype.wf;Y.prototype.aa=function(){return this.i?this.i.presentationTimeline.aa():this.g&&this.g.src?Infinity==this.g.duration:!1};Y.prototype.isLive=Y.prototype.aa;Y.prototype.ib=function(){return this.i?this.i.presentationTimeline.ib():!1};Y.prototype.isInProgress=Y.prototype.ib;
Y.prototype.Qf=function(){if(this.i){if(!this.i.periods.length)return!1;var a=this.i.periods[0].variants;return a.length?!a[0].video:!1}return this.g&&this.g.src?this.g.videoTracks?0==this.g.videoTracks.length:0==this.g.videoHeight:!1};Y.prototype.isAudioOnly=Y.prototype.Qf;Y.prototype.He=function(){if(this.i){var a=this.i.presentationTimeline;return{start:a.Cb(),end:a.Ka()}}return this.g&&this.g.src&&(a=this.g.seekable,a.length)?{start:a.start(0),end:a.end(a.length-1)}:{start:0,end:0}};
Y.prototype.seekRange=Y.prototype.He;Y.prototype.keySystem=function(){return ld(this.drmInfo())};Y.prototype.keySystem=Y.prototype.keySystem;Y.prototype.drmInfo=function(){return this.m?this.m.g:null};Y.prototype.drmInfo=Y.prototype.drmInfo;Y.prototype.Xb=function(){return this.m?this.m.Xb():Infinity};Y.prototype.getExpiration=Y.prototype.Xb;Y.prototype.jd=function(){return this.L?this.L.g==fi:!1};Y.prototype.isBuffering=Y.prototype.jd;
Y.prototype.Cf=function(){if(this.J){var a=this.J;a=a.j?0:a.i}else a=0;return a};Y.prototype.getPlaybackRate=Y.prototype.Cf;Y.prototype.Mg=function(a){0==a?B.ba("A trick play rate of 0 is unsupported!"):(this.g.paused&&this.g.play(),this.J&&this.J.set(a),this.o==Kl&&ej(this.j,1<Math.abs(a)))};Y.prototype.trickPlay=Y.prototype.Mg;Y.prototype.$e=function(){var a=this.J.vc();this.o==Pl&&this.J.set(a);this.o==Kl&&(this.J.set(a),ej(this.j,!1))};Y.prototype.cancelTrickPlay=Y.prototype.$e;
Y.prototype.ed=function(){if(this.i&&this.A){for(var a=Xl(this),b=[],c=t(Yl(this)),d=c.next();!d.done;d=c.next()){d=d.value;var e=O.Oc(d);e.active=d==a;b.push(e)}return b}return this.g&&this.g.audioTracks?Array.from(this.g.audioTracks).map(function(a){return O.je(a)}):[]};Y.prototype.getVariantTracks=Y.prototype.ed;
Y.prototype.Eb=function(){if(this.i&&this.A){for(var a=Zl(this),b=[],c=t($l(this)),d=c.next();!d.done;d=c.next()){d=d.value;var e=O.Kc(d);e.active=d==a;b.push(e)}return b}return this.g&&this.g.src&&this.g.textTracks?Rl(this).map(function(a){return O.Of(a)}):[]};Y.prototype.getTextTracks=Y.prototype.Eb;
Y.prototype.Ld=function(a){if(this.i&&this.j){var b=Nl(this),c=b.textStreams.find(function(b){return b.id==a.id});c?(am(this,b,c,!1),bm(this,c),this.ua=c.language):B.error("No stream with id",a.id)}else if(this.g&&this.g.src&&this.g.textTracks){b=Rl(this);b=t(b);for(c=b.next();!c.done;c=b.next())c=c.value,O.gd(c)==a.id?c.mode=this.ub?"showing":"hidden":c.mode="disabled";cm(this)}};Y.prototype.selectTextTrack=Y.prototype.Ld;
Y.prototype.xg=function(){Ee("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var a=this.Eb().filter(function(a){return"application/cea-608"==a.mimeType});0<a.length?this.Ld(a[0]):B.v("Unable to find the text track embedded in the video.")};Y.prototype.selectEmbeddedTextTrack=Y.prototype.xg;
Y.prototype.Rg=function(){Ee("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var a=this.Eb().filter(function(a){return a.active})[0];return a?"application/cea-608"==a.mimeType:!1};Y.prototype.usingEmbeddedTextTrack=Y.prototype.Rg;
Y.prototype.Ie=function(a,b,c){c=void 0===c?0:c;if(this.i&&this.j){var d=Nl(this);this.h.abr.enabled&&B.ba("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var e=d.variants.find(function(b){return b.id==a.id});e?O.Gb(e)?(El(this,d,e,!1),dm(this,e,b,c),this.tb=new Zh(e),Ol(this,d.variants)):B.error("Unable to switch to restricted track",a.id):B.error("No variant with id",a.id)}else if(this.g&&
this.g.audioTracks){b=Array.from(this.g.audioTracks);b=t(b);for(c=b.next();!c.done;c=b.next())c=c.value,O.gd(c)==a.id&&(c.enabled=!0);em(this)}};Y.prototype.selectVariantTrack=Y.prototype.Ie;Y.prototype.nf=function(){return fm(this.ed())};Y.prototype.getAudioLanguagesAndRoles=Y.prototype.nf;Y.prototype.Jf=function(){return fm(this.Eb())};Y.prototype.getTextLanguagesAndRoles=Y.prototype.Jf;Y.prototype.mf=function(){return Array.from(gm(this.ed()))};Y.prototype.getAudioLanguages=Y.prototype.mf;
Y.prototype.If=function(){return Array.from(gm(this.Eb()))};Y.prototype.getTextLanguages=Y.prototype.If;
Y.prototype.Jd=function(a,b){if(this.i&&this.A){var c=Nl(this);this.tb=new $h(a,b||"",0,"");if(!this.h.abr.enabled){var d=function(a,b){return a.video||b.video?a.video&&b.video?Math.abs((a.video.height||0)-(b.video.height||0))+Math.abs((a.video.width||0)-(b.video.width||0)):Infinity:0},e=Nl(this)||this.i.periods[0],f=Th(this.Z,e).variant,h=this.tb.create(e.variants);e=null;h=t(h.values());for(var k=h.next();!k.done;k=h.next())if(k=k.value,!e||d(e,f)>d(k,f))e=k;if(e){c=O.Oc(e);this.Ie(c,!0);return}}hm(this,
c)}else if(this.g&&this.g.audioTracks){e=Array.from(this.g.audioTracks);c=N(a);f=d=null;e=t(e);for(h=e.next();!h.done;h=e.next())h=h.value,k=O.je(h),N(k.language)==c&&(d=h,b?k.roles.includes(b)&&(f=h):0==k.roles.length&&(f=h));f?(f.enabled=!0,em(this)):d&&(d.enabled=!0,em(this))}};Y.prototype.selectAudioLanguage=Y.prototype.Jd;
Y.prototype.Kd=function(a,b){if(this.i&&this.A){var c=Nl(this);this.ua=a;this.Xa=b||"";var d=O.Wb(c.textStreams,this.ua,this.Xa)[0]||null;d&&(am(this,c,d,!1),(this.h.streaming.alwaysStreamText||this.zc())&&bm(this,d))}else{var e=N(a);(c=this.Eb().filter(function(a){return N(a.language)==e&&(!b||a.roles.includes(b))})[0])&&this.Ld(c)}};Y.prototype.selectTextLanguage=Y.prototype.Kd;
Y.prototype.yg=function(a){if(this.i&&this.A){for(var b=Nl(this),c=null,d=t(Yl(this)),e=d.next();!e.done;e=d.next())if(e=e.value,e.audio.label==a){c=e;break}null==c?B.v("No variants were found with label: "+a+". Ignoring the request to switch."):(this.tb=new $h(c.language,"",0,a),hm(this,b))}};Y.prototype.selectVariantsByLabel=Y.prototype.yg;
Y.prototype.zc=function(){var a=this.ub;return this.M?this.M.l.isTextVisible():this.g&&this.g.src&&this.g.textTracks?Rl(this).some(function(a){return"showing"==a.mode}):a};Y.prototype.isTextTrackVisible=Y.prototype.zc;function Rl(a){return Array.from(a.g.textTracks).filter(function(a){return"metadata"!=a.kind&&"chapters"!=a.kind&&"Shaka Player TextTrack"!=a.label})}
Y.prototype.Bg=function(a){var b=this;return u(function d(){var e,f,h,k,l,n;return y(d,function(d){switch(d.s){case 1:e=b.ub;f=!!a;if(e==f)return d["return"]();b.ub=f;if(b.o!=Kl){if(b.g&&b.g.src&&b.g.textTracks){h=Rl(b);for(var p=t(h),r=p.next();!r.done;r=p.next())k=r.value,"disabled"!=k.mode&&(k.mode=f?"showing":"hidden")}d.I(2);break}b.M.l.setTextVisibility(f);if(b.h.streaming.alwaysStreamText){d.I(2);break}if(!f){dj(b.j);d.I(2);break}if(Yi(b.j,"text")){d.I(2);break}l=Nl(b);n=O.Wb(l.textStreams,
b.ua,b.Xa);if(!(0<n.length)){d.I(2);break}return v(d,$i(b.j,n[0]),2);case 2:im(b),w(d)}})})};Y.prototype.setTextTrackVisibility=Y.prototype.Bg;
Y.prototype.Ef=function(){if(!this.aa())return B.v("getPlayheadTimeAsDate is for live streams!"),null;var a=this.Ya.j,b=0;if(this.A)b=this.A.l();else if(a){if(null==a.startTime)return new Date;b=a.startTime}if(this.i)return new Date(1E3*(this.i.presentationTimeline.j+this.g.currentTime));if(this.g&&this.g.getStartDate)return a=this.g.getStartDate(),isNaN(a.getTime())?(B.v("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(a.getTime()+1E3*b);B.v("No way to get playhead time as Date!");
return null};Y.prototype.getPlayheadTimeAsDate=Y.prototype.Ef;Y.prototype.Gf=function(){if(!this.aa())return B.v("getPresentationStartTimeAsDate is for live streams!"),null;if(this.i)return new Date(1E3*this.i.presentationTimeline.j);if(this.g&&this.g.getStartDate){var a=this.g.getStartDate();return isNaN(a.getTime())?(B.v("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):a}B.v("No way to get presentation start time as Date!");return null};
Y.prototype.getPresentationStartTimeAsDate=Y.prototype.Gf;Y.prototype.bd=function(){var a={total:[],audio:[],video:[],text:[]};this.o==Pl&&(a.total=Hd(this.g.buffered));this.o==Kl&&this.M.bd(a);return a};Y.prototype.getBufferedInfo=Y.prototype.bd;
Y.prototype.getStats=function(){if(this.o!=Kl&&this.o!=Pl)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Al(this);var a=this.g;if(a.getVideoPlaybackQuality){a=a.getVideoPlaybackQuality();var b=this.F,c=Number(a.totalVideoFrames);b.A=Number(a.droppedVideoFrames);b.u=c;this.F.o=Number(a.corruptedVideoFrames)}this.m?
(a=this.m,a=a.P?a.P:NaN):a=NaN;this.F.m=a;if(this.o==Kl){if(a=Xl(this))this.F.C=a.bandwidth;a&&a.video&&(b=this.F,c=a.video.height||NaN,b.F=a.video.width||NaN,b.l=c);a=this.u.getBandwidthEstimate();this.F.j=a}var d=this.F;a=d.F;b=d.l;c=d.C;var e=d.u,f=d.A,h=d.o,k=d.j,l=d.h,n=Vk(d.g,"playing"),p=Vk(d.g,"paused"),q=Vk(d.g,"buffering"),r=d.m,x=Wk(d.g),C=[];d=t(d.i.g);for(var z=d.next();!z.done;z=d.next())z=z.value,C.push({timestamp:z.timestamp,id:z.id,type:z.type,fromAdaptation:z.fromAdaptation,bandwidth:z.bandwidth});
return{width:a,height:b,streamBandwidth:c,decodedFrames:e,droppedFrames:f,corruptedFrames:h,estimatedBandwidth:k,loadLatency:l,playTime:n,pauseTime:p,bufferingTime:q,licenseTime:r,stateHistory:x,switchHistory:C}};Y.prototype.getStats=Y.prototype.getStats;
Y.prototype.addTextTrack=function(a,b,c,d,e,f){var h=this;return u(function l(){var n,p,q,r,x,C,z,F,I;return y(l,function(l){switch(l.s){case 1:if(h.o==Pl)throw B.error("Cannot add text when loaded with src="),Error("State error!");if(h.o!=Kl)throw B.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=Nl(h);p=Ab;q=h.i.periods.indexOf(n);r=q+1;x=r>=h.i.periods.length?h.i.presentationTimeline.ha():h.i.periods[r].startTime;C=x-n.startTime;if(Infinity==
C)throw new D(1,4,4033);z=new V(1,0,C,function(){return[a]},0,null);F={id:h.re++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(a){return 1==a?z:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:d,codecs:e||"",kind:c,encrypted:!1,keyId:null,language:b,label:f||null,type:p.za,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.lc.add(F);n.textStreams.push(F);return v(l,$i(h.j,F),2);case 2:return(I=Yi(h.j,"text"))&&Sh(h.Z,n,I),h.lc["delete"](F),B.debug("Choosing new streams after adding a text stream"),Vl(h,n),Ml(h),l["return"](O.Kc(F))}})})};Y.prototype.addTextTrack=Y.prototype.addTextTrack;Y.prototype.Nd=function(a,b){this.mc.width=a;this.mc.height=b};Y.prototype.setMaxHardwareResolution=Y.prototype.Nd;
Y.prototype.Id=function(){if(this.o==Kl){var a=this.j;if(a.j)B.error("Unable to retry after StreamingEngine is destroyed!"),a=!1;else if(a.A)B.error("Unable to retry after StreamingEngine encountered a fatal error!"),a=!1;else{for(var b=t(a.h.values()),c=b.next();!c.done;c=b.next()){c=c.value;var d=jj(c);c.ac&&(B.info(d,"Retrying after failure..."),c.ac=!1,cj(a,c,.1))}a=!0}}else a=!1;return a};Y.prototype.retryStreaming=Y.prototype.Id;Y.prototype.uf=function(){return this.i};
Y.prototype.getManifest=Y.prototype.uf;Y.prototype.vf=function(){return this.C?this.C.constructor:null};Y.prototype.getManifestParserFactory=Y.prototype.vf;function El(a,b,c,d){Th(a.Z,b).variant=c;a=a.F.i;a.i!=c&&(a.i=c,a.g.push({timestamp:Date.now()/1E3,id:c.id,type:"variant",fromAdaptation:d,bandwidth:c.bandwidth}))}function am(a,b,c,d){Sh(a.Z,b,c);a=a.F.i;a.h!=c&&(a.h=c,a.g.push({timestamp:Date.now()/1E3,id:c.id,type:"text",fromAdaptation:d,bandwidth:null}))}
function $k(a){var b=Qk();b.streaming.failureCallback=function(b){var c=[1001,1002,1003];a.aa()&&c.includes(b.code)&&(b.severity=1,B.v("Live streaming error.  Retrying automatically..."),a.Id())};b.textDisplayFactory=function(){return new Kk(a.g)};return b}
function Cl(a,b){for(var c=0;c<b.length;c++){for(var d=b[c],e=new Map,f=t(d.variants),h=f.next();!h.done;h=f.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=t(h.closedCaptions.keys()),l=k.next();!l.done;l=k.next())if(l=l.value,!e.has(l)){var n={id:a.re++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(l),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};e.set(l,n)}}e=t(e.values());for(f=e.next();!f.done;f=e.next())d.textStreams.push(f.value)}}
function vl(a,b){var c=a.j?Xi(a.j):null,d=a.j?Zi(a.j):null;b.forEach(O.filterNewPeriod.bind(null,a.m,c,d));c=gc(b,function(a){return a.variants.some(O.Gb)});if(0==c)throw new D(2,4,4032);if(c<b.length)throw new D(2,4,4011);b.forEach(function(a){O.Xd(a.variants,this.h.restrictions,this.mc)&&this.j&&Nl(this)==a&&Ml(this);jm(this,a.variants)}.bind(a))}m=Y.prototype;
m.Xc=function(a){var b=this.j?Xi(this.j):null,c=this.j?Zi(this.j):null;O.filterNewPeriod(this.m,b,c,a);b=a.variants;if(!b.some(O.Gb))throw new D(2,4,4011);jm(this,a.variants);O.Xd(b,this.h.restrictions,this.mc)&&this.j&&Nl(this)==a&&Ml(this);if((a=this.m?this.m.g:null)&&this.m.o)for(b=t(b),c=b.next();!c.done;c=b.next()){c=t(c.value.drmInfos);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d.keySystem==a.keySystem){d=t(d.initData||[]);for(var e=d.next();!e.done;e=d.next())e=e.value,hd(this.m,e.initDataType,
e.initData)}}};function dm(a,b,c,d){c=void 0===c?!1:c;d=void 0===d?0:d;if(a.yb)return a.wa=b,a.qe=c,a.oe=d,!0;(b=gj(a.j,b,c,d))&&em(a);return b}function bm(a,b){if(a.yb)return a.va=b,!0;var c=fj(a.j,b,!0,0,!1);c&&cm(a);return c}
function Ll(a,b){function c(a,b){if(!a)return null;var c=a.findSegmentPosition(b-f.startTime);return null==c?null:(c=a.getSegmentReference(c))?c.startTime+f.startTime:null}var d=Xi(a.j),e=Zi(a.j),f=Nl(a);d=c(d,b);e=c(e,b);return null!=e&&null!=d?Math.max(e,d):null!=e?e:null!=d?d:b}function tl(a){var b=a.jd();if(a.F&&a.L&&a.A){var c=a.J;c.j=b;ui(c);Al(a)}a.dispatchEvent(new K("buffering",{buffering:b}))}function Bl(a){var b=a.g.playbackRate;0!=b&&a.J.set(b)}
function Al(a){if(a.F&&a.L){var b=a.F.g;a.L.g==fi?Uk(b,"buffering"):a.g.paused?Uk(b,"paused"):a.g.ended?Uk(b,"ended"):Uk(b,"playing")}}function Ol(a,b){try{jm(a,b)}catch(d){return a.Va(d),null}var c=b.filter(function(a){return O.Gb(a)});c=a.tb.create(c);a.u.setVariants(Array.from(c.values()));return a.u.chooseVariant()}function Vl(a,b){var c=hm(a,b,!1),d=O.Wb(b.textStreams,a.ua,a.Xa)[0]||null,e=!1;d&&(a.h.streaming.alwaysStreamText||a.zc())&&(am(a,b,d,!0),e=bm(a,d));(c||e)&&Fl(a)}
function hm(a,b,c){c=void 0===c?!0:c;var d=Ol(a,b.variants),e=!1;d&&(El(a,b,d,!0),e=dm(a,d,!0));c&&e&&Fl(a);return e}
m.Vf=function(a){B.debug("onChooseStreams_",a);try{B.O("onChooseStreams_, choosing variant from ",a.variants);B.O("onChooseStreams_, choosing text from ",a.textStreams);this.yb=!0;this.u.disable();Wl(this);B.debug("Choosing new streams after period changed");var b=Ol(this,a.variants),c=O.Wb(a.textStreams,this.ua,this.Xa)[0]||null;this.wa&&(a.variants.includes(this.wa)&&(b=this.wa),this.wa=null);this.va&&(a.textStreams.includes(this.va)&&(c=this.va),this.va=null);b&&El(this,a,b,!0);c&&am(this,a,c,
!0);var d=this.j,e=d.h.get("video");if(e)var f=d.i.periods[e.oa];else{var h=d.h.get("audio");f=h?d.i.periods[h.oa]:null}var k=b?b.audio:null;if(!f&&c){var l;if(l=k){a=c;var n=N(this.h.preferredTextLanguage),p=N(k.language),q=N(a.language);l=xe(q,n)&&!xe(p,q)}l&&(this.ub=!0);this.ub&&this.M.l.setTextVisibility(!0);im(this)}var r=this.h.streaming.alwaysStreamText||this.zc()?{variant:b,text:c}:{variant:b,text:null};B.O("onChooseStreams_, chose variant ",r.variant);B.O("onChooseStreams_, chose text ",
r.text);return r}catch(x){return this.Va(x),{variant:null,text:null}}};m.Ze=function(){B.debug("canSwitch_");this.yb=!1;this.h.abr.enabled&&(this.u.enable(),Wl(this));this.wa&&(gj(this.j,this.wa,this.qe,this.oe),em(this),this.wa=null);this.va&&(fj(this.j,this.va,!0,0,!1),cm(this),this.va=null)};m.$f=function(){this.C&&this.C.update&&this.C.update()};m.eg=function(){this.A&&this.A.C()};function Fl(a){km(a,new K("adaptation"))}function Ml(a){km(a,new K("trackschanged"))}
function em(a){km(a,new K("variantchanged"))}function cm(a){km(a,new K("textchanged"))}function im(a){km(a,new K("texttrackvisibility"))}function Wl(a){km(a,new K("abrstatuschanged",{Zg:a.h.abr.enabled}))}m.Va=function(a){if(this.o!=ll){var b=new K("error",{detail:a});this.dispatchEvent(b);b.defaultPrevented&&(a.handled=!0)}};function ul(a,b,c){a.dispatchEvent(new K(b,{detail:{schemeIdUri:c.schemeIdUri,value:c.value,startTime:c.startTime,endTime:c.endTime,id:c.id,eventElement:c.eventElement}}))}
function sl(a){if(!a.g.error)return null;var b=a.g.error.code;if(1==b)return null;var c=a.g.error.msExtendedCode;c&&(0>c&&(c+=Math.pow(2,32)),c=c.toString(16));return new D(2,3,3016,b,c,a.g.error.message)}
function yl(a,b){if(a.j){var c=Nl(a),d=!1,e=Object.keys(b);0==e.length&&B.v("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var f=1==e.length&&"00"==e[0];f&&B.v("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");e.length&&a.i.periods.forEach(function(a){a.variants.forEach(function(a){O.Kf(a).forEach(function(c){var e=
a.allowedByKeySystem;c.keyId&&(c=b[f?"00":c.keyId],a.allowedByKeySystem=!!c&&!nl.includes(c));e!=a.allowedByKeySystem&&(d=!0)})})});e=Xi(a.j);var h=Zi(a.j);(e=O.ie(e,h,c.variants))&&!e.allowedByKeySystem&&(B.debug("Choosing new variants after key status changed"),hm(a,c));d&&(Ml(a),Ol(a,c.variants))}}function zl(a,b,c){if(a.C&&a.C.onExpirationUpdated)a.C.onExpirationUpdated(b,c);a.dispatchEvent(new K("expirationupdated"))}
function Dl(a,b,c){0<b&&(a.aa()?B.v("|playRangeStart| has been configured for live content. Ignoring the setting."):a.Le(b));c<a.ha()&&(a.aa()?B.v("|playRangeEnd| has been configured for live content. Ignoring the setting."):a.Fa(c))}
function jm(a,b){var c=a.m?Cc(a.m.da):{},d=Object.keys(c);d=d.length&&"00"==d[0];for(var e=!1,f=!1,h=[],k=[],l=t(b),n=l.next();!n.done;n=l.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=t(p);for(var q=p.next();!q.done;q=p.next())if(q=q.value,q.keyId){var r=c[d?"00":q.keyId];r?nl.includes(r)&&(k.includes(r)||k.push(r)):h.includes(q.keyId)||h.push(q.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(e=!0):f=!0}if(!e)throw new D(2,4,4012,{hasAppRestrictions:f,missingKeys:h,
restrictedKeyStatuses:k});}function km(a,b){u(function d(){return y(d,function(d){switch(d.s){case 1:return v(d,Promise.resolve(),2);case 2:a.o!=ll&&a.dispatchEvent(b),w(d)}})})}function gm(a){var b=new Set;a=t(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.language?b.add(N(c.language)):b.add("und");return b}
function fm(a){var b=new Map;a=t(a);for(var c=a.next();!c.done;c=a.next()){var d=c.value;c="und";var e=[];d.language&&(c=N(d.language));"variant"==d.type?e=d.audioRoles:e=d.roles;e&&e.length||(e=[""]);b.has(c)||b.set(c,new Set);d=t(e);for(e=d.next();!e.done;e=d.next())e=e.value,b.get(c).add(e)}var f=[];b.forEach(function(a,b){for(var c=t(a),d=c.next();!d.done;d=c.next())f.push({language:b,role:d.value})});return f}
function Yl(a){a=Nl(a);return null==a?[]:a.variants.filter(function(a){return O.Gb(a)})}function $l(a){var b=Nl(a);return null==b?[]:b.textStreams.filter(function(b){return!a.lc.has(b)})}function Nl(a){var b=a.A.l(),c=null;a=t(a.i.periods);for(var d=a.next();!d.done;d=a.next())d=d.value,d.startTime<=b&&(c=d);return c}function Xl(a){var b=Nl(a);return Th(a.Z,b).variant}
function Zl(a){var b=Nl(a);if(null==b)return null;if(!Th(a.Z,b).text){var c=O.Wb(b.textStreams,a.ua,a.Xa);c.length&&Sh(a.Z,b,c[0])}return Th(a.Z,b).text}function pl(){return new D(2,7,7E3)}function kl(a,b,c,d,e,f){return d==a&&e.D==f.D&&e.uri==f.uri&&e.mimeType==f.mimeType&&e.Ia==f.Ia?b:c}function Fk(){return{Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null}}
function ql(a){return new Promise(function(b,c){a.kb=function(){return c(pl())};a.Cc=function(){return b()};a.onError=function(a){return c(a)};a.Ec=function(){return c(pl())}})}var ll=0,Zk=1,Kl=2,Pl=3;Y.LoadMode={DESTROYED:ll,NOT_LOADED:Zk,MEDIA_SOURCE:Kl,SRC_EQUALS:Pl};function lm(a,b,c){var d=void 0==b.expiration?Infinity:b.expiration,e=b.presentationTimeline.ha();b=mm(b.periods[0]);return{offlineUri:null,originalManifestUri:a,duration:e,size:0,expiration:d,tracks:b,appMetadata:c}}function nm(a,b){var c=uk(new sk(a.Ea(),a.ja()),b.periods[0],new X(null,0)),d=b.appMetadata||{};c=mm(c);return{offlineUri:a.toString(),originalManifestUri:b.originalManifestUri,duration:b.duration,size:b.size,expiration:b.expiration,tracks:c,appMetadata:d}}
function mm(a){var b=[],c=O.Bf(a.variants);c=t(c);for(var d=c.next();!d.done;d=c.next())b.push(O.Oc(d.value));a=t(a.textStreams);for(c=a.next();!c.done;c=a.next())b.push(O.Kc(c.value));return b};function om(){this.g={}}function pm(a,b){var c=b.audio,d=b.video;c&&!d&&(a.g[c.id]=c.bandwidth||b.bandwidth);!c&&d&&(a.g[d.id]=d.bandwidth||b.bandwidth);if(c&&d){var e=c.bandwidth||393216,f=d.bandwidth||b.bandwidth-e;0>=f&&(B.v("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),f=b.bandwidth);a.g[c.id]=e;a.g[d.id]=f}}function qm(a,b,c){c=c.endTime-c.startTime;return rm(a,b)*c}
function rm(a,b){var c=a.g[b];null==c&&(c=0,B.error("Asking for bitrate of stream not given to the estimator"));0==c&&B.v("Using bitrate of 0, this stream won't affect progress");return c};function sm(a){this.g=!1;this.h=new E;this.i=a}sm.prototype.destroy=function(){var a=this;if(this.g)return this.h;this.g=!0;return this.i().then(function(){a.h.resolve()},function(){a.h.resolve()})};function tm(a,b,c){a=t(a.periods);for(var d=a.next();!d.done;d=a.next())d=d.value,d.variants=d.variants.filter(function(a){return O.rd(a,b,c)})}function um(a){a=t(a.periods);for(var b=a.next();!b.done;b=a.next())b=b.value,b.variants=b.variants.filter(function(a){var b=!0;a.audio&&(b=b&&je(a.audio));a.video&&(b=b&&je(a.video));return b})}function vm(a,b){for(var c=t(a.periods),d=c.next();!d.done;d=c.next())d=d.value,d.variants=d.variants.filter(function(a){return yd(b,a)})}
function wm(a){var b=new xm;a.periods.forEach(function(a,c){var d=ym(a.variants);if(0==c){d=t(d.g);for(var e=d.next();!e.done;e=d.next())b.add(e.value)}else zm(b,d)});a=t(a.periods);for(var c=a.next();!c.done;c=a.next())c=c.value,c.variants=c.variants.filter(function(a){return Am(b,new Bm(a))})}
function Cm(a,b){return u(function d(){var e,f,h,k;return y(d,function(d){switch(d.s){case 1:e=null,f=t(a.periods),h=f.next();case 2:if(h.done){d.I(0);break}k=h.value;e&&(k.variants=k.variants.filter(function(a){return Am(e,new Bm(a))}));return v(d,b(k),5);case 5:e=ym(k.variants),h=f.next(),d.I(2)}})})}function Bm(a){var b=a.audio;a=a.video;this.h=b?b.mimeType:null;this.g=b?b.codecs.split(".")[0]:null;this.j=a?a.mimeType:null;this.i=a?a.codecs.split(".")[0]:null}function xm(){this.g=[]}
xm.prototype.add=function(a){Am(this,a)||this.g.push(a)};function zm(a,b){a.g=a.g.filter(function(a){return Am(b,a)})}function Am(a,b){return a.g.some(function(a){return b.h==a.h&&b.g==a.g&&b.j==a.j&&b.i==a.i})}function ym(a){var b=new xm;a=t(a);for(var c=a.next();!c.done;c=a.next())b.add(new Bm(c.value));return b};function Z(a){var b=this;if(a&&a.constructor!=Y)throw new D(2,9,9008);this.h=this.g=null;a?(this.g=a.h,this.h=a.Yb()):(this.g=Qk(),this.h=new L);this.j=!1;this.i=[];this.l=[];var c=!a;this.m=new sm(function(){return u(function e(){var a;return y(e,function(e){switch(e.s){case 1:return a=function(){},v(e,Promise.all(b.l.map(function(b){return b.then(a,a)})),2);case 2:if(!c){e.I(3);break}return v(e,b.h.destroy(),3);case 3:b.g=null,b.h=null,w(e)}})})})}A("shaka.offline.Storage",Z);
function Dm(){if(Ic())a:{var a=t(ak.values());for(var b=a.next();!b.done;b=a.next())if(b=b.value,b=b()){b.destroy();a=!0;break a}a=!1}else a=!1;return a}Z.support=Dm;Z.prototype.destroy=function(){return this.m.destroy()};Z.prototype.destroy=Z.prototype.destroy;
Z.prototype.configure=function(a,b){2==arguments.length&&"string"==typeof a&&(a=Ok(a,b));var c=a,d=!1;null!=c.trackSelectionCallback&&(d=!0,c.offline=c.offline||{},c.offline.trackSelectionCallback=c.trackSelectionCallback,delete c.trackSelectionCallback);null!=c.progressCallback&&(d=!0,c.offline=c.offline||{},c.offline.progressCallback=c.progressCallback,delete c.progressCallback);null!=c.usePersistentLicense&&(d=!0,c.offline=c.offline||{},c.offline.usePersistentLicense=c.usePersistentLicense,delete c.usePersistentLicense);
d&&Ee("Storage.configure with OfflineConfig","Please configure storage with a player configuration.");return Sk(this.g,a)};Z.prototype.configure=Z.prototype.configure;Z.prototype.getConfiguration=function(){var a=Qk();Sk(a,this.g,Qk());return a};Z.prototype.getConfiguration=Z.prototype.getConfiguration;Z.prototype.Yb=function(){return this.h};Z.prototype.getNetworkingEngine=Z.prototype.Yb;
Z.prototype.store=function(a,b,c){var d=this;return Em(this,Fm(this,a,b||{},function(){return u(function f(){var b,k;return y(f,function(f){switch(f.s){case 1:return c&&"string"!=typeof c?(Ee("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),b=c,f["return"](new b)):v(f,W.create(a,d.h,d.g.manifest.retryParameters,c),2);case 2:return k=f.B,f["return"](k)}})})}))};Z.prototype.store=Z.prototype.store;Z.prototype.Hf=function(){return this.j};
Z.prototype.getStoreInProgress=Z.prototype.Hf;
function Fm(a,b,c,d){return u(function f(){var h,k,l,n,p,q,r,x,C,z;return y(f,function(f){switch(f.s){case 1:Gm();if(a.j)return f["return"](Promise.reject(new D(2,9,9006)));a.j=!0;return v(f,Hm(a,b,d),2);case 2:h=f.B;Im(a);k=!h.presentationTimeline.aa()&&!h.presentationTimeline.ib();if(!k)throw new D(2,9,9005,b);l=null;n=new Zj;q=p=null;Ba(f,3,4);return v(f,Jm(a,h,function(a){q=q||a}),6);case 6:l=f.B;Im(a);if(q)throw q;return v(f,Km(a,h,l),7);case 7:return v(f,n.init(),8);case 8:return Im(a),v(f,
bk(n),9);case 9:return p=f.B,Im(a),v(f,Lm(a,p.ja,l,h,b,c),10);case 10:r=f.B;Im(a);if(q)throw q;return v(f,p.ja.addManifests([r]),11);case 11:return x=f.B,Im(a),C=new qk("manifest",p.path.Ea,p.path.ja,x[0]),f["return"](nm(C,r));case 4:return Ha(f),a.j=!1,a.i=[],v(f,n.destroy(),12);case 12:if(!l){f.I(13);break}return v(f,l.destroy(),13);case 13:La(f,0);break;case 3:z=Ga(f);if(!p){f.I(15);break}return v(f,p.ja.removeSegments(a.i,function(){}),15);case 15:throw q||z;}})})}
function Km(a,b,c){return u(function e(){var f,h;return y(e,function(e){switch(e.s){case 1:return f={width:Infinity,height:Infinity},tm(b,a.g.restrictions,f),um(b),vm(b,c),wm(b),h=a.g.preferredAudioChannelCount,O.$d(b,h),v(e,Cm(b,function(b){return u(function p(){var c,e,f,h,k,l,I,R;return y(p,function(p){switch(p.s){case 1:c=O;e=[];for(var q=t(b.variants),r=q.next();!r.done;r=q.next())f=r.value,e.push(c.Oc(f));q=t(b.textStreams);for(r=q.next();!r.done;r=q.next())h=r.value,e.push(c.Kc(h));return v(p,
a.g.offline.trackSelectionCallback(e),2);case 2:k=p.B;l=new Set;I=new Set;q=t(k);for(r=q.next();!r.done;r=q.next())R=r.value,"variant"==R.type&&l.add(R.id),"text"==R.type&&I.add(R.id);b.variants=b.variants.filter(function(a){return l.has(a.id)});b.textStreams=b.textStreams.filter(function(a){return I.has(a.id)});w(p)}})})}),2);case 2:Mm(b),w(e)}})})}
function Lm(a,b,c,d,e,f){return u(function k(){var l,n,p,q,r,x,C,z,F,I;return y(k,function(k){switch(k.s){case 1:return l=lm(e,d,f),n=d.periods.some(function(a){return a.variants.some(function(a){return a.drmInfos&&a.drmInfos.length})}),p=d.periods.some(function(a){return a.variants.some(function(a){return a.drmInfos.some(function(a){return a.initData&&a.initData.length})})}),q=n&&!p,r=null,q&&(x=c.g,r=Nm.get(x.keySystem)),C=new Lj(a.h,function(b,c){l.size=c;a.g.offline.progressCallback(l,b)},function(b,
d){q&&a.g.offline.usePersistentLicense&&r==d&&hd(c,"cenc",b)}),Ca(k,2),F=z=Om(a,C,b,c,d,e,f),v(k,Oj(C),4);case 4:F.size=k.B;z.expiration=c.Xb();I=nd(c);z.sessionIds=a.g.offline.usePersistentLicense?I:[];if(n&&a.g.offline.usePersistentLicense&&!I.length)throw new D(2,9,9007);return k["return"](z);case 2:return Ha(k),v(k,C.destroy(),5);case 5:La(k,0)}})})}Z.prototype.remove=function(a){return Em(this,Pm(this,a))};Z.prototype.remove=Z.prototype.remove;
function Pm(a,b){return u(function d(){var e,f,h,k,l,n;return y(d,function(d){switch(d.s){case 1:Gm();e=rk(b);if(null==e||"manifest"!=e.g)return d["return"](Promise.reject(new D(2,9,9004,b)));f=e;h=new Zj;Ca(d,2);return v(d,h.init(),4);case 4:return v(d,dk(h,f.Ea(),f.ja()),5);case 5:return k=d.B,v(d,k.getManifests([f.key()]),6);case 6:return l=d.B,n=l[0],v(d,Promise.all([Qm(a,n,h),Rm(a,k,f,n)]),2);case 2:return Ha(d),v(d,h.destroy(),8);case 8:La(d,0)}})})}
function Sm(a,b){for(var c=[],d=t(a.periods),e=d.next();!e.done;e=d.next()){e=t(e.value.streams);for(var f=e.next();!f.done;f=e.next())f=f.value,b&&"video"==f.contentType?c.push({contentType:Dc(f.mimeType,f.codecs),robustness:a.drmInfo.videoRobustness}):b||"audio"!=f.contentType||c.push({contentType:Dc(f.mimeType,f.codecs),robustness:a.drmInfo.audioRobustness})}return c}function Qm(a,b,c){return u(function e(){return y(e,function(e){switch(e.s){case 1:return v(e,Tm(a.h,a.g.drm,c,b),0)}})})}
function Rm(a,b,c,d){function e(){k+=1;a.g.offline.progressCallback(l,k/h)}var f=Um(d),h=f.length+1,k=0,l=nm(c,d);return Promise.all([b.removeSegments(f,e),b.removeManifests([c.key()],e)])}Z.prototype.sg=function(){return Em(this,Vm(this))};Z.prototype.removeEmeSessions=Z.prototype.sg;
function Vm(a){return u(function c(){var d,e,f,h,k,l,n,p,q;return y(c,function(c){switch(c.s){case 1:return Gm(),d=a.h,e=a.g.drm,f=new Zj,h=!1,Ca(c,2),v(c,f.init(),4);case 4:k=[];ek(f,function(a){return k.push(a)});l=Promise.resolve();n={};p=t(k);for(q=p.next();!q.done;n={Jc:n.Jc},q=p.next())n.Jc=q.value,l=l.then(function(a){return function(){return u(function z(){var c,f;return y(z,function(k){switch(k.s){case 1:return v(k,a.Jc.getAll(),2);case 2:return c=k.B,v(k,Bk(e,d,c),3);case 3:return f=k.B,
v(k,a.Jc.remove(f),4);case 4:f.length!=c.length&&(h=!0),w(k)}})})}}(n));return v(c,l,2);case 2:return Ha(c),v(c,f.destroy(),6);case 6:La(c,3);break;case 3:return c["return"](!h)}})})}Z.prototype.list=function(){return Em(this,Wm())};Z.prototype.list=Z.prototype.list;
function Wm(){return u(function b(){var c,d,e;return y(b,function(b){switch(b.s){case 1:return Gm(),c=[],d=new Zj,Ca(b,2),v(b,d.init(),4);case 4:return e=Promise.resolve(),ck(d,function(b,d){e=e.then(function(){return u(function n(){var e;return y(n,function(f){switch(f.s){case 1:return v(f,d.getAllManifests(),2);case 2:e=f.B,e.forEach(function(d,e){var f=nm(new qk("manifest",b.Ea,b.ja,e),d);c.push(f)}),w(f)}})})})}),v(b,e,2);case 2:return Ha(b),v(b,d.destroy(),6);case 6:La(b,3);break;case 3:return b["return"](c)}})})}
function Hm(a,b,c){return u(function e(){var f,h,k,l,n,p;return y(e,function(e){switch(e.s){case 1:return f=null,h=a.h,k={networkingEngine:h,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(a){f=a}},v(e,c(),2);case 2:return l=e.B,l.configure(a.g.manifest),Im(a),Ca(e,3),v(e,l.start(b,k),5);case 5:return n=e.B,Im(a),p=Xm(n),v(e,Promise.all(zc(p,function(a){return a.createSegmentIndex()})),6);case 6:Im(a);if(f)throw f;
return e["return"](n);case 3:return Ha(e),v(e,l.stop(),7);case 7:La(e,0)}})})}function Jm(a,b,c){return u(function e(){var f,h,k;return y(e,function(e){switch(e.s){case 1:return f=new Rc({Ib:a.h,onError:c,Dc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),h=pi(b.periods),k=a.g,f.configure(k.drm),v(e,Wc(f,h,k.offline.usePersistentLicense),2);case 2:return v(e,fd(f),3);case 3:return v(e,gd(f),4);case 4:return e["return"](f)}})})}
function Om(a,b,c,d,e,f,h){var k=new om,l=e.periods.map(function(d){return Ym(a,b,c,k,e,d)}),n=d.g,p=a.g.offline.usePersistentLicense;n&&p&&(n.initData=[]);return{originalManifestUri:f,duration:e.presentationTimeline.ha(),size:0,expiration:d.Xb(),periods:l,sessionIds:p?nd(d):[],drmInfo:n,appMetadata:h}}
function Ym(a,b,c,d,e,f){for(var h=t(f.variants),k=h.next();!k.done;k=h.next())pm(d,k.value);h=t(f.textStreams);for(k=h.next();!k.done;k=h.next())d.g[k.value.id]=52;h=Zm(f);var l=new Map;h=t(h);for(k=h.next();!k.done;k=h.next()){k=k.value;var n=$m(a,b,c,d,e,k);l.set(k.id,n)}f.variants.forEach(function(a){a.audio&&l.get(a.audio.id).variantIds.push(a.id);a.video&&l.get(a.video.id).variantIds.push(a.id)});return{startTime:f.startTime,streams:Array.from(l.values())}}
function $m(a,b,c,d,e,f){var h={id:f.id,originalId:f.originalId,primary:f.primary,presentationTimeOffset:f.presentationTimeOffset||0,contentType:f.type,mimeType:f.mimeType,codecs:f.codecs,frameRate:f.frameRate,pixelAspectRatio:f.pixelAspectRatio,kind:f.kind,language:f.language,label:f.label,width:f.width||null,height:f.height||null,initSegmentKey:null,encrypted:f.encrypted,keyId:f.keyId,segments:[],variantIds:[]};e=e.presentationTimeline.$b();var k=f.id,l=f.initSegmentReference;l&&(l=zg(l.i(),l.h,
l.g,a.g.streaming.retryParameters),Mj(b,k,l,.5*rm(d,f.id),!0,function(b){return u(function q(){var d;return y(q,function(e){switch(e.s){case 1:return v(e,c.addSegments([{data:b}]),2);case 2:d=e.B,a.i.push(d[0]),h.initSegmentKey=d[0],w(e)}})})}));an(f,e,function(e){var l=zg(e.i(),e.h,e.g,a.g.streaming.retryParameters);Mj(b,k,l,qm(d,f.id,e),!1,function(b){return u(function x(){var d;return y(x,function(f){switch(f.s){case 1:return v(f,c.addSegments([{data:b}]),2);case 2:d=f.B,a.i.push(d[0]),h.segments.push({startTime:e.startTime,
endTime:e.endTime,dataKey:d[0]}),w(f)}})})})});return h}function an(a,b,c){b=a.findSegmentPosition(b);for(var d=null==b?null:a.getSegmentReference(b);d;)c(d),d=a.getSegmentReference(++b)}function Im(a){if(a.m.g)throw new D(2,9,7001);}function Gm(){if(!Dm())throw new D(2,9,9E3);}function Em(a,b){return u(function d(){return y(d,function(d){switch(d.s){case 1:return a.l.push(b),Ca(d,2),v(d,b,4);case 4:return d["return"](d.B);case 2:Ha(d),fc(a.l,b),La(d,0)}})})}
function Um(a){var b=[];a.periods.forEach(function(a){a.streams.forEach(function(a){null!=a.initSegmentKey&&b.push(a.initSegmentKey);a.segments.forEach(function(a){b.push(a.dataKey)})})});return b}Z.deleteAll=function(){return u(function b(){var c;return y(b,function(b){switch(b.s){case 1:return c=new Zj,Ca(b,2),v(b,c.erase(),2);case 2:return Ha(b),v(b,c.destroy(),5);case 5:La(b,0)}})})};
function Tm(a,b,c,d){return u(function f(){var h,k,l;return y(f,function(f){switch(f.s){case 1:if(!d.drmInfo)return f["return"]();h=fk(c);k=d.sessionIds.map(function(a){return{sessionId:a,keySystem:d.drmInfo.keySystem,licenseUri:d.drmInfo.licenseServerUri,serverCertificate:d.drmInfo.serverCertificate,audioCapabilities:Sm(d,!1),videoCapabilities:Sm(d,!0)}});return v(f,Bk(b,a,k),2);case 2:return l=f.B,v(f,h.remove(l),3);case 3:return v(f,h.add(k.filter(function(a){return-1==l.indexOf(a.sessionId)})),
0)}})})}function Xm(a){var b=new Set;a=t(a.periods);for(var c=a.next();!c.done;c=a.next()){c=c.value;for(var d=t(c.textStreams),e=d.next();!e.done;e=d.next())b.add(e.value);c=t(c.variants);for(d=c.next();!d.done;d=c.next())d=d.value,d.audio&&b.add(d.audio),d.video&&b.add(d.video)}return b}
function Zm(a){for(var b=new Set,c=t(a.textStreams),d=c.next();!d.done;d=c.next())b.add(d.value);a=t(a.variants);for(c=a.next();!c.done;c=a.next())c=c.value,c.audio&&b.add(c.audio),c.video&&b.add(c.video);return b}function Mm(a){if(0==a.periods.length)throw new D(2,4,4014);a=t(a.periods);for(var b=a.next();!b.done;b=a.next())bn(b.value)}
function bn(a){var b=new Set(a.variants.map(function(a){return a.video})),c=new Set(a.variants.map(function(a){return a.audio}));a=a.textStreams;1<b.size&&B.v("Multiple video tracks selected to be stored");b=t(c);for(var d=b.next();!d.done;d=b.next()){d=d.value;for(var e=t(c),f=e.next();!f.done;f=e.next())f=f.value,d!=f&&d.language==f.language&&B.v("Similar audio tracks were selected to be stored",d.id,f.id)}c=t(a);for(b=c.next();!b.done;b=c.next())for(b=b.value,d=t(a),e=d.next();!e.done;e=d.next())e=
e.value,b!=e&&b.language==e.language&&B.v("Similar text tracks were selected to be stored",b.id,e.id)}var Nm=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");ol.offline=Dm;A("shaka.polyfill.installAll",function(){for(var a=0;a<cn.length;++a)try{cn[a].Xe()}catch(b){B.ba("Error installing polyfill!",b)}});var cn=[];function dn(a,b){b=b||0;for(var c={priority:b,Xe:a},d=0;d<cn.length;d++)if(cn[d].priority<b){cn.splice(d,0,c);return}cn.push(c)}A("shaka.polyfill.register",dn);dn(function(){en()},-1);function fn(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"===typeof Event)var c=new Event(b,a);else c=document.createEvent("Event"),c.initEvent(b,a.bubbles,a.cancelable);a.target.dispatchEvent(c)}
dn(function(){if(window.Document){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitCancelFullScreen;"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||
document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}}));document.addEventListener("webkitfullscreenchange",fn);document.addEventListener("webkitfullscreenerror",fn);document.addEventListener("mozfullscreenchange",fn);document.addEventListener("mozfullscreenerror",fn);document.addEventListener("MSFullscreenChange",fn);document.addEventListener("MSFullscreenError",
fn)}});function gn(a,b,c){if("input"==a)switch(this.type){case "range":a="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,a,b,c)}dn(function(){B.debug("InputEvent.install");Mc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(B.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=gn)});dn(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});dn(function(){B.debug("mathRound.install")});function hn(){var a=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];c=a.apply(this,c);c.abort=function(){};return c}}function jn(){var a=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(b,c){return a.call(this,b,c-.001)}}function kn(){var a=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(b){return"mp2t"==b.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:a(b)}}
function ln(){var a=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(b){return"opus"!=Hc(b)[0]&&a(b)}}function mn(){var a=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(b){var c=b.split(/ *; */);c.shift();return c.some(function(a){return a.startsWith("codecs=")})?cast.__platform__.canDisplayType(b):a(b)}}
dn(function(){B.debug("MediaSource.install");var a=Oc();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(B.info("Patching Chromecast MSE bugs."),mn()):a?(kn(),12>=a?(B.info("Patching Safari 11 & 12 MSE bugs."),hn(),jn()):(B.info("Patching Safari 13 MSE bugs."),hn())):Mc("Tizen 2")||Mc("Tizen 3")||Mc("Tizen 4")?ln():B.info("Using native MSE as-is."):B.info("No MSE implementation available.")});function nn(a,b){B.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var c=new on(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function on(a,b){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess");this.keySystem=a;if(a.startsWith("com.apple.fps"))for(var c=t(b),d=c.next();!d.done;d=c.next()){var e=d.value;if("required"==e.persistentState)d=null;else{d={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label};var f=!1,h=!1;if(e.audioCapabilities)for(var k=t(e.audioCapabilities),l=k.next();!l.done;l=k.next())if(l=
l.value,l.contentType){f=!0;var n=l.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,n)&&(d.audioCapabilities.push(l),h=!0)}if(e.videoCapabilities)for(e=t(e.videoCapabilities),l=e.next();!l.done;l=e.next())k=l.value,k.contentType&&(f=!0,l=k.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,l)&&(d.videoCapabilities.push(k),h=!0));f||(h=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));d=h?d:null}if(d){this.g=d;return}}c=Error("Unsupported keySystem");
c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}on.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var a=new pn(this.keySystem);return Promise.resolve(a)};on.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration");return this.g};
function qn(a){B.debug("PatchedMediaKeysApple.setMediaKeys");var b=this.mediaKeys;b&&b!=a&&rn(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?rn(a,this):Promise.resolve()}function pn(a){B.debug("PatchedMediaKeysApple.MediaKeys");this.h=new WebKitMediaKeys(a);this.g=new M}
pn.prototype.createSession=function(a){B.debug("PatchedMediaKeysApple.MediaKeys.createSession");a=a||"temporary";if("temporary"!=a)throw new TypeError("Session type "+a+" is unsupported on this platform.");return new sn(this.h,a)};pn.prototype.setServerCertificate=function(a){B.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate");a&&new Uint8Array(a);return Promise.resolve(!0)};
function rn(a,b){a.g.nb();if(!b)return Promise.resolve();a.g.H(b,"webkitneedkey",tn);try{return vi(b,HTMLMediaElement.HAVE_METADATA,a.g,function(){b.webkitSetMediaKeys(a.h)}),Promise.resolve()}catch(c){return Promise.reject(c)}}function sn(a){B.debug("PatchedMediaKeysApple.MediaKeySession");bc.call(this);this.h=null;this.l=a;this.i=this.g=null;this.j=new M;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new un}bb(sn,bc);m=sn.prototype;
m.generateRequest=function(a,b){B.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest");this.g=new E;try{this.h=this.l.createSession("video/mp4",new Uint8Array(b)),this.sessionId=this.h.sessionId||"",this.j.H(this.h,"webkitkeymessage",this.Gg.bind(this)),this.j.H(this.h,"webkitkeyadded",this.Eg.bind(this)),this.j.H(this.h,"webkitkeyerror",this.Fg.bind(this)),vn(this,"status-pending")}catch(c){this.g.reject(c)}return this.g};
m.load=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};m.update=function(a){B.debug("PatchedMediaKeysApple.MediaKeySession.update");this.i=new E;try{this.h.update(new Uint8Array(a))}catch(b){this.i.reject(b)}return this.i};m.close=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.h.close(),this.closed.resolve(),this.j.nb()}catch(a){this.closed.reject(a)}return this.closed};
m.remove=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function tn(a){B.debug("PatchedMediaKeysApple.onWebkitNeedKey_",a);a=new Uint8Array(a.initData);if((new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint32(0,!0)+4!=a.byteLength)throw new RangeError("Malformed FairPlay init data");a=Ib(a.subarray(4),!0);a=Kb(a);var b=new Event("encrypted");b.initDataType="skd";b.initData=a;this.dispatchEvent(b)}
m.Gg=function(a){B.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",a);this.g&&(this.g.resolve(),this.g=null);this.dispatchEvent(new K("message",{messageType:void 0==this.keyStatuses.g?"license-request":"license-renewal",message:a.message.buffer}))};m.Eg=function(a){B.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",a);this.i&&(vn(this,"usable"),this.i.resolve(),this.i=null)};
m.Fg=function(a){B.debug("PatchedMediaKeysApple.onWebkitKeyError_",a);a=Error("EME PatchedMediaKeysApple key error");a.errorCode=this.h.error;if(null!=this.g)this.g.reject(a),this.g=null;else if(null!=this.i)this.i.reject(a),this.i=null;else switch(this.h.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:vn(this,"output-not-allowed");break;default:vn(this,"internal-error")}};
function vn(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.g=b;a.dispatchEvent(new K("keystatuseschange"))}function un(){this.size=0;this.g=void 0}var wn;m=un.prototype;m.forEach=function(a){this.g&&a(this.g,wn)};m.get=function(a){if(this.has(a))return this.g};m.has=function(a){var b=wn;return this.g&&G.Ha(new Uint8Array(a),new Uint8Array(b))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
dn(function(){window.HTMLVideoElement&&window.WebKitMediaKeys&&(B.info("Using Apple-prefixed EME"),wn=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=qn,window.MediaKeys=pn,window.MediaKeySystemAccess=on,navigator.requestMediaKeySystemAccess=nn)});function xn(a,b){B.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var c=new yn(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function yn(a,b){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},h=!1;if(e.audioCapabilities)for(var k=0;k<e.audioCapabilities.length;++k){var l=e.audioCapabilities[k];if(l.contentType){h=!0;var n=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(k=0;k<e.videoCapabilities.length;++k)l=e.videoCapabilities[k],l.contentType&&(h=!0,n=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(f.videoCapabilities.push(l),c=!0));h||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(c=!1);if(c){this.g=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
yn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var a=new zn(this.keySystem);return Promise.resolve(a)};yn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.g};function An(a){B.debug("PatchedMediaKeysMs.setMediaKeys");var b=this.mediaKeys;b&&b!=a&&Bn(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Bn(a,this):Promise.resolve()}
function zn(a){B.debug("PatchedMediaKeysMs.MediaKeys");this.h=new MSMediaKeys(a);this.g=new M}zn.prototype.createSession=function(a){B.debug("PatchedMediaKeysMs.MediaKeys.createSession");a=a||"temporary";if("temporary"!=a)throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Cn(this.h,a)};zn.prototype.setServerCertificate=function(){B.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function Bn(a,b){a.g.nb();if(!b)return Promise.resolve();a.g.H(b,"msneedkey",Dn);try{return vi(b,HTMLMediaElement.HAVE_METADATA,a.g,function(){b.msSetMediaKeys(a.h)}),Promise.resolve()}catch(c){return Promise.reject(c)}}function Cn(a){B.debug("PatchedMediaKeysMs.MediaKeySession");bc.call(this);this.i=null;this.l=a;this.h=this.g=null;this.j=new M;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new En}bb(Cn,bc);m=Cn.prototype;
m.generateRequest=function(a,b){B.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.g=new E;try{this.i=this.l.createSession("video/mp4",new Uint8Array(b),null),this.j.H(this.i,"mskeymessage",this.dg.bind(this)),this.j.H(this.i,"mskeyadded",this.bg.bind(this)),this.j.H(this.i,"mskeyerror",this.cg.bind(this)),Fn(this,"status-pending")}catch(c){this.g.reject(c)}return this.g};m.load=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
m.update=function(a){B.debug("PatchedMediaKeysMs.MediaKeySession.update");this.h=new E;try{this.i.update(new Uint8Array(a))}catch(b){this.h.reject(b)}return this.h};m.close=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.i.close(),this.closed.resolve(),this.j.nb()}catch(a){this.closed.reject(a)}return this.closed};m.remove=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Dn(a){B.debug("PatchedMediaKeysMs.onMsNeedKey_",a);if(a.initData){var b=document.createEvent("CustomEvent");b.initCustomEvent("encrypted",!1,!1,null);b.initDataType="cenc";b.initData=Jf(a.initData).buffer;this.dispatchEvent(b)}}m.dg=function(a){B.debug("PatchedMediaKeysMs.onMsKeyMessage_",a);this.g&&(this.g.resolve(),this.g=null);this.dispatchEvent(new K("message",{messageType:void 0==this.keyStatuses.g?"license-request":"license-renewal",message:a.message.buffer}))};
m.bg=function(a){B.debug("PatchedMediaKeysMs.onMsKeyAdded_",a);this.g?(B.debug("Simulating completion for a PR persistent license."),Fn(this,"usable"),this.g.resolve(),this.g=null):this.h&&(Fn(this,"usable"),this.h.resolve(),this.h=null)};
m.cg=function(a){B.debug("PatchedMediaKeysMs.onMsKeyError_",a);a=Error("EME PatchedMediaKeysMs key error");a.errorCode=this.i.error;if(null!=this.g)this.g.reject(a),this.g=null;else if(null!=this.h)this.h.reject(a),this.h=null;else switch(this.i.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Fn(this,"output-not-allowed");break;default:Fn(this,"internal-error")}};
function Fn(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.g=b;a.dispatchEvent(new K("keystatuseschange"))}function En(){this.size=0;this.g=void 0}var Gn;m=En.prototype;m.forEach=function(a){this.g&&a(this.g,Gn)};m.get=function(a){if(this.has(a))return this.g};m.has=function(a){var b=Gn;return this.g&&G.Ha(new Uint8Array(a),new Uint8Array(b))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
dn(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("Using ms-prefixed EME v20140218"),Gn=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=An,window.MediaKeys=zn,window.MediaKeySystemAccess=yn,navigator.requestMediaKeySystemAccess=xn)});function Hn(){B.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function In(a){B.debug("PatchedMediaKeysNop.setMediaKeys");return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Jn(){throw new TypeError("Illegal constructor.");}Jn.prototype.createSession=function(){};Jn.prototype.setServerCertificate=function(){};function Kn(){throw new TypeError("Illegal constructor.");}
Kn.prototype.getConfiguration=function(){};Kn.prototype.createMediaKeys=function(){};dn(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("EME not available."),navigator.requestMediaKeySystemAccess=Hn,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=In,window.MediaKeys=Jn,window.MediaKeySystemAccess=Kn)},-10);var Ln="";function Mn(a){var b=Ln;return b?b+a.charAt(0).toUpperCase()+a.slice(1):a}function Nn(a,b){B.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var c=new On(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function Pn(a){B.debug("PatchedMediaKeysWebkit.setMediaKeys");var b=this.mediaKeys;b&&b!=a&&Qn(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Qn(a,this);return Promise.resolve()}
function On(a,b){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.g=this.keySystem=a;var c=!1;"org.w3.clearkey"==a&&(this.g="webkit-org.w3.clearkey",c=!1);var d=!1;var e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var h=b[f],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},l=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){l=!0;var q=p.contentType.split(";")[0];e.canPlayType(q,this.g)&&(k.audioCapabilities.push(p),d=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(l=!0,e.canPlayType(p.contentType,this.g)&&(k.videoCapabilities.push(p),d=!0));l||(d=e.canPlayType("video/mp4",this.g)||e.canPlayType("video/webm",this.g));"required"==h.persistentState&&(c?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):d=!1);if(d){this.h=k;return}}c="Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}On.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var a=new Rn(this.g);return Promise.resolve(a)};
On.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.h};function Rn(a){B.debug("PatchedMediaKeysWebkit.MediaKeys");this.l=a;this.h=null;this.g=new M;this.i=[];this.j={}}function Qn(a,b){a.h=b;a.g.nb();var c=Ln;b&&(a.g.H(b,c+"needkey",a.hg.bind(a)),a.g.H(b,c+"keymessage",a.Jg.bind(a)),a.g.H(b,c+"keyadded",a.Hg.bind(a)),a.g.H(b,c+"keyerror",a.Ig.bind(a)))}m=Rn.prototype;
m.createSession=function(a){B.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");a=a||"temporary";if("temporary"!=a&&"persistent-license"!=a)throw new TypeError("Session type "+a+" is unsupported on this platform.");var b=this.h||document.createElement("video");b.src||(b.src="about:blank");a=new Sn(b,this.l,a);this.i.push(a);return a};m.setServerCertificate=function(){B.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
m.hg=function(a){B.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",a);var b=document.createEvent("CustomEvent");b.initCustomEvent("encrypted",!1,!1,null);b.initDataType="cenc";a.initData instanceof ArrayBuffer?b.initData=a.initData:b.initData=a.initData.buffer;this.h.dispatchEvent(b)};
m.Jg=function(a){B.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",a);var b=Tn(this,a.sessionId);b?(a=new K("message",{messageType:void 0==b.keyStatuses.g?"licenserequest":"licenserenewal",message:a.message}),B.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),b.h&&(b.h.resolve(),b.h=null),b.dispatchEvent(a)):B.error("Session not found",a.sessionId)};
m.Hg=function(a){B.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",a);if(a=Tn(this,a.sessionId))B.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Un(a,"usable"),a.g&&a.g.resolve(),a.g=null};m.Ig=function(a){B.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",a);var b=Tn(this,a.sessionId);b&&b.handleError(a)};
function Tn(a,b){var c=a.j[b];return c?(B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",c),c):(c=a.i.shift())?(c.sessionId=b,a.j[b]=c,B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",c),c):null}function Sn(a,b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySession");bc.call(this);this.j=a;this.m=!1;this.g=this.h=null;this.i=b;this.l=c;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Vn}bb(Sn,bc);m=Sn.prototype;
m.handleError=function(a){B.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",a);var b=Error("EME v0.1b key error"),c=a.errorCode;c.systemCode=a.systemCode;b.errorCode=c;!a.sessionId&&this.h?(45==a.systemCode&&(b.message="Unsupported session type."),this.h.reject(b),this.h=null):a.sessionId&&this.g?(this.g.reject(b),this.g=null):(b=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Un(this,"output-restricted"):1==b?Un(this,"expired"):Un(this,"internal-error"))};
function Wn(a,b,c){if(a.m)return Promise.reject(Error("The session is already initialized."));a.m=!0;try{if("persistent-license"==a.l)if(c)var d=new Uint8Array(Kb("LOAD_SESSION|"+c));else{var e=Kb("PERSISTENT|"),f=new Uint8Array(e.byteLength+b.byteLength);f.set(new Uint8Array(e),0);f.set(new Uint8Array(b),e.byteLength);d=f}else d=new Uint8Array(b)}catch(k){return Promise.reject(k)}a.h=new E;var h=Mn("generateKeyRequest");try{a.j[h](a.i,d)}catch(k){if("InvalidStateError"!=k.name)return a.h=null,Promise.reject(k);
(new H(function(){try{a.j[h](a.i,d)}catch(l){a.h.reject(l),a.h=null}})).V(.01)}return a.h}
m.Qd=function(a,b){if(this.g)this.g.then(this.Qd.bind(this,a,b))["catch"](this.Qd.bind(this,a,b));else{this.g=a;if("webkit-org.w3.clearkey"==this.i){var c=Gb(b);var d=JSON.parse(c);"oct"!=d.keys[0].kty&&(this.g.reject(Error("Response is not a valid JSON Web Key Set.")),this.g=null);c=G.Ja(d.keys[0].k);d=G.Ja(d.keys[0].kid)}else c=new Uint8Array(b),d=null;var e=Mn("addKey");try{this.j[e](this.i,c,d,this.sessionId)}catch(f){this.g.reject(f),this.g=null}}};
function Un(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.g=b;a.dispatchEvent(new K("keystatuseschange"))}m.generateRequest=function(a,b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return Wn(this,b,null)};m.load=function(a){B.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.l?Wn(this,null,a):Promise.reject(Error("Not a persistent session."))};
m.update=function(a){B.debug("PatchedMediaKeysWebkit.MediaKeySession.update",a);var b=new E;this.Qd(b,a);return b};m.close=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var a=Mn("cancelKeyRequest");try{this.j[a](this.i,this.sessionId)}catch(b){}}this.closed.resolve();return this.closed};
m.remove=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()};function Vn(){this.size=0;this.g=void 0}var Xn;m=Vn.prototype;m.forEach=function(a){this.g&&a(this.g,Xn)};m.get=function(a){if(this.has(a))return this.g};m.has=function(a){var b=Xn;return this.g&&G.Ha(new Uint8Array(a),new Uint8Array(b))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
dn(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)B.info("Using webkit-prefixed EME v0.1b"),Ln="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)B.info("Using nonprefixed EME v0.1b");else return;Xn=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=Nn;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=Pn;window.MediaKeys=Rn;window.MediaKeySystemAccess=On}});function Yn(a){a=a.target;if("picture-in-picture"==a.webkitPresentationMode){document.pictureInPictureElement=a;var b=new Event("enterpictureinpicture");a.dispatchEvent(b)}else document.pictureInPictureElement==a&&(document.pictureInPictureElement=null),b=new Event("leavepictureinpicture"),a.dispatchEvent(b)}
function Zn(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function $n(){var a=document.pictureInPictureElement;return a?(a.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}
function ao(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function bo(a){a?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}
dn(function(){if(window.HTMLVideoElement){var a=HTMLVideoElement.prototype;a.requestPictureInPicture&&document.exitPictureInPicture||!a.webkitSupportsPresentationMode||(B.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,a.requestPictureInPicture=Zn,Object.defineProperty(a,"disablePictureInPicture",{get:ao,set:bo,enumerable:!0,configurable:!0}),document.exitPictureInPicture=$n,document.addEventListener("webkitpresentationmodechanged",Yn,!0))}});dn(function(){B.debug("VideoPlayPromise.install");if(window.HTMLMediaElement){var a=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var b=a.apply(this);b&&b["catch"](function(){});return b}}});function co(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}dn(function(){if(window.HTMLVideoElement){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=co)}});function eo(a,b,c){return new window.TextTrackCue(a,b,c)}function fo(a,b,c){return new window.TextTrackCue(a+"-"+b+"-"+c,a,b,c)}
dn(function(){if(window.VTTCue)B.info("Using native VTTCue.");else if(window.TextTrackCue){var a=TextTrackCue.length;if(3==a)B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=eo;else if(6==a)B.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=fo;else{try{var b=!!eo(1,2,"")}catch(c){b=!1}b&&(B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=eo)}}else B.error("VTTCue not available.")});function go(){}A("shaka.text.TtmlTextParser",go);go.prototype.parseInit=function(){};go.prototype.parseInit=go.prototype.parseInit;
go.prototype.parseMedia=function(a,b){var c=Gb(a),d=[],e=new DOMParser,f=null;if(""==c)return d;try{f=e.parseFromString(c,"text/xml")}catch(sa){throw new D(2,2,2005,"Failed to parse TTML.");}if(f){if(c=f.getElementsByTagName("parsererror")[0])throw new D(2,2,2005,c.textContent);if(e=f.getElementsByTagName("tt")[0]){var h=U.getAttributeNS(e,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=U.getAttributeNS(e,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var l=U.getAttributeNS(e,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=U.getAttributeNS(e,"http://www.w3.org/ns/ttml#parameter","tickRate");f=e.getAttribute("xml:space")||"default";c=U.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling","extent")}else throw new D(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=f&&"preserve"!=f)throw new D(2,2,2005,"Invalid xml:space value: "+f);f="default"==f;h=new ho(h,k,l,n);k=io(e.getElementsByTagName("metadata")[0]);l=io(e.getElementsByTagName("styling")[0]);n=io(e.getElementsByTagName("layout")[0]);
for(var p=[],q=0;q<n.length;q++){var r=n[q],x=l,C=c;var z=new Kd;var F=r.getAttribute("xml:id");if(F){z.id=F;F=null;C&&(F=jo.exec(C)||ko.exec(C));C=F?Number(F[1]):null;F=F?Number(F[2]):null;var I,R;if(I=lo(r,x,"extent"))I=(R=jo.exec(I))||ko.exec(I),null!=I&&(z.width=null!=C?100*Number(I[1])/C:Number(I[1]),z.height=null!=F?100*Number(I[2])/F:Number(I[2]),z.widthUnits=R||null!=C?Yd:0,z.heightUnits=R||null!=F?Yd:0);if(r=lo(r,x,"origin"))I=(R=jo.exec(r))||ko.exec(r),null!=I&&(z.viewportAnchorX=null!=
C?100*Number(I[1])/C:Number(I[1]),z.viewportAnchorY=null!=F?100*Number(I[2])/F:Number(I[2]),z.viewportAnchorUnits=R||null!=C?Yd:0)}else B.v("TtmlTextParser parser encountered a region with no id. Region will be ignored."),z=null;z&&p.push(z)}c=mo(e.getElementsByTagName("body")[0]);c=t(c);for(e=c.next();!e.done;e=c.next())(e=no(e.value,b.periodStart,h,k,l,n,p,f,!1))&&d.push(e)}return d};go.prototype.parseMedia=go.prototype.parseMedia;
var jo=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,oo=/^(\d+px|\d+em)$/,ko=/^(\d+)px (\d+)px$/,po=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,qo=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,ro=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,so=/^(\d*(?:\.\d*)?)f$/,to=/^(\d*(?:\.\d*)?)t$/,uo=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,vo={left:Qd,center:"center",right:"end",start:Qd,end:"end"},wo={left:"line-left",center:"center",right:"line-right"};
function io(a){var b=[];if(!a)return b;for(var c=t(a.childNodes),d=c.next();!d.done;d=c.next())d=d.value,d.nodeType==Node.ELEMENT_NODE&&"br"!==d.nodeName&&(d=io(d),b=b.concat(d));b.length||b.push(a);return b}function mo(a){if(!a)return[];var b=[];a=t(a.childNodes);for(var c=a.next();!c.done;c=a.next())c=c.value,c instanceof Element&&(c.hasAttribute("begin")?b.push(c):b=b.concat(mo(c)));return b}
function xo(a,b){for(var c="",d=t(a.childNodes),e=d.next();!e.done;e=d.next())e=e.value,"br"==e.nodeName&&a.childNodes[0]!==e?c+="\n":e.childNodes&&0<e.childNodes.length?c+=xo(e,b):b?(e=e.textContent.trim(),e=e.replace(/\s+/g," "),c+=e):c+=e.textContent;return c}
function no(a,b,c,d,e,f,h,k,l){if(l&&"br"==a.nodeName)return a=new Id(0,0,""),a.spacer=!0,a;var n=/^[\s\n]*$/.test(a.textContent),p=a.nodeType==Node.ELEMENT_NODE&&!a.hasAttribute("begin")&&!a.hasAttribute("end");if(a.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!l)return null;k="default"==(a.getAttribute("xml:space")||(k?"default":"preserve"));n=yo(a.getAttribute("begin"),c);p=yo(a.getAttribute("end"),c);var q=yo(a.getAttribute("dur"),c);null==p&&null!=q&&(p=n+q);if(!l&&(null==n||null==p))throw new D(2,
2,2001);n=l&&null==n?0:n+b;p=l&&null==p?0:p+b;q="";l=[];if(Array.from(a.childNodes).find(function(a){return a.nodeType===Node.TEXT_NODE&&/\S+/.test(a.textContent)}))q=xo(a,k);else for(var r=t(a.childNodes),x=r.next();!x.done;x=r.next())if(x=no(x.value,b,c,d,e,f,h,k,!0))x.startTime=x.startTime||n,x.endTime=x.endTime||p,l.push(x);b=new Id(n,p,q);b.nestedCues=l;if((f=zo(a,"region",f,"")[0])&&f.getAttribute("xml:id")){var C=f.getAttribute("xml:id");b.region=h.filter(function(a){return a.id==C})[0]}d=
zo(a,"backgroundImage",d,"#","http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt")[0];Ao(b,a,f,d,e);return b}
function Ao(a,b,c,d,e){"rtl"==Bo(b,c,e,"direction")&&(a.direction="rtl");var f=Bo(b,c,e,"writingMode");"tb"==f||"tblr"==f?a.writingMode="vertical-lr":"tbrl"==f?a.writingMode="vertical-rl":"rltb"==f||"rl"==f?a.direction="rtl":f&&(a.direction=Jd);(f=Bo(b,c,e,"textAlign"))?(a.positionAlign=wo[f],a.lineAlign=vo[f],a.textAlign=Ud[f.toUpperCase()]):a.textAlign="start";if(f=Bo(b,c,e,"displayAlign"))a.displayAlign=Vd[f.toUpperCase()];if(f=Bo(b,c,e,"color"))a.color=f;if(f=Bo(b,c,e,"backgroundColor"))a.backgroundColor=
f;if(f=Bo(b,c,e,"fontFamily"))a.fontFamily=f;(f=Bo(b,c,e,"fontWeight"))&&"bold"==f&&(a.fontWeight=700);(f=Bo(b,c,e,"wrapOption"))&&"noWrap"==f&&(a.wrapLine=!1);(f=Bo(b,c,e,"lineHeight"))&&f.match(oo)&&(a.lineHeight=f);(f=Bo(b,c,e,"fontSize"))&&f.match(oo)&&(a.fontSize=f);if(f=Bo(b,c,e,"fontStyle"))a.fontStyle=Xd[f.toUpperCase()];if(d){f=d.getAttribute("imageType")||d.getAttribute("imagetype");var h=d.getAttribute("encoding");d=d.textContent.trim();"PNG"==f&&"Base64"==h&&d&&(a.backgroundImage="data:image/png;base64,"+
d)}(c=lo(c,e,"textDecoration"))&&Co(a,c);(b=Do(b,e,"textDecoration"))&&Co(a,b)}
function Co(a,b){for(var c=b.split(" "),d=0;d<c.length;d++)switch(c[d]){case "underline":a.textDecoration.includes("underline")||a.textDecoration.push("underline");break;case "noUnderline":a.textDecoration.includes("underline")&&fc(a.textDecoration,"underline");break;case "lineThrough":a.textDecoration.includes("lineThrough")||a.textDecoration.push("lineThrough");break;case "noLineThrough":a.textDecoration.includes("lineThrough")&&fc(a.textDecoration,"lineThrough");break;case "overline":a.textDecoration.includes("overline")||
a.textDecoration.push("overline");break;case "noOverline":a.textDecoration.includes("overline")&&fc(a.textDecoration,"overline")}}function Bo(a,b,c,d){return(a=Do(a,c,d))?a:lo(b,c,d)}function lo(a,b,c){if(!a)return null;for(var d=io(a),e=0;e<d.length;e++){var f=U.getAttributeNS(d[e],"http://www.w3.org/ns/ttml#styling",c);if(f)return f}return Eo(a,b,c)}function Do(a,b,c){var d=U.getAttributeNS(a,"http://www.w3.org/ns/ttml#styling",c);return d?d:Eo(a,b,c)}
function Eo(a,b,c){a=zo(a,"style",b,"");for(var d=null,e=0;e<a.length;e++){var f=U.getAttributeNS(a[e],"http://www.w3.org/ns/ttml#styling",c);f||(f=Do(a[e],b,c));f&&(d=f)}return d}
function zo(a,b,c,d,e){var f=[];if(!a||1>c.length)return f;var h=a;for(a=null;h&&!(a=e?U.getAttributeNS(h,e,b):h.getAttribute(b))&&(h=h.parentNode,h instanceof Element););if(b=a)for(b=b.split(" "),b=t(b),e=b.next();!e.done;e=b.next())for(e=e.value,a=t(c),h=a.next();!h.done;h=a.next())if(h=h.value,d+h.getAttribute("xml:id")==e){f.push(h);break}return f}
function yo(a,b){var c=null;if(po.test(a)){c=po.exec(a);var d=Number(c[1]),e=Number(c[2]),f=Number(c[3]),h=Number(c[4]);h+=(Number(c[5])||0)/b.h;f+=h/b.frameRate;c=f+60*e+3600*d}else qo.test(a)?c=Fo(qo,a):ro.test(a)?c=Fo(ro,a):so.test(a)?(c=so.exec(a),c=Number(c[1])/b.frameRate):to.test(a)?(c=to.exec(a),c=Number(c[1])/b.g):uo.test(a)&&(c=Fo(uo,a));return c}
function Fo(a,b){var c=a.exec(b);return null==c||""==c[0]?null:(Number(c[4])||0)/1E3+(Number(c[3])||0)+60*(Number(c[2])||0)+3600*(Number(c[1])||0)}function ho(a,b,c,d){this.frameRate=Number(a)||30;this.h=Number(b)||1;this.g=Number(d);0==this.g&&(this.g=a?this.frameRate*this.h:1);c&&(a=/^(\d+) (\d+)$/g.exec(c))&&(this.frameRate*=Number(a[1])/Number(a[2]))}ae["application/ttml+xml"]=go;function Go(){this.g=new go}A("shaka.text.Mp4TtmlParser",Go);Go.prototype.parseInit=function(a){var b=!1;(new T).box("moov",Ef).box("trak",Ef).box("mdia",Ef).box("minf",Ef).box("stbl",Ef).ma("stsd",Gf).box("stpp",function(a){b=!0;a.parser.stop()}).parse(a);if(!b)throw new D(2,2,2007);};Go.prototype.parseInit=Go.prototype.parseInit;
Go.prototype.parseMedia=function(a,b){var c=!1,d=[];(new T).box("mdat",Hf(function(a){c=!0;d=d.concat(this.g.parseMedia(a,b))}.bind(this))).parse(a);if(!c)throw new D(2,2,2007);return d};Go.prototype.parseMedia=Go.prototype.parseMedia;ae['application/mp4; codecs="stpp"']=Go;ae['application/mp4; codecs="stpp.ttml.im1t"']=Go;ae['application/mp4; codecs="stpp.TTML.im1t"']=Go;function Ho(){}A("shaka.text.VttTextParser",Ho);Ho.prototype.parseInit=function(){};Ho.prototype.parseInit=Ho.prototype.parseInit;
Ho.prototype.parseMedia=function(a,b){var c=Gb(a);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");c=c.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(c[0]))throw new D(2,2,2E3);var d=b.segmentStart;if(null==d&&(d=0,c[0].includes("X-TIMESTAMP-MAP"))){var e=c[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),f=c[0].match(/MPEGTS:(\d+)/m);if(e&&f){d=Io(new Vg(e[1]));if(null==d)throw new D(2,2,2E3);d=b.periodStart+(Number(f[1])/9E4-d)}}f=[];var h=c[0].split("\n");for(e=1;e<h.length;e++)if(/^Region:/.test(h[e])){var k=
new Vg(h[e]),l=new Kd;Yg(k);Wg(k);for(var n=Yg(k);n;){var p;a:{var q=l,r=n;if(p=/^id=(.*)$/.exec(r))q.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(r))q.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(r))q.height=Number(p[1]),q.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.regionAnchorX=Number(p[1]),q.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.viewportAnchorX=Number(p[1]),q.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(r))q.scroll=
"up";else{p=!1;break a}p=!0}p||B.v("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");Wg(k);n=Yg(k)}f.push(l)}e=[];for(k=1;k<c.length;k++){h=c[k].split("\n");p=h;q=d;h=f;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{l=null;p[0].includes("--\x3e")||(l=p[0],p.splice(0,1));n=new Vg(p[0]);r=Io(n);var x=Xg(n,/[ \t]+--\x3e[ \t]+/g),C=Io(n);if(null==r||null==x||null==C)throw new D(2,2,2001);p=new Id(r+q,C+q,p.slice(1).join("\n").trim());
Wg(n);for(q=Yg(n);q;)Jo(p,q,h)||B.v("VTT parser encountered an invalid VTT setting: ",q," The setting will be ignored."),Wg(n),q=Yg(n);null!=l&&(p.id=l);h=p}h&&e.push(h)}return e};Ho.prototype.parseMedia=Ho.prototype.parseMedia;
function Jo(a,b,c){var d;if(d=/^align:(start|middle|center|end|left|right)$/.exec(b))b=d[1],"middle"==b?a.textAlign=Nd:a.textAlign=Ud[b.toUpperCase()];else if(d=/^vertical:(lr|rl)$/.exec(b))a.writingMode="lr"==d[1]?"vertical-lr":"vertical-rl";else if(d=/^size:([\d.]+)%$/.exec(b))a.size=Number(d[1]);else if(d=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(b))a.position=Number(d[1]),d[2]&&(b=d[2],a.positionAlign="line-left"==b||"start"==b?"line-left":"line-right"==b||"end"==
b?"line-right":"center");else if(d=/^region:(.*)$/.exec(b)){if(b=Ko(c,d[1]))a.region=b}else{a:{if(c=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(b))a.lineInterpretation=1,a.line=Number(c[1]),c[2]&&(a.lineAlign=Wd[c[2].toUpperCase()]);else if(c=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(b))a.lineInterpretation=Pd,a.line=Number(c[1]),c[2]&&(a.lineAlign=Wd[c[2].toUpperCase()]);else{a=!1;break a}a=!0}return a}return!0}
function Ko(a,b){var c=a.filter(function(a){return a.id==b});return c.length?c[0]:(B.v("VTT parser could not find a region with id: ",b," The region will be ignored."),null)}function Io(a){a=Xg(a,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==a)return null;var b=Number(a[2]),c=Number(a[3]);return 59<b||59<c?null:Number(a[4])/1E3+c+60*b+3600*(Number(a[1])||0)}ae["text/vtt"]=Ho;ae['text/vtt; codecs="vtt"']=Ho;ae['text/vtt; codecs="wvtt"']=Ho;function Lo(){this.g=null}A("shaka.text.Mp4VttParser",Lo);Lo.prototype.parseInit=function(a){var b=!1;(new T).box("moov",Ef).box("trak",Ef).box("mdia",Ef).ma("mdhd",function(a){0==a.version?(a.reader.U(4),a.reader.U(4),this.g=a.reader.N(),a.reader.U(4)):(a.reader.U(8),a.reader.U(8),this.g=a.reader.N(),a.reader.U(8));a.reader.U(4)}.bind(this)).box("minf",Ef).box("stbl",Ef).ma("stsd",Gf).box("wvtt",function(){b=!0}).parse(a);if(!this.g)throw new D(2,2,2008);if(!b)throw new D(2,2,2008);};
Lo.prototype.parseInit=Lo.prototype.parseInit;
Lo.prototype.parseMedia=function(a,b){var c=this;if(!this.g)throw B.error("No init segment for MP4+VTT!"),new D(2,2,2008);var d=0,e=[],f,h=[],k=!1,l=!1,n=!1,p=null;(new T).box("moof",Ef).box("traf",Ef).ma("tfdt",function(a){k=!0;d=0==a.version?a.reader.N():a.reader.Pb()}).ma("tfhd",function(a){var b=a.flags;a=a.reader;a.U(4);b&1&&a.U(8);b&2&&a.U(4);p=b&8?a.N():null}).ma("trun",function(a){l=!0;var b=a.version,c=a.flags;a=a.reader;var d=a.N();c&1&&a.U(4);c&4&&a.U(4);for(var f=[],h=0;h<d;h++){var k=
{duration:null,sampleSize:null,Sd:null};c&256&&(k.duration=a.N());c&512&&(k.sampleSize=a.N());c&1024&&a.U(4);c&2048&&(k.Sd=0==b?a.N():a.De());f.push(k)}e=f}).box("mdat",Hf(function(a){n=!0;f=a})).parse(a);if(!n&&!k&&!l)throw new D(2,2,2008);var q=d,r=new DataView(f.buffer,f.byteOffset,f.byteLength),x=new S(r,0);e.forEach(function(a){var e=a.duration||p,f=a.Sd?d+a.Sd:q;q=f+(e||0);var k=0;do{var l=x.N();k+=l;var n=x.N();n=Df(n);var r=null;"vttc"==n?8<l&&(r=x.mb(l-8)):("vtte"!=n&&B.error("Unknown box "+
n+"! Skipping!"),x.U(l-8));e?r&&h.push(Mo(r,b.periodStart+f/c.g,b.periodStart+q/c.g)):B.error("WVTT sample duration unknown, and no default found!")}while(a.sampleSize&&k<a.sampleSize)});return h.filter(xb.Ra)};Lo.prototype.parseMedia=Lo.prototype.parseMedia;function Mo(a,b,c){var d,e,f;(new T).box("payl",Hf(function(a){d=Gb(a)})).box("iden",Hf(function(a){e=Gb(a)})).box("sttg",Hf(function(a){f=Gb(a)})).parse(a);return d?No(d,e,f,b,c):null}
function No(a,b,c,d,e){a=new Id(d,e,a);b&&(a.id=b);if(c)for(b=new Vg(c),c=Yg(b);c;)Jo(a,c,[])||B.v("VTT parser encountered an invalid VTT setting: ",c," The setting will be ignored."),Wg(b),c=Yg(b);return a}ae['application/mp4; codecs="wvtt"']=Lo;A("shaka.util.Dom.createHTMLElement",function(a){return document.createElement(a)});A("shaka.util.Dom.createVideoElement",function(){var a=document.createElement("video");a.muted=!0;a.width=600;a.height=400;return a});A("shaka.util.Dom.asHTMLElement",function(a){return a});A("shaka.util.Dom.asHTMLMediaElement",function(a){return a});A("shaka.util.Dom.removeAllChildren",function(a){for(;a.firstChild;)a.removeChild(a.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Oo(){}var Po;A("EmeEncryptionSchemePolyfill",Oo);function Qo(){Po?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Po=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Ro):console.debug("EmeEncryptionSchemePolyfill: EME not found")}Oo.install=Qo;
function Ro(a,b){var c=this;return u(function e(){var f;return y(e,function(e){switch(e.s){case 1:return console.assert(c==navigator,'bad "this" for requestMediaKeySystemAccess'),v(e,Po.call(c,a,b),2);case 2:f=e.B;if(So(f))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Po,e["return"](f);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
To;return e["return"](To.call(c,a,b))}})})}
function To(a,b){var c=this;return u(function e(){var f,h,k,l,n,p,q,r;return y(e,function(e){switch(e.s){case 1:console.assert(c==navigator,'bad "this" for requestMediaKeySystemAccess');f=Uo(a);h=[];for(var x=t(b),z=x.next();!z.done;z=x.next())k=z.value,l=Vo(k.videoCapabilities,f),n=Vo(k.audioCapabilities,f),k.videoCapabilities&&k.videoCapabilities.length&&!l.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=l,p.audioCapabilities=n,h.push(p));
if(!h.length)throw q=Error("Unsupported keySystem or supportedConfigurations."),q.name="NotSupportedError",q.code=DOMException.NOT_SUPPORTED_ERR,q;return v(e,Po.call(c,a,h),2);case 2:return r=e.B,e["return"](new Wo(r,f))}})})}function Vo(a,b){return a?a.filter(function(a){return!a.encryptionScheme||a.encryptionScheme==b}):a}function Xo(){}var Yo;A("McEncryptionSchemePolyfill",Xo);
function Zo(){Yo?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(Yo=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=$o):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}Xo.install=Zo;
function $o(a){var b=this;return u(function d(){var e,f;return y(d,function(d){switch(d.s){case 1:return console.assert(b==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(d,Yo.call(b,a),2);case 2:e=d.B;if(!a.keySystemConfiguration)return d["return"](e);if((f=e.keySystemAccess)&&So(f))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Yo,d["return"](e);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=ap;return d["return"](ap.call(b,a))}})})}
function ap(a){var b=this;return u(function d(){var e,f,h,k,l,n,p,q,r;return y(d,function(d){switch(d.s){case 1:return console.assert(b==navigator.mediaCapabilities,'bad "this" for decodingInfo'),e=null,a.keySystemConfiguration&&(f=a.keySystemConfiguration,h=f.keySystem,k=f.audio&&f.audio.encryptionScheme,l=f.video&&f.video.encryptionScheme,e=Uo(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:a},k&&k!=e||l&&l!=e)?d["return"](n):v(d,Yo.call(b,a),2);case 2:p=d.B;if(p.keySystemAccess){p.keySystemAccess=
new Wo(p.keySystemAccess,e);d.I(3);break}if(!a.keySystemConfiguration){d.I(3);break}var x=a.keySystemConfiguration,z=[],F=[];x.audio&&z.push({robustness:x.audio.robustness||"",contentType:a.audio.contentType});x.video&&F.push({robustness:x.video.robustness||"",contentType:a.video.contentType});x={initDataTypes:x.initDataType?[x.initDataType]:[],distinctiveIdentifier:x.distinctiveIdentifier,persistentState:x.persistentState,sessionTypes:x.sessionTypes};z.length&&(x.audioCapabilities=z);F.length&&(x.videoCapabilities=
F);q=x;r=p;return v(d,navigator.requestMediaKeySystemAccess(a.keySystemConfiguration.keySystem,[q]),5);case 5:r.keySystemAccess=d.B;case 3:return d["return"](p)}})})}function Wo(a,b){this.h=a;this.g=b;this.keySystem=a.keySystem}
Wo.prototype.getConfiguration=function(){var a=this.h.getConfiguration();if(a.videoCapabilities)for(var b=t(a.videoCapabilities),c=b.next();!c.done;c=b.next())c.value.encryptionScheme=this.g;if(a.audioCapabilities)for(b=t(a.audioCapabilities),c=b.next();!c.done;c=b.next())c.value.encryptionScheme=this.g;return a};Wo.prototype.createMediaKeys=function(){return this.h.createMediaKeys()};
function Uo(a){if(a.startsWith("com.widevine")||a.startsWith("com.microsoft")||a.startsWith("com.adobe")||a.startsWith("org.w3"))return"cenc";if(a.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",a,"Please contribute!");return null}function So(a){a=a.getConfiguration();var b=a.audioCapabilities&&a.audioCapabilities[0];return(a=a.videoCapabilities&&a.videoCapabilities[0]||b)&&void 0!==a.encryptionScheme?!0:!1}function bp(){}
A("EncryptionSchemePolyfills",bp);function en(){Qo();Zo()}bp.install=en;"undefined"!==typeof module&&module.gf&&(module.gf=bp);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define=="function"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map